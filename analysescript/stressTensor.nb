(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    331174,       8372]
NotebookOptionsPosition[    321736,       8223]
NotebookOutlinePosition[    322136,       8239]
CellTagsIndexPosition[    322093,       8236]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Calculation of trace of stress tensor", "Title",
 CellChangeTimes->{{3.921773128870708*^9, 
  3.921773141134547*^9}},ExpressionUUID->"d2015dce-3ef2-45c8-bb1e-\
1928e3fd48f9"],

Cell[CellGroupData[{

Cell["Analytical functions", "Section",
 CellChangeTimes->{{3.906130030072163*^9, 
  3.906130041829665*^9}},ExpressionUUID->"55216139-4dd1-47d1-b3e7-\
3efeeb28d2c0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906130176580935*^9, 3.90613017877917*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"60971f4b-0750-4d2f-9e72-24ba65137fb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Cross", " ", "product", " ", "for", " ", "2", "d", " ", "vectors"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Cross2d", "[", 
     RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"r1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"r2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"r1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"r2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "vertex", " ", "position", " ", "given", " ", "the", " ", 
     "three", " ", "adjecent", " ", "cell", " ", "positions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"voro", "[", 
      RowBox[{"ri_", ",", "rj_", ",", "rk_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rij", ",", "rjk", ",", "rik", ",", "cross", ",", "d", ",", 
         "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rij", "=", 
         RowBox[{"ri", "-", "rj"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rjk", "=", 
         RowBox[{"rj", "-", "rk"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rik", "=", 
         RowBox[{"ri", "-", "rk"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"cross", "=", 
         RowBox[{"Cross2d", "[", 
          RowBox[{"rij", ",", "rjk"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"2", "*", "cross", "*", "cross"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rjk", ".", "rjk"}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rij", ".", "rik"}], ")"}], "/", "d"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Beta]", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"rik", ".", "rik"}], ")"}]}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rij", ".", "rjk"}], ")"}], "/", "d"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rij", ".", "rij"}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rik", ".", "rjk"}], ")"}], "/", "d"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Alpha]", "*", "ri"}], "+", 
         RowBox[{"\[Beta]", "*", "rj"}], "+", 
         RowBox[{"\[Gamma]", "*", "rk"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7021149776264777`*^9, 3.702115029400317*^9}, {
  3.702115105977425*^9, 3.702115106740584*^9}, {3.702115641476828*^9, 
  3.702115674089185*^9}, {3.702115937679511*^9, 3.702115970430769*^9}, {
  3.702116071657602*^9, 3.702116093688979*^9}, {3.702116333940885*^9, 
  3.702116367283513*^9}, {3.702116697174008*^9, 3.702116716983386*^9}, {
  3.702117069252245*^9, 3.702117092274171*^9}, {3.702117181705346*^9, 
  3.702117183751179*^9}, {3.702117722524921*^9, 3.702117731376658*^9}, {
  3.702117777086854*^9, 3.7021177930464077`*^9}, {3.702117832077812*^9, 
  3.702117850958396*^9}, {3.702118822968773*^9, 3.702118832692359*^9}, {
  3.906130184098963*^9, 3.906130249675869*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"4df5e789-61f6-4abc-b9ca-476070b47347"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ri", "=", 
  RowBox[{"{", 
   RowBox[{"rix", ",", "riy"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"rj", "=", 
  RowBox[{"{", 
   RowBox[{"rjx", ",", "rjy"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"rk", "=", 
  RowBox[{"{", 
   RowBox[{"rkx", ",", "rky"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.702221524635298*^9, 3.7022215284528112`*^9}, {
  3.903517203533676*^9, 3.903517238737976*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"147655eb-c482-4ae1-ae06-6ba830ab83f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"rix", ",", "riy"}], "}"}]], "Output",
 CellChangeTimes->{{3.903517212023604*^9, 3.903517243153616*^9}, 
   3.903562439107212*^9, 3.903786935486725*^9, 3.903795516375733*^9, 
   3.904149388608132*^9, 3.904340178984725*^9, 3.904384814793366*^9, 
   3.904474771740842*^9, 3.904689113594815*^9, 3.904744355061328*^9, 
   3.92177355884501*^9, 3.9217737704296083`*^9, {3.921778599314196*^9, 
   3.921778619974407*^9}, 3.921778706009364*^9, 3.921825790568774*^9, 
   3.921841555759456*^9, 3.922208454035009*^9, 3.922208779027813*^9, 
   3.922208819182055*^9, 3.922208854785626*^9, 3.922208896288655*^9, {
   3.922208937231409*^9, 3.92220897499047*^9}, 3.922209247218298*^9, 
   3.922209342787221*^9, 3.922209394714941*^9, 3.922209439067208*^9, 
   3.922213560915195*^9, 3.922213629685645*^9, 3.922213730085787*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"21474344-9bdf-4a4b-b3d7-5155c8dadc9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"rjx", ",", "rjy"}], "}"}]], "Output",
 CellChangeTimes->{{3.903517212023604*^9, 3.903517243153616*^9}, 
   3.903562439107212*^9, 3.903786935486725*^9, 3.903795516375733*^9, 
   3.904149388608132*^9, 3.904340178984725*^9, 3.904384814793366*^9, 
   3.904474771740842*^9, 3.904689113594815*^9, 3.904744355061328*^9, 
   3.92177355884501*^9, 3.9217737704296083`*^9, {3.921778599314196*^9, 
   3.921778619974407*^9}, 3.921778706009364*^9, 3.921825790568774*^9, 
   3.921841555759456*^9, 3.922208454035009*^9, 3.922208779027813*^9, 
   3.922208819182055*^9, 3.922208854785626*^9, 3.922208896288655*^9, {
   3.922208937231409*^9, 3.92220897499047*^9}, 3.922209247218298*^9, 
   3.922209342787221*^9, 3.922209394714941*^9, 3.922209439067208*^9, 
   3.922213560915195*^9, 3.922213629685645*^9, 3.922213730099703*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"9f9eb0c2-43cd-405f-a70f-be379da1aadc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"rkx", ",", "rky"}], "}"}]], "Output",
 CellChangeTimes->{{3.903517212023604*^9, 3.903517243153616*^9}, 
   3.903562439107212*^9, 3.903786935486725*^9, 3.903795516375733*^9, 
   3.904149388608132*^9, 3.904340178984725*^9, 3.904384814793366*^9, 
   3.904474771740842*^9, 3.904689113594815*^9, 3.904744355061328*^9, 
   3.92177355884501*^9, 3.9217737704296083`*^9, {3.921778599314196*^9, 
   3.921778619974407*^9}, 3.921778706009364*^9, 3.921825790568774*^9, 
   3.921841555759456*^9, 3.922208454035009*^9, 3.922208779027813*^9, 
   3.922208819182055*^9, 3.922208854785626*^9, 3.922208896288655*^9, {
   3.922208937231409*^9, 3.92220897499047*^9}, 3.922209247218298*^9, 
   3.922209342787221*^9, 3.922209394714941*^9, 3.922209439067208*^9, 
   3.922213560915195*^9, 3.922213629685645*^9, 3.922213730107109*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"b12db5bc-a571-4427-9221-8ad94fa7dab7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hijk", "=", 
   RowBox[{"voro", "[", 
    RowBox[{"ri", ",", "rj", ",", "rk"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"den", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rjx", "*", "rky"}], "-", 
      RowBox[{"rjy", "*", "rkx"}]}], ")"}], "^", "3"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7021149776264777`*^9, 3.702115029400317*^9}, {
   3.702115105977425*^9, 3.702115106740584*^9}, {3.702115641476828*^9, 
   3.702115674089185*^9}, {3.702115937679511*^9, 3.702115970430769*^9}, {
   3.702116071657602*^9, 3.702116093688979*^9}, {3.702116333940885*^9, 
   3.702116367283513*^9}, {3.702116697174008*^9, 3.702116716983386*^9}, {
   3.702117069252245*^9, 3.702117092274171*^9}, {3.702117181705346*^9, 
   3.702117183751179*^9}, {3.702117722524921*^9, 3.702117731376658*^9}, {
   3.702117777086854*^9, 3.7021177930464077`*^9}, {3.702117832077812*^9, 
   3.702117850958396*^9}, {3.702118822968773*^9, 3.702118832692359*^9}, 
   3.903517309272399*^9, {3.903537123584051*^9, 3.903537127506509*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ccdb8f92-9908-4ff7-9083-9a9fbcd2eb40"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Analytical", " ", "dirivatives", " ", "of", " ", "dhdr", " ", "and", " ", 
   "dhdr"}], "*)"}]], "Input",
 CellChangeTimes->{{3.903631550530129*^9, 3.903631571968574*^9}, {
  3.903631613453341*^9, 3.903631616768702*^9}, {3.903631892794048*^9, 
  3.903631896205661*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"6150d537-8093-4cd6-926e-7fe11d02f637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v1dri", "[", 
   RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}]},
       {
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}]}
      }], ")"}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rix", "\[Rule]", 
      RowBox[{"r1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"riy", "\[Rule]", 
      RowBox[{"r1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"rjx", "\[Rule]", 
      RowBox[{"r2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"rjy", "\[Rule]", 
      RowBox[{"r2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"rkx", "\[Rule]", 
      RowBox[{"r3", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"rky", "\[Rule]", 
      RowBox[{"r3", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.903565821240597*^9, 3.903565821746937*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"456d064b-1631-4123-a34f-e6400be5eb9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v2drirj", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjx"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjx"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjx"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjx"}], "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjy"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjy"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjy"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjy"}], "]"}]}], "}"}]}], "}"}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rix", "\[Rule]", 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"riy", "\[Rule]", 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"rjx", "\[Rule]", 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"rjy", "\[Rule]", 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"rkx", "\[Rule]", 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"rky", "\[Rule]", 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.702308783477057*^9, 3.702308917615642*^9}, {
   3.702309238826765*^9, 3.702309311722497*^9}, {3.70230939231063*^9, 
   3.702309394825799*^9}, {3.9035372124633436`*^9, 3.903537227484953*^9}, {
   3.903538433255641*^9, 3.90353843798347*^9}, 3.903538493235571*^9, {
   3.903562683764697*^9, 3.9035626920055447`*^9}, {3.903571719792268*^9, 
   3.903571725927569*^9}, {3.903605660009725*^9, 3.903605663152857*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"37f99c5c-e836-4c04-9f11-a149fb588508"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v2driri", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "rix"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "rix"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "rix"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "rix"}], "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "riy"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "riy"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "riy"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "riy"}], "]"}]}], "}"}]}], "}"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rix", "\[Rule]", 
        RowBox[{"r1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"riy", "\[Rule]", 
        RowBox[{"r1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"rjx", "\[Rule]", 
        RowBox[{"r2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"rjy", "\[Rule]", 
        RowBox[{"r2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"rkx", "\[Rule]", 
        RowBox[{"r3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"rky", "\[Rule]", 
        RowBox[{"r3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.903537241362403*^9, 3.903537251355837*^9}, {
  3.9035384894593678`*^9, 3.903538537749229*^9}, {3.903539541062944*^9, 
  3.903539541152039*^9}, {3.9035626547940187`*^9, 3.903562662564859*^9}, {
  3.903567167463319*^9, 3.903567197379348*^9}, {3.903571745169484*^9, 
  3.903571756417726*^9}, {3.903605666680064*^9, 3.903605668003092*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"8605aa80-7be8-40cc-80c4-8a86208058b3"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
   "Analytical", " ", "dirivatives", " ", "of", " ", "dhdg", " ", "and", " ", 
    "d2hdgdg"}], "*)"}]}]], "Input",
 CellChangeTimes->{
  3.9036056792891603`*^9, {3.903631581116619*^9, 3.9036316110544047`*^9}, {
   3.903631902367821*^9, 3.903631905174819*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"b0924c0d-21d1-4e8f-a9ba-c8afeeeb4c0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dridg", "=", 
   RowBox[{"{", 
    RowBox[{"riy", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drjdg", "=", 
   RowBox[{"{", 
    RowBox[{"rjy", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drkdg", "=", 
    RowBox[{"{", 
     RowBox[{"rky", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"dh2dgdg", "[", 
      RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2driri", "[", 
          RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2driri", "[", 
          RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2driri", "[", 
          RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dh2dgdg", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dh2d\[Epsilon]xd\[Epsilon]x", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dh2d\[Epsilon]yd\[Epsilon]y", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903542849860942*^9, 3.903542885382741*^9}, {
   3.903543096145893*^9, 3.903543105486513*^9}, {3.903544778032348*^9, 
   3.903544840712337*^9}, {3.903544880359651*^9, 3.9035451278955803`*^9}, 
   3.903563584241771*^9, {3.903563623546873*^9, 3.903563656747323*^9}, {
   3.903567209077092*^9, 3.903567225961917*^9}, {3.903567377967236*^9, 
   3.9035673867502627`*^9}, {3.903567448439039*^9, 3.903567529635664*^9}, {
   3.903572195288945*^9, 3.903572426945136*^9}, {3.903572473696194*^9, 
   3.903572532295334*^9}, {3.903605706901718*^9, 3.903605731000478*^9}, {
   3.903605763702444*^9, 3.903605774198662*^9}, {3.921776065133325*^9, 
   3.9217761305904613`*^9}, {3.921776160743354*^9, 3.921776227920836*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"4ef6c424-5997-4ae8-b30e-d4e18764eac3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dhdg", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r3", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.903564640362316*^9, 3.9035646915297194`*^9}, {
  3.903565837174224*^9, 3.903565900654749*^9}, {3.9035659494695067`*^9, 
  3.903565951727913*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"109bf558-5bb1-4fa9-a4b4-7640877ba7ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dhd\[Epsilon]x", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r3", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dhd\[Epsilon]y", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"r1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"r2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"r3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.903564640362316*^9, 3.9035646915297194`*^9}, {
  3.903565837174224*^9, 3.903565900654749*^9}, {3.9035659494695067`*^9, 
  3.903565951727913*^9}, {3.921775556056182*^9, 3.921775632553735*^9}, {
  3.921777009867077*^9, 3.921777011130507*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"0fc6ac9f-a60a-4f30-a371-8ce79c0aa046"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", 
    RowBox[{"C", "++"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"r1", "=", 
    RowBox[{"{", 
     RowBox[{"r1x", ",", "r1y"}], "}"}]}], ";", 
   RowBox[{"r2", "=", 
    RowBox[{"{", 
     RowBox[{"r2x", ",", "r2y"}], "}"}]}], ";", 
   RowBox[{"r3", "=", 
    RowBox[{"{", 
     RowBox[{"r3x", ",", "r3y"}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.921776314650266*^9, 3.921776327743198*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"9a963995-e6ef-4ba0-98b6-636718eb9554"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"dhd\[Epsilon]x", "[", 
      RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1x", "->", "0"}], ",", 
       RowBox[{"r1y", "->", "0"}]}], "}"}]}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_", "^", "2"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x_", "^", "3"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x", "*", "x"}], "]"}]}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.903795352687204*^9, 3.903795440132812*^9}, {
   3.903795838604693*^9, 3.90379584018342*^9}, {3.903795900108468*^9, 
   3.90379590100532*^9}, {3.903795994917081*^9, 3.9037960064053936`*^9}, {
   3.903796054634122*^9, 3.903796071339532*^9}, 3.9037983789762387`*^9, {
   3.903800169376627*^9, 3.903800170760226*^9}, {3.9038022300365143`*^9, 
   3.9038022306007233`*^9}, {3.921776349490902*^9, 3.921776377482992*^9}, 
   3.921777627277078*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"212e4b68-f3cb-47a4-8e87-efd21d9ebb2b"],

Cell["\<\
List((-(r3y*(r2x*r2x)) + r3y*(r2y*r2y) + r2y*(r3x*r3x) - \
r2y*(r3y*r3y))/(2*r2y*r3x - 2*r2x*r3y),
   (r2x*r3x*(-r2x + r3x))/(-(r2y*r3x) + r2x*r3y))\
\>", "Output",
 CellChangeTimes->{{3.921776364226894*^9, 3.9217763779538193`*^9}, 
   3.921777633496007*^9, {3.921778599407528*^9, 3.921778620058881*^9}, 
   3.921778706477976*^9, 3.921825790663548*^9, 3.921841555818123*^9, 
   3.922208454292253*^9, 3.9222087792857013`*^9, 3.9222088192853823`*^9, 
   3.9222088548799047`*^9, 3.922208896529491*^9, {3.922208937426433*^9, 
   3.922208975225497*^9}, 3.9222092473191643`*^9, 3.922209342877559*^9, 
   3.922209394842787*^9, 3.922209439171414*^9, 3.922213561011658*^9, 
   3.922213629782371*^9, 3.9222137304401813`*^9},
 CellLabel->
  "Out[24]//CForm=",ExpressionUUID->"443ab112-c708-4c7e-bfd5-6a300338404b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"dhd\[Epsilon]y", "[", 
      RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1x", "->", "0"}], ",", 
       RowBox[{"r1y", "->", "0"}]}], "}"}]}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_", "^", "2"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x_", "^", "3"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x", "*", "x"}], "]"}]}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{3.921777438508647*^9, 3.921777628892041*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"bd55ef78-c87e-4327-b7b6-8474ef4333e3"],

Cell["\<\
List((r2y*(r2y - r3y)*r3y)/(-(r2y*r3x) + r2x*r3y),
   (r3x*(r2x*r2x) - r3x*(r2y*r2y) + r2x*(-(r3x*r3x) + r3y*r3y))/(-2*r2y*r3x + \
2*r2x*r3y))\
\>", "Output",
 CellChangeTimes->{{3.921777436018972*^9, 3.921777438943065*^9}, 
   3.921777635616455*^9, {3.921778599426985*^9, 3.92177862007876*^9}, 
   3.921778706502234*^9, 3.92182579067365*^9, 3.921841555824566*^9, 
   3.92220845434523*^9, 3.9222087793602242`*^9, 3.922208819363988*^9, 
   3.922208854898145*^9, 3.922208896633475*^9, {3.9222089374824123`*^9, 
   3.9222089753239527`*^9}, 3.922209247338229*^9, 3.922209342895596*^9, 
   3.922209394860968*^9, 3.9222094392091503`*^9, 3.922213561054264*^9, 
   3.922213629879097*^9, 3.9222137305253778`*^9},
 CellLabel->
  "Out[25]//CForm=",ExpressionUUID->"d48e6906-d082-4574-a2a1-41f6976c3bbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"dh2d\[Epsilon]yd\[Epsilon]y", "[", 
      RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1x", "->", "0"}], ",", 
       RowBox[{"r1y", "->", "0"}]}], "}"}]}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_", "^", "2"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x_", "^", "3"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x", "*", "x"}], "]"}]}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.921776402371735*^9, 3.921776410075952*^9}, 
   3.92177763045202*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"6139bc93-1e3a-4f9f-9ba5-00cad59b3fb8"],

Cell["\<\
List((r2y*(r2y - r3y)*r3y)/(-(r2y*r3x) + r2x*r3y),(r2x*r3x*(-r2x + \
r3x))/(-(r2y*r3x) + r2x*r3y))\
\>", "Output",
 CellChangeTimes->{
  3.921776411893934*^9, 3.921777637261543*^9, {3.921778599488887*^9, 
   3.921778620139003*^9}, 3.92177870657067*^9, 3.921825790738122*^9, 
   3.921841555880978*^9, 3.922208454423404*^9, 3.922208779439551*^9, 
   3.922208819478542*^9, 3.922208854988809*^9, 3.922208896749199*^9, {
   3.922208937575165*^9, 3.922208975443482*^9}, 3.922209247413747*^9, 
   3.922209342990438*^9, 3.92220939493279*^9, 3.922209439273017*^9, 
   3.92221356114038*^9, 3.9222136300399313`*^9, 3.9222137306322823`*^9},
 CellLabel->
  "Out[26]//CForm=",ExpressionUUID->"b0e6e669-b840-4ba4-96ce-636b63a0e618"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"dh2d\[Epsilon]xd\[Epsilon]x", "[", 
      RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1x", "->", "0"}], ",", 
       RowBox[{"r1y", "->", "0"}]}], "}"}]}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_", "^", "2"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x_", "^", "3"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x", "*", "x"}], "]"}]}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.921776494445819*^9, 3.921776495342057*^9}, 
   3.921777631523841*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"ce7ae7ae-61b9-4dd6-8c8a-63fa9f41af9d"],

Cell["\<\
List((r2y*(r2y - r3y)*r3y)/(-(r2y*r3x) + r2x*r3y),(r2x*r3x*(-r2x + \
r3x))/(-(r2y*r3x) + r2x*r3y))\
\>", "Output",
 CellChangeTimes->{
  3.921776497271702*^9, 3.9217776384125986`*^9, {3.9217785995517473`*^9, 
   3.921778620199072*^9}, 3.921778706633532*^9, 3.921825790799861*^9, 
   3.921841555937869*^9, 3.922208454483944*^9, 3.922208779497498*^9, 
   3.922208819576674*^9, 3.922208855046762*^9, 3.92220889680848*^9, {
   3.922208937634693*^9, 3.922208975502446*^9}, 3.922209247498798*^9, 
   3.922209343072741*^9, 3.922209395024353*^9, 3.9222094393408604`*^9, 
   3.92221356120019*^9, 3.922213630102313*^9, 3.922213730692876*^9},
 CellLabel->
  "Out[27]//CForm=",ExpressionUUID->"a84b92a5-9c33-42cd-8f2f-b5f7d467ba70"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Numerical", " ", "test"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"p1", "=", 
    RowBox[{"{", 
     RowBox[{"15.764422379230995`", ",", "17.23195769060852`"}], "}"}]}], ";", 
   RowBox[{"p2", "=", 
    RowBox[{"{", 
     RowBox[{"16.240740458209697`", ",", "16.83431037696828`"}], "}"}]}], ";", 
   RowBox[{"p3", "=", 
    RowBox[{"{", 
     RowBox[{"15.803192711415326`", ",", "16.385277852647548`"}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.921776635081626*^9, 3.921776642995364*^9}, {
  3.921776681714613*^9, 3.9217767854289494`*^9}, {3.921776822493496*^9, 
  3.9217768421260986`*^9}, {3.921776896207911*^9, 3.92177689674303*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"de8f91a1-9c1c-4593-9152-b2d8fa7cd8b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "verifies", " ", "dhd\[Epsilon]x", " ", "and", " ", 
    "dh2d\[Epsilon]xd\[Epsilon]x"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"strainfor", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", "0.001"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"strainback", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "-", "0.001"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"hForward", "=", 
     RowBox[{"voro", "[", 
      RowBox[{
       RowBox[{"strainfor", ".", "p1"}], ",", 
       RowBox[{"strainfor", ".", "p2"}], ",", 
       RowBox[{"strainfor", ".", "p3"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hback", "=", 
     RowBox[{"voro", "[", 
      RowBox[{
       RowBox[{"strainback", ".", "p1"}], ",", 
       RowBox[{"strainback", ".", "p2"}], ",", 
       RowBox[{"strainback", ".", "p3"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"originalh", "=", 
     RowBox[{"voro", "[", 
      RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hback", "+", "hForward", "-", 
      RowBox[{"2", "*", "originalh"}]}], ")"}], "/", 
    RowBox[{"0.001", "^", "2"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"hback", "-", "hForward"}], ")"}]}], "/", 
    "0.002"}]}]}]], "Input",
 CellChangeTimes->{{3.921776904775814*^9, 3.921776918863687*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"bd7a54ea-0e51-4575-ba11-b646dc12b58f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.3897688092280305`"}], ",", "0.020832121805369752`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.92177682373316*^9, 3.921776843562276*^9}, {
   3.9217785995703382`*^9, 3.921778620218583*^9}, 3.921778706652871*^9, 
   3.9218257908112926`*^9, 3.921841555948847*^9, 3.922208454497842*^9, 
   3.922208779516296*^9, 3.922208819629406*^9, 3.922208855060849*^9, 
   3.922208896828843*^9, {3.922208937656636*^9, 3.922208975518663*^9}, 
   3.9222092475251207`*^9, 3.922209343095024*^9, 3.922209395046025*^9, 
   3.922209439362146*^9, 3.922213561215885*^9, 3.922213630120101*^9, 
   3.922213730712599*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"8b532742-57e6-477c-8b84-1c27ed231bdf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.20616152330978`", ",", "0.020832127029635217`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.92177682373316*^9, 3.921776843562276*^9}, {
   3.9217785995703382`*^9, 3.921778620218583*^9}, 3.921778706652871*^9, 
   3.9218257908112926`*^9, 3.921841555948847*^9, 3.922208454497842*^9, 
   3.922208779516296*^9, 3.922208819629406*^9, 3.922208855060849*^9, 
   3.922208896828843*^9, {3.922208937656636*^9, 3.922208975518663*^9}, 
   3.9222092475251207`*^9, 3.922209343095024*^9, 3.922209395046025*^9, 
   3.922209439362146*^9, 3.922213561215885*^9, 3.922213630120101*^9, 
   3.9222137307191153`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"237c38a0-fa49-437c-b662-194694089218"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dh2d\[Epsilon]xd\[Epsilon]x", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"dhd\[Epsilon]x", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.921776850398985*^9, 3.92177688127888*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"d2883164-1c11-4471-8369-7496a7bd8038"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.3897684172900995`"}], ",", "0.020832126860774736`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.921776863928555*^9, 3.921776881854873*^9}, {
   3.921778599612177*^9, 3.921778620260253*^9}, 3.9217787066990013`*^9, 
   3.921825790851984*^9, 3.9218415559901953`*^9, 3.922208454591964*^9, 
   3.9222087795814543`*^9, 3.922208819735595*^9, 3.9222088551425877`*^9, 
   3.922208896927552*^9, {3.92220893773121*^9, 3.9222089755759683`*^9}, 
   3.922209247575026*^9, 3.92220934319998*^9, 3.9222093951159487`*^9, 
   3.922209439407213*^9, 3.922213561267967*^9, 3.922213630180785*^9, 
   3.922213730774087*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"367c36fd-66ab-4047-9519-ee9aa83cf472"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.206161328426635`", ",", "0.020832127027701652`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.921776863928555*^9, 3.921776881854873*^9}, {
   3.921778599612177*^9, 3.921778620260253*^9}, 3.9217787066990013`*^9, 
   3.921825790851984*^9, 3.9218415559901953`*^9, 3.922208454591964*^9, 
   3.9222087795814543`*^9, 3.922208819735595*^9, 3.9222088551425877`*^9, 
   3.922208896927552*^9, {3.92220893773121*^9, 3.9222089755759683`*^9}, 
   3.922209247575026*^9, 3.92220934319998*^9, 3.9222093951159487`*^9, 
   3.922209439407213*^9, 3.922213561267967*^9, 3.922213630180785*^9, 
   3.922213730778407*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"dcba15df-2a56-46eb-94b3-6d5b7b7e6df6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "verifies", " ", "dhd\[Epsilon]y", " ", "and", " ", 
    "dh2d\[Epsilon]yd\[Epsilon]y"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"strainfor", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "+", "0.001"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"strainback", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "-", "0.001"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"hForward", "=", 
     RowBox[{"voro", "[", 
      RowBox[{
       RowBox[{"strainfor", ".", "p1"}], ",", 
       RowBox[{"strainfor", ".", "p2"}], ",", 
       RowBox[{"strainfor", ".", "p3"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hback", "=", 
     RowBox[{"voro", "[", 
      RowBox[{
       RowBox[{"strainback", ".", "p1"}], ",", 
       RowBox[{"strainback", ".", "p2"}], ",", 
       RowBox[{"strainback", ".", "p3"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"originalh", "=", 
     RowBox[{"voro", "[", 
      RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hback", "+", "hForward", "-", 
      RowBox[{"2", "*", "originalh"}]}], ")"}], "/", 
    RowBox[{"0.001", "^", "2"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"hback", "-", "hForward"}], ")"}]}], "/", 
    "0.002"}]}]}]], "Input",
 CellChangeTimes->{{3.921776904775814*^9, 3.921776953840743*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"a3f6bcf1-b5f4-4769-8d4d-564b8e6f6ca0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.3897684219822395`"}], ",", "0.020832143121651825`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.92177682373316*^9, 3.921776843562276*^9}, 
   3.9217769636031027`*^9, {3.921778599631558*^9, 3.921778620280756*^9}, 
   3.921778706722215*^9, 3.9218257908649054`*^9, 3.921841555994841*^9, 
   3.92220845462759*^9, 3.922208779614233*^9, 3.922208819782536*^9, 
   3.922208855209387*^9, 3.92220889694416*^9, {3.922208937764206*^9, 
   3.922208975599751*^9}, 3.9222092476047277`*^9, 3.922209343233418*^9, 
   3.92220939514146*^9, 3.922209439437693*^9, 3.922213561283449*^9, 
   3.92221363020197*^9, 3.9222137308083553`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"4b908e89-653e-4a39-8717-d1d2cfb6bc8c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.38976841707860643`"}], ",", "16.78927775128436`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.92177682373316*^9, 3.921776843562276*^9}, 
   3.9217769636031027`*^9, {3.921778599631558*^9, 3.921778620280756*^9}, 
   3.921778706722215*^9, 3.9218257908649054`*^9, 3.921841555994841*^9, 
   3.92220845462759*^9, 3.922208779614233*^9, 3.922208819782536*^9, 
   3.922208855209387*^9, 3.92220889694416*^9, {3.922208937764206*^9, 
   3.922208975599751*^9}, 3.9222092476047277`*^9, 3.922209343233418*^9, 
   3.92220939514146*^9, 3.922209439437693*^9, 3.922213561283449*^9, 
   3.92221363020197*^9, 3.922213730823898*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"45033e5c-4d96-4c48-8b1c-e2380dadfad7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dh2d\[Epsilon]yd\[Epsilon]y", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"dhd\[Epsilon]yGeneral", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.921776850398985*^9, 3.92177688127888*^9}, {
  3.921776959689034*^9, 3.921776962288943*^9}, {3.921832947645142*^9, 
  3.921832955096721*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"47e70d17-214f-474f-8597-50ff11d3b8fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.38976841704356957`"}], ",", "0.020832127066476858`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.921776863928555*^9, 3.921776881854873*^9}, 
   3.9217769816506844`*^9, 3.921777014403163*^9, {3.921778599672812*^9, 
   3.921778620322071*^9}, 3.921778706786326*^9, 3.9218257909055*^9, 
   3.9218329561616387`*^9, 3.921841556037046*^9, 3.922208454766922*^9, 
   3.922208779849275*^9, 3.922208819895562*^9, 3.922208855321863*^9, 
   3.9222088969951873`*^9, {3.922208937856292*^9, 3.922208975759969*^9}, 
   3.92220924764751*^9, 3.922209343343883*^9, 3.922209395224859*^9, 
   3.922209439489102*^9, 3.9222135613315787`*^9, 3.922213630300753*^9, 
   3.922213730969743*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"d12cb718-0fcd-4f88-85d9-5cbbb631ef43"],

Cell[BoxData[
 RowBox[{"dhd\[Epsilon]yGeneral", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"15.764422379230995`", ",", "17.23195769060852`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16.240740458209697`", ",", "16.83431037696828`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15.803192711415326`", ",", "16.385277852647548`"}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.921776863928555*^9, 3.921776881854873*^9}, 
   3.9217769816506844`*^9, 3.921777014403163*^9, {3.921778599672812*^9, 
   3.921778620322071*^9}, 3.921778706786326*^9, 3.9218257909055*^9, 
   3.9218329561616387`*^9, 3.921841556037046*^9, 3.922208454766922*^9, 
   3.922208779849275*^9, 3.922208819895562*^9, 3.922208855321863*^9, 
   3.9222088969951873`*^9, {3.922208937856292*^9, 3.922208975759969*^9}, 
   3.92220924764751*^9, 3.922209343343883*^9, 3.922209395224859*^9, 
   3.922209439489102*^9, 3.9222135613315787`*^9, 3.922213630300753*^9, 
   3.922213730974936*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"8e41fd1a-82d0-438b-a8f7-1f2762422af6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "calculate", " ", "perimetes", " ", "and", " ", "areas", " ", "given", " ",
     "the", " ", "positions", " ", "of", " ", "all", " ", "the", " ", 
    "vertices"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"peri", "[", "hv_List", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", 
           RowBox[{"hv", "[", 
            RowBox[{"[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "+", "i"}], "==", 
                RowBox[{"Length", "[", "hv", "]"}]}], ",", 
               RowBox[{"Length", "[", "hv", "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"1", "+", "i"}], ",", 
                 RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
            "]"}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", 
           RowBox[{"hv", "[", 
            RowBox[{"[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "+", "i"}], "==", 
                RowBox[{"Length", "[", "hv", "]"}]}], ",", 
               RowBox[{"Length", "[", "hv", "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"1", "+", "i"}], ",", 
                 RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
            "]"}]}], ")"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "hv", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"area", "[", "hv_List", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"0.5", "*", 
        RowBox[{"Cross2d", "[", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "+", "i"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "hv", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.906130090477276*^9, 3.906130134870748*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"97592e27-686d-40d1-af7f-e41f521bb520"],

Cell[CellGroupData[{

Cell["energy derivatives", "Subsection",
 CellChangeTimes->{{3.921773846751827*^9, 
  3.9217738540962567`*^9}},ExpressionUUID->"64e6dd28-0afc-40a6-9ba8-\
413f8cb3ad69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "1", "st", " ", "derivative", " ", 
    "of", " ", "e", " ", 
    RowBox[{"w", ".", "r", ".", "t", ".", " ", "h"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dedhGeneral", "[", 
    RowBox[{"hv_List", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dedhx", ",", "dedhy", ",", "hix", ",", "hiy", ",", "hiLastx", ",", 
       "hiLasty", ",", "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",",
        "hjLastx", ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", 
       ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hix", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"hiy", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", 
      RowBox[{"hiLastx", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"hiLasty", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", 
      RowBox[{"hiNextx", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"hiNexty", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dedhx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", "hiLasty"}], "+", 
           RowBox[{"1.`", " ", "hiNexty"}]}], ")"}], " ", "KA", " ", 
         RowBox[{"(", 
          RowBox[{"a", "-", "PA"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiLastx"}], "+", "hix"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiNextx"}], "+", "hix"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}], 
          ")"}], " ", "KP", " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "PP"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dedhy", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", "hiLastx"}], "+", 
           RowBox[{"1.`", " ", "hiNextx"}]}], ")"}], " ", "KA", " ", 
         RowBox[{"(", 
          RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}], 
          ")"}], " ", "KP", " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "PP"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"dedhx", ",", "dedhy"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9045833741432323`*^9, 3.904583548806188*^9}, {
  3.904583606629153*^9, 3.9045836070636253`*^9}, {3.904583682480673*^9, 
  3.904583686629364*^9}, {3.904584989909345*^9, 3.904584999523973*^9}, {
  3.90613032621171*^9, 3.906130327151304*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"3ff30ab7-2c15-4798-8fd6-e2fed1e9b966"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "generalized", " ", "function", " ", 
    "for", " ", "de2dhidhj"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjxx", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2xx", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                  RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], "2"], " ", 
               "KA"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                  "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                  ")"}], "2"], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "-", 
                 FractionBox[
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiy"}], "+", 
                 RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                 RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hix", "-", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hix"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hiy", "-", "hjy"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiy"}], "-", 
                 RowBox[{"0.5`", " ", "hjLasty"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiNexty"}], "-", 
                 RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hix", "-", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hix"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
                " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hiy", "-", "hjy"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
               RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hjLasty"}], "+", 
               RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2xx"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjxy", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2xy", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiLastx"}], "-", 
                 RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                 RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", "KA"}], "+", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]]}], ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hix"}], "-", 
               RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
               RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hix", "-", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiy"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}], "-", " ", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hix"}], "+", 
               RowBox[{"0.5`", " ", "hjLastx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiNexty"}], "-", 
               RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hix", "-", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiy"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
              " ", "KP"}], "+", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
               RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hjLastx"}], "-", 
               RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2xy"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjyx", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2yx", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiLastx"}], "-", 
                 RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                 RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", "KA"}], "+", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]]}], ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiy"}], "+", 
               RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiLastx"}], "-", 
               RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hiy", "-", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hix"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}], "+", " ", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiy"}], "-", 
               RowBox[{"0.5`", " ", "hjLasty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiNextx"}], "+", 
               RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hix"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
              " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hiy", "-", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", "KP"}], "-", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiLastx"}], "-", 
               RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hjLasty"}], "+", 
               RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2yx"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjyy", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2yy", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "0.5`"}], " ", "hiLastx"}], "+", 
                  RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], "2"], " ", 
               "KA"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                  "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                  ")"}], "2"], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "-", 
                 FractionBox[
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hix"}], "-", 
                 RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiLastx"}], "-", 
                 RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hiy", "-", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiy"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hix", "-", "hjx"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hix"}], "+", 
                 RowBox[{"0.5`", " ", "hjLastx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiNextx"}], "+", 
                 RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hiy", "-", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiy"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
                " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hix", "-", "hjx"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiLastx"}], "-", 
               RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hjLastx"}], "-", 
               RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2yy"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"de2dhdhGeneral", "[", 
     RowBox[{
     "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"de2dhihjxx", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}], ",", 
          RowBox[{"de2dhihjxy", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"de2dhihjyx", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}], ",", 
          RowBox[{"de2dhihjyy", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.904314259355904*^9, 3.9043143013526917`*^9}, {
   3.9043143488790092`*^9, 3.904314354014255*^9}, {3.904314415027624*^9, 
   3.904314423363253*^9}, {3.904314555148417*^9, 3.904314599101642*^9}, {
   3.904318762868161*^9, 3.904318817642514*^9}, {3.90431885241038*^9, 
   3.904318873326839*^9}, 3.904319021039928*^9, {3.904392556249627*^9, 
   3.904392556401775*^9}, {3.904392810921649*^9, 3.9043929592934637`*^9}, {
   3.904394000984392*^9, 3.904394001412709*^9}, {3.9043940324469566`*^9, 
   3.904394048533761*^9}, {3.904394098399927*^9, 3.904394174732284*^9}, {
   3.9043942389510603`*^9, 3.904394320233054*^9}, {3.904394353552403*^9, 
   3.904394461711257*^9}, {3.904394493168469*^9, 3.904394583446862*^9}, {
   3.90439462560255*^9, 3.904394702784791*^9}, {3.904394771091137*^9, 
   3.904394790284346*^9}, {3.9043948518335757`*^9, 3.9043948724480677`*^9}, {
   3.904394910666058*^9, 3.904394959684085*^9}, 3.9043950345912848`*^9, {
   3.904395570557641*^9, 3.904395606225356*^9}, {3.904395759800148*^9, 
   3.904395828380295*^9}, {3.904396020172752*^9, 3.90439605649513*^9}, {
   3.904396092602581*^9, 3.904396095458459*^9}, 3.9044012109332657`*^9, {
   3.904401864022257*^9, 3.904401889614188*^9}, {3.904402268602522*^9, 
   3.904402273229042*^9}, {3.904403439743452*^9, 3.904403444015863*^9}, {
   3.9044034866216917`*^9, 3.904403614145093*^9}, 3.904404080036344*^9, {
   3.904474899282307*^9, 3.904474940737397*^9}, {3.904474997295217*^9, 
   3.9044750614039793`*^9}, {3.9044756769934483`*^9, 3.904475710944205*^9}, {
   3.906130378818466*^9, 3.9061304112686157`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"b317a457-21a4-44d5-b47a-f4da402f9fd1"]
}, Closed]],

Cell[CellGroupData[{

Cell["vertex derivatives", "Subsection",
 CellChangeTimes->{{3.921773897312565*^9, 
  3.921773903497148*^9}},ExpressionUUID->"50212625-7264-4f7b-a10f-\
17542044be56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"dhd\[Epsilon]x", "[", 
   RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.903795352687204*^9, 3.903795440132812*^9}, {
   3.903795838604693*^9, 3.90379584018342*^9}, {3.903795900108468*^9, 
   3.90379590100532*^9}, {3.903795994917081*^9, 3.9037960064053936`*^9}, {
   3.903796054634122*^9, 3.903796071339532*^9}, 3.9037983789762387`*^9, {
   3.903800169376627*^9, 3.903800170760226*^9}, {3.9038022300365143`*^9, 
   3.9038022306007233`*^9}, {3.921776349490902*^9, 3.921776377482992*^9}, {
   3.921777454811824*^9, 3.921777455467723*^9}, 3.921777574528479*^9, 
   3.921837744762615*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"c6a20729-3051-4a4b-99b9-5348d1f3c5c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "r2y"}], " ", 
       SuperscriptBox["r3x", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["r1x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["r2x", "2"], " ", "r3y"}], "-", 
      RowBox[{
       SuperscriptBox["r2y", "2"], " ", "r3y"}], "+", 
      RowBox[{"r2y", " ", 
       SuperscriptBox["r3y", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["r1y", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}], "+", 
      RowBox[{"r1y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["r2x", "2"]}], "+", 
         SuperscriptBox["r2y", "2"], "+", 
         SuperscriptBox["r3x", "2"], "-", 
         SuperscriptBox["r3y", "2"]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
        RowBox[{"r1y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
        RowBox[{"r1x", " ", 
         RowBox[{"(", 
          RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
        RowBox[{"r2x", " ", "r3y"}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r1x", "-", "r2x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r1x", "-", "r3x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r2x", "-", "r3x"}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
      RowBox[{"r1y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
      RowBox[{"r1x", " ", 
       RowBox[{"(", 
        RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
      RowBox[{"r2x", " ", "r3y"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921776364226894*^9, 3.9217763779538193`*^9}, 
   3.921777455974271*^9, 3.921777645320986*^9, {3.921778599773904*^9, 
   3.921778620416403*^9}, 3.921778706998489*^9, 3.921825790999748*^9, 
   3.921837745269819*^9, 3.921841556080271*^9, 3.922208455011086*^9, 
   3.922208780145316*^9, 3.922208820044027*^9, 3.92220885545957*^9, 
   3.92220889728831*^9, {3.922208938098648*^9, 3.922208976110648*^9}, 
   3.922209247841673*^9, 3.922209343567905*^9, 3.922209395390934*^9, 
   3.922209439659915*^9, 3.92221356154722*^9, 3.9222136323293743`*^9, 
   3.922213731222976*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"d1c6eb18-08ca-4069-abbd-06b01562a723"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"dhd\[Epsilon]y", "[", 
   RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.921777438508647*^9, 3.921777463619939*^9}, 
   3.921777578082114*^9, 3.921837749432605*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"612a99df-5611-4aca-87c3-a30c66570bf6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
     RowBox[{"r1y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
     RowBox[{"r1x", " ", 
      RowBox[{"(", 
       RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
     RowBox[{"r2x", " ", "r3y"}]}]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r1x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["r2x", "2"], " ", "r3x"}], "-", 
      RowBox[{
       SuperscriptBox["r2y", "2"], " ", "r3x"}], "-", 
      RowBox[{"r2x", " ", 
       SuperscriptBox["r3x", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["r1y", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
      RowBox[{"r2x", " ", 
       SuperscriptBox["r3y", "2"]}], "+", 
      RowBox[{"r1x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["r2x", "2"]}], "+", 
         SuperscriptBox["r2y", "2"], "+", 
         SuperscriptBox["r3x", "2"], "-", 
         SuperscriptBox["r3y", "2"]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
        RowBox[{"r1y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
        RowBox[{"r1x", " ", 
         RowBox[{"(", 
          RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
        RowBox[{"r2x", " ", "r3y"}]}], ")"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921777436018972*^9, 3.92177746414749*^9}, 
   3.921777646408046*^9, {3.921778599854478*^9, 3.921778620483561*^9}, 
   3.921778707172991*^9, 3.921825791027471*^9, 3.921837749869547*^9, 
   3.921841556084936*^9, 3.922208455106283*^9, 3.922208780326917*^9, 
   3.9222088202204103`*^9, 3.922208857076406*^9, 3.92220889748458*^9, {
   3.922208938223367*^9, 3.9222089762033463`*^9}, 3.922209247926018*^9, 
   3.922209343650503*^9, 3.922209395466155*^9, 3.922209439746208*^9, 
   3.922213561675424*^9, 3.922213632403458*^9, 3.922213731344191*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"e19921bb-9cb6-42f6-8a65-6c293e251876"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"dh2d\[Epsilon]yd\[Epsilon]y", "[", 
   RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.921776402371735*^9, 3.921776410075952*^9}, {
   3.921777465572511*^9, 3.92177746712381*^9}, 3.92183775942223*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"48114874-44c8-4143-9ac2-463acf254ea1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
     RowBox[{"r1y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
     RowBox[{"r1x", " ", 
      RowBox[{"(", 
       RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
     RowBox[{"r2x", " ", "r3y"}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r1x", "-", "r2x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r1x", "-", "r3x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r2x", "-", "r3x"}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
      RowBox[{"r1y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
      RowBox[{"r1x", " ", 
       RowBox[{"(", 
        RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
      RowBox[{"r2x", " ", "r3y"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.921776411893934*^9, 3.921777470602911*^9, {3.921778600054521*^9, 
   3.921778620681086*^9}, 3.9217787073775806`*^9, 3.921825791158532*^9, 
   3.921837760174185*^9, 3.921841556140285*^9, 3.922208455304578*^9, 
   3.922208780543644*^9, 3.922208820415353*^9, 3.922208857394388*^9, 
   3.922208897686308*^9, {3.922208938438067*^9, 3.9222089763986583`*^9}, 
   3.922209248125871*^9, 3.922209343847865*^9, 3.922209395662767*^9, 
   3.922209439951063*^9, 3.9222135618716297`*^9, 3.922213632615529*^9, 
   3.922213731564142*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"b68c0ac4-2705-4fe5-a699-fcdc36130814"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"dh2d\[Epsilon]xd\[Epsilon]x", "[", 
   RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.921776494445819*^9, 3.921776495342057*^9}, {
   3.921777468387916*^9, 3.921777469676889*^9}, 3.9218377630336857`*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"b6f7702f-bd81-435e-82f0-518350d6df1f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
     RowBox[{"r1y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
     RowBox[{"r1x", " ", 
      RowBox[{"(", 
       RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
     RowBox[{"r2x", " ", "r3y"}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r1x", "-", "r2x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r1x", "-", "r3x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r2x", "-", "r3x"}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
      RowBox[{"r1y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
      RowBox[{"r1x", " ", 
       RowBox[{"(", 
        RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
      RowBox[{"r2x", " ", "r3y"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.921776497271702*^9, 3.921777471890304*^9, {3.9217786004995823`*^9, 
   3.921778621144479*^9}, 3.921778707829007*^9, 3.9218257912922153`*^9, 
   3.921837763461774*^9, 3.921841556194007*^9, 3.92220845574446*^9, 
   3.922208781384426*^9, 3.922208820892396*^9, 3.922208857862093*^9, 
   3.922208898568013*^9, {3.922208938901331*^9, 3.9222089773349123`*^9}, 
   3.92220924858012*^9, 3.922209344295103*^9, 3.922209396120258*^9, 
   3.92220944039161*^9, 3.922213562320169*^9, 3.922213633088579*^9, 
   3.92221373257178*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"9c81bec5-6fa9-461b-8003-470f80f2fd81"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "analytical", " ", "forms", " ", 
    "for", " ", "dhdgamma", " ", "and", " ", "d2hdgamma2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dhd\[Epsilon]xGeneral", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r2y"}], " ", 
              SuperscriptBox["r3x", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["r1x", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["r2x", "2"], " ", "r3y"}], "-", 
             RowBox[{
              SuperscriptBox["r2y", "2"], " ", "r3y"}], "+", 
             RowBox[{"r2y", " ", 
              SuperscriptBox["r3y", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["r1y", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}], "+", 
             RowBox[{"r1y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["r2x", "2"]}], "+", 
                SuperscriptBox["r2y", "2"], "+", 
                SuperscriptBox["r3x", "2"], "-", 
                SuperscriptBox["r3y", "2"]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
               RowBox[{"r1y", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
               RowBox[{"r1x", " ", 
                RowBox[{"(", 
                 RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
               RowBox[{"r2x", " ", "r3y"}]}], ")"}]}], ")"}]}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1x", "-", "r2x"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r1x", "-", "r3x"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}]}], 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
             RowBox[{"r1y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
             RowBox[{"r1x", " ", 
              RowBox[{"(", 
               RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
             RowBox[{"r2x", " ", "r3y"}]}]]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dhd\[Epsilon]yGeneral", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
            RowBox[{"r2x", " ", "r3y"}]}]], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["r1x", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["r2x", "2"], " ", "r3x"}], "-", 
             RowBox[{
              SuperscriptBox["r2y", "2"], " ", "r3x"}], "-", 
             RowBox[{"r2x", " ", 
              SuperscriptBox["r3x", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["r1y", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
             RowBox[{"r2x", " ", 
              SuperscriptBox["r3y", "2"]}], "+", 
             RowBox[{"r1x", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["r2x", "2"]}], "+", 
                SuperscriptBox["r2y", "2"], "+", 
                SuperscriptBox["r3x", "2"], "-", 
                SuperscriptBox["r3y", "2"]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
               RowBox[{"r1y", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
               RowBox[{"r1x", " ", 
                RowBox[{"(", 
                 RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
               RowBox[{"r2x", " ", "r3y"}]}], ")"}]}], ")"}]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2hd\[Epsilon]xd\[Epsilon]xGeneral", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
            RowBox[{"r2x", " ", "r3y"}]}]], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1x", "-", "r2x"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r1x", "-", "r3x"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}]}], 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
             RowBox[{"r1y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
             RowBox[{"r1x", " ", 
              RowBox[{"(", 
               RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
             RowBox[{"r2x", " ", "r3y"}]}]]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2hd\[Epsilon]yd\[Epsilon]yGeneral", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
            RowBox[{"r2x", " ", "r3y"}]}]], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1x", "-", "r2x"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r1x", "-", "r3x"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}]}], 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
             RowBox[{"r1y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
             RowBox[{"r1x", " ", 
              RowBox[{"(", 
               RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
             RowBox[{"r2x", " ", "r3y"}]}]]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.904584127926521*^9, 3.904584142283367*^9}, {
   3.904584625055174*^9, 3.904584639323862*^9}, {3.906130438548835*^9, 
   3.906130451769902*^9}, {3.921777484879904*^9, 3.921777494934762*^9}, {
   3.9217776525374737`*^9, 3.921777713723765*^9}, {3.921777783996724*^9, 
   3.921777784988348*^9}, 3.921836847563768*^9, {3.921836941907801*^9, 
   3.921836951332381*^9}, {3.921837787104688*^9, 3.921837825188109*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"8fb65a32-ade6-47fc-90e0-ec83862c1d3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "this", " ", "is", " ", "to", " ", "calculate", " ", 
    "de2dgammadgamma", " ", "for", " ", "cell", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"d2eid\[Epsilon]xd\[Epsilon]xGeneral", "[", 
      RowBox[{
      "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", 
       ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"de2dhdhGeneral", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"vList", ",", "i"}], "]"}], ",", "j", ",", "KA", ",", 
               "KP", ",", "PA", ",", "PP"}], "]"}], ".", 
             RowBox[{"dhd\[Epsilon]xGeneral", "[", 
              RowBox[{"ri", ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}]}], "]"}], ".", 
             RowBox[{"dhd\[Epsilon]xGeneral", "[", 
              RowBox[{"ri", ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "vList", "]"}]}], "}"}]}], "]"}], "+", 
          RowBox[{
           RowBox[{"dedhGeneral", "[", 
            RowBox[{
             RowBox[{"RotateLeft", "[", 
              RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
             "PA", ",", "PP"}], "]"}], ".", 
           RowBox[{"d2hd\[Epsilon]xd\[Epsilon]xGeneral", "[", 
            RowBox[{"ri", ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2eid\[Epsilon]yd\[Epsilon]yGeneral", "[", 
      RowBox[{
      "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", 
       ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"de2dhdhGeneral", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"vList", ",", "i"}], "]"}], ",", "j", ",", "KA", ",", 
               "KP", ",", "PA", ",", "PP"}], "]"}], ".", 
             RowBox[{"dhd\[Epsilon]yGeneral", "[", 
              RowBox[{"ri", ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}]}], "]"}], ".", 
             RowBox[{"dhd\[Epsilon]yGeneral", "[", 
              RowBox[{"ri", ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"allPoints", "[", 
                RowBox[{"[", 
                 RowBox[{"neilist", "[", 
                  RowBox[{"[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                   "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "vList", "]"}]}], "}"}]}], "]"}], "+", 
          RowBox[{
           RowBox[{"dedhGeneral", "[", 
            RowBox[{
             RowBox[{"RotateLeft", "[", 
              RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
             "PA", ",", "PP"}], "]"}], ".", 
           RowBox[{"d2hd\[Epsilon]yd\[Epsilon]yGeneral", "[", 
            RowBox[{"ri", ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.904588774883918*^9, 3.904588884153892*^9}, {
  3.904588916453887*^9, 3.90458896383661*^9}, {3.904589002328372*^9, 
  3.904589083617495*^9}, {3.904589212787785*^9, 3.904589218872802*^9}, {
  3.904589279843504*^9, 3.904589283398299*^9}, {3.904589394633286*^9, 
  3.904589429824355*^9}, {3.90458948833243*^9, 3.904589507708624*^9}, {
  3.904589579432266*^9, 3.904589605469116*^9}, {3.904589662919032*^9, 
  3.90458970306603*^9}, {3.904589924188938*^9, 3.904589924310618*^9}, {
  3.9045900036701*^9, 3.904590007945014*^9}, {3.904590687997143*^9, 
  3.904590704161474*^9}, {3.904591200828555*^9, 3.904591253354176*^9}, {
  3.904591591505011*^9, 3.9045916028670397`*^9}, {3.904605382965023*^9, 
  3.904605515344393*^9}, {3.906130493495236*^9, 3.906130552771426*^9}, {
  3.921777725322528*^9, 3.921777829589095*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"084a8052-a8ea-415c-ba1f-e49291980e5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "this", " ", "is", " ", "to", " ", "calculate", " ", 
    "dedgamma", " ", "for", " ", "cell", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"deid\[Epsilon]xGeneral", "[", 
      RowBox[{
      "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", 
       ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dedhGeneral", "[", 
           RowBox[{
            RowBox[{"RotateLeft", "[", 
             RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
            "PA", ",", "PP"}], "]"}], ".", 
          RowBox[{"dhd\[Epsilon]xGeneral", "[", 
           RowBox[{"ri", ",", 
            RowBox[{"allPoints", "[", 
             RowBox[{"[", 
              RowBox[{"neilist", "[", 
               RowBox[{"[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i", "+", "1"}], "==", 
                   RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}], ",", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"allPoints", "[", 
             RowBox[{"[", 
              RowBox[{"neilist", "[", 
               RowBox[{"[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}], ",", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Now", " ", "this", " ", "is", " ", "to", " ", "calculate", " ", 
     "dedgamma", " ", "for", " ", "cell", " ", "i"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"deid\[Epsilon]yGeneral", "[", 
      RowBox[{
      "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", 
       ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dedhGeneral", "[", 
           RowBox[{
            RowBox[{"RotateLeft", "[", 
             RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
            "PA", ",", "PP"}], "]"}], ".", 
          RowBox[{"dhd\[Epsilon]yGeneral", "[", 
           RowBox[{"ri", ",", 
            RowBox[{"allPoints", "[", 
             RowBox[{"[", 
              RowBox[{"neilist", "[", 
               RowBox[{"[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i", "+", "1"}], "==", 
                   RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}], ",", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"allPoints", "[", 
             RowBox[{"[", 
              RowBox[{"neilist", "[", 
               RowBox[{"[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}], ",", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.906132827205215*^9, 3.906132853317138*^9}, 
   3.906132884082106*^9, {3.906132923021924*^9, 3.906132956481184*^9}, {
   3.906133662693007*^9, 3.906133662922853*^9}, {3.906133712658743*^9, 
   3.906133715944762*^9}, {3.906218817065702*^9, 3.906218818843371*^9}, {
   3.921777839694077*^9, 3.921777862860722*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"1075be55-173e-4441-a5ff-043fd0bf882f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "This", " ", "gives", " ", "the", " ", "neighbor", " ", "list", " ", "of", 
    " ", "cell", " ", "i", " ", "in", " ", "a", " ", "counterclock"}], "-", 
   RowBox[{
   "wise", " ", "order", " ", "and", " ", "this", " ", "neighbor", " ", 
    "list", " ", "aligns", " ", "with", " ", "the", " ", "vertex", " ", "id", 
    " ", "list"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.906130586835259*^9, 3.906130590643478*^9}, {
  3.906130701731743*^9, 3.906130777146837*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"f198c114-d3d9-456f-92dd-4f1160169939"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reorderCCWIndices", "[", 
    RowBox[{"centerIndex_", ",", "neighborIndices_List", ",", "allPoints_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "center", ",", "neighbors", ",", "angles", ",", "sortedIndices"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"center", "=", 
       RowBox[{"allPoints", "[", 
        RowBox[{"[", "centerIndex", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"neighbors", "=", 
       RowBox[{"allPoints", "[", 
        RowBox[{"[", "neighborIndices", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"angles", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", "center"}], "&"}], "/@", "neighbors"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sortedIndices", "=", 
       RowBox[{"Ordering", "[", "angles", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"neighborIndices", "[", 
       RowBox[{"[", "sortedIndices", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"neighborIndices", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"FirstPosition", "[", 
           RowBox[{"sortedIndices", ",", "i"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "neighborIndices", "]"}]}], "}"}]}], "]"}], 
     "*)"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"neighborListRightOrder", "[", 
    RowBox[{
    "i_", ",", "voronoiPolygons_List", ",", "cellIndex_", ",", "allPoints_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trianglesWithCenteri", ",", "neighborListRandomOrder", ",", 
       "neighborListCCWOrder", ",", "delaunay", ",", "vetices", ",", 
       "firstVerticeID"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"delaunay", "=", 
       RowBox[{"DelaunayMesh", "[", "allPoints", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trianglesWithCenteri", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"First", "/@", 
          RowBox[{"MeshCells", "[", 
           RowBox[{"delaunay", ",", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"#", ",", "i"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"neighborListRandomOrder", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "trianglesWithCenteri", "]"}], "]"}], ",", 
         "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"neighborListCCWOrder", "=", 
       RowBox[{"reorderCCWIndices", "[", 
        RowBox[{"i", ",", "neighborListRandomOrder", ",", "allPoints"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vetices", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"voro", "[", 
          RowBox[{
           RowBox[{"allPoints", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neighborListCCWOrder", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neighborListCCWOrder", "[", 
              RowBox[{"[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"j", "+", "1"}], "==", 
                  RowBox[{"Length", "[", "neighborListCCWOrder", "]"}]}], ",", 
                 RowBox[{"Length", "[", "neighborListCCWOrder", "]"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", 
                   RowBox[{"Length", "[", "neighborListCCWOrder", "]"}]}], 
                  "]"}]}], "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "neighborListCCWOrder", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"firstVerticeID", "=", 
       RowBox[{
        RowBox[{"Nearest", "[", 
         RowBox[{
          RowBox[{"vetices", "->", "Automatic"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"voronoiPolygons", "[", 
             RowBox[{"[", 
              RowBox[{"cellIndex", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RotateLeft", "[", 
       RowBox[{"neighborListCCWOrder", ",", 
        RowBox[{"firstVerticeID", "-", "1"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.90468534869175*^9, 3.904685348696452*^9}, {
   3.90468560748496*^9, 3.904685619254031*^9}, {3.904687047825791*^9, 
   3.90468714544456*^9}, {3.90468790441046*^9, 3.90468794568607*^9}, 
   3.904688618553898*^9, {3.904690094631613*^9, 3.904690095727626*^9}, {
   3.906130806424521*^9, 3.906130806920522*^9}, 3.906130877827166*^9, 
   3.906219735103504*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"7a8148f7-b39b-403d-a384-94edf263cde6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "function", " ", "that", " ", 
    "returns", " ", "a", " ", "list", " ", "of", " ", 
    FractionBox["dei", "dg"], " ", "and", " ", 
    FractionBox["d2ei", "dg2"], " ", "for", " ", "each", " ", "cell"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Analytical\[Epsilon]xCell", "[", 
      RowBox[{
      "allPoints_", ",", "box_List", ",", "pointID_List", ",", "KA_", ",", 
       "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vm", ",", "voronoiPolygons", ",", "min", ",", "max", ",", 
         "cellIndex", ",", "copies", ",", "translatedCopies", ",", 
         "translations", ",", "allPointsPBD"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"copies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"translations", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
        RowBox[{"translatedCopies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "+", "translation"}], "&"}], ",", 
             RowBox[{"copies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"allPointsPBD", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"translatedCopies", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min", "=", 
         RowBox[{
          RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
        RowBox[{"max", "=", 
         RowBox[{
          RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vm", "=", 
         RowBox[{"VoronoiMesh", "[", 
          RowBox[{"allPointsPBD", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"voronoiPolygons", "=", 
         RowBox[{"MeshPrimitives", "[", 
          RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cellIndex", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"RegionMember", "[", 
                 RowBox[{
                  RowBox[{"voronoiPolygons", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"allPointsPBD", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
               "]"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"deid\[Epsilon]xGeneral", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}], ",", 
            RowBox[{"d2eid\[Epsilon]xd\[Epsilon]xGeneral", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "pointID"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Analytical\[Epsilon]yCell", "[", 
      RowBox[{
      "allPoints_", ",", "box_List", ",", "pointID_List", ",", "KA_", ",", 
       "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vm", ",", "voronoiPolygons", ",", "min", ",", "max", ",", 
         "cellIndex", ",", "copies", ",", "translatedCopies", ",", 
         "translations", ",", "allPointsPBD"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"copies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"translations", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
        RowBox[{"translatedCopies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "+", "translation"}], "&"}], ",", 
             RowBox[{"copies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"allPointsPBD", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"translatedCopies", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min", "=", 
         RowBox[{
          RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
        RowBox[{"max", "=", 
         RowBox[{
          RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vm", "=", 
         RowBox[{"VoronoiMesh", "[", 
          RowBox[{"allPointsPBD", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"voronoiPolygons", "=", 
         RowBox[{"MeshPrimitives", "[", 
          RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cellIndex", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"RegionMember", "[", 
                 RowBox[{
                  RowBox[{"voronoiPolygons", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"allPointsPBD", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
               "]"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"deid\[Epsilon]yGeneral", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}], ",", 
            RowBox[{"d2eid\[Epsilon]yd\[Epsilon]yGeneral", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "pointID"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9061309008804817`*^9, 3.906130902084465*^9}, {
   3.906130944911058*^9, 3.906131000856138*^9}, 3.906131036625212*^9, {
   3.906131100620724*^9, 3.906131101861796*^9}, {3.906133757928031*^9, 
   3.906133781273082*^9}, {3.9061338404375696`*^9, 3.9061338924887137`*^9}, {
   3.906217108946573*^9, 3.906217320241297*^9}, {3.906217354916769*^9, 
   3.906217380642602*^9}, 3.9062197625754976`*^9, 3.9062204061114902`*^9, {
   3.906220492405673*^9, 3.906220507516293*^9}, {3.921777958192114*^9, 
   3.9217780086249948`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"b8302214-8022-48c4-9cbc-ff24758ebba7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AnalyticalCell\[Epsilon]yTest", "[", 
    RowBox[{
    "allPoints_", ",", "box_List", ",", "pointID_List", ",", "KA_", ",", 
     "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vm", ",", "voronoiPolygons", ",", "min", ",", "max", ",", "cellIndex", 
       ",", "copies", ",", "translatedCopies", ",", "translations", ",", 
       "allPointsPBD"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"copies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"translations", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      RowBox[{"translatedCopies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "translation"}], "&"}], ",", 
           RowBox[{"copies", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"allPointsPBD", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"translatedCopies", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{
        RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
      RowBox[{"max", "=", 
       RowBox[{
        RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vm", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"deid\[Epsilon]yGeneral", "[", 
           RowBox[{"allPointsPBD", ",", 
            RowBox[{
             RowBox[{"voronoiPolygons", "[", 
              RowBox[{"[", 
               RowBox[{"cellIndex", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"allPointsPBD", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"neighborListRightOrder", "[", 
             RowBox[{
             "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
              "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",", 
            "PP"}], "]"}], ",", 
          RowBox[{"d2eid\[Epsilon]yd\[Epsilon]yGeneral", "[", 
           RowBox[{"allPointsPBD", ",", 
            RowBox[{
             RowBox[{"voronoiPolygons", "[", 
              RowBox[{"[", 
               RowBox[{"cellIndex", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"allPointsPBD", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"neighborListRightOrder", "[", 
             RowBox[{
             "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
              "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",", 
            "PP"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "pointID"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AnalyticalCell\[Epsilon]yTest", "[", 
    RowBox[{
    "allPoints_", ",", "box_List", ",", "pointID_List", ",", "KA_", ",", 
     "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vm", ",", "voronoiPolygons", ",", "min", ",", "max", ",", "cellIndex", 
       ",", "copies", ",", "translatedCopies", ",", "translations", ",", 
       "allPointsPBD"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"copies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"translations", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      RowBox[{"translatedCopies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "translation"}], "&"}], ",", 
           RowBox[{"copies", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"allPointsPBD", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"translatedCopies", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{
        RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
      RowBox[{"max", "=", 
       RowBox[{
        RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vm", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"deid\[Epsilon]yGeneral", "[", 
         RowBox[{"allPointsPBD", ",", 
          RowBox[{
           RowBox[{"voronoiPolygons", "[", 
            RowBox[{"[", 
             RowBox[{"cellIndex", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"allPointsPBD", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"neighborListRightOrder", "[", 
           RowBox[{
           "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
            "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",", 
          "PP"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "pointID"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.906218400714576*^9, 3.9062184085961027`*^9}, {
   3.90621856274302*^9, 3.906218572019668*^9}, {3.906219670250162*^9, 
   3.906219672226655*^9}, 3.906219759154039*^9, {3.9062199548309517`*^9, 
   3.906219955245036*^9}, {3.9217785054196043`*^9, 3.92177851327596*^9}, {
   3.921826076550517*^9, 3.921826084642733*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"e0864ef4-a0c2-4055-9af3-189c094808d0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical function:", "Section",
 CellChangeTimes->{{3.906131141235631*^9, 
  3.906131160496708*^9}},ExpressionUUID->"d94f9a14-62f1-49f6-8b5a-\
e9ec9ecfdf7e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "function", " ", "returns", " ", 
   FractionBox["dei", "dg"], " ", "and", " ", 
   FractionBox["d2ei", 
    RowBox[{"dg", "^", "2"}]], " ", "for", " ", "each", " ", "cell"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9061326579081097`*^9, 3.906132664814098*^9}, {
  3.906132720467406*^9, 3.906132746401671*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"7eba5210-dcce-495b-bdf7-67c18d8ab094"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"numdericalCell\[Epsilon]x", "[", 
    RowBox[{
    "allPoints_List", ",", "box_List", ",", "ddx_", ",", "ka_", ",", "kp_", 
     ",", "pa_", ",", "pp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Vareas0", ",", "Vperis0", ",", "Vareas1", ",", "Vperis1", ",", 
       "VareasI", ",", "VperisI", ",", "copies", ",", "translations", ",", 
       "translatedCopies", ",", "allPointsPBD", ",", "cellIndex", ",", 
       "cellIndex0", ",", "cellIndex1", ",", "strainfor", ",", "strainback", 
       ",", "vm", ",", "vm1", ",", "vm0", ",", "allPointsPBD0", ",", 
       "allPointsPBD1", ",", "min", ",", "max", ",", "voronoiPolygons", ",", 
       "voronoiPolygons1", ",", "voronoiPolygons0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"copies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"translations", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      RowBox[{"translatedCopies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "translation"}], "&"}], ",", 
           RowBox[{"copies", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"allPointsPBD", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"translatedCopies", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"strainfor", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "+", "ddx"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"strainback", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "ddx"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{
        RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
      RowBox[{"max", "=", 
       RowBox[{
        RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vm", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"VareasI", "=", 
       RowBox[{"PropertyValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vm", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"VperisI", "=", 
       RowBox[{"RegionMeasure", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MeshPrimitives", "[", 
           RowBox[{"vm", ",", "2"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"allPointsPBD0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"strainfor", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vm0", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons0", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm0", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons0", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD0", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD0", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Vareas0", "=", 
       RowBox[{"PropertyValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vm0", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Vperis0", "=", 
       RowBox[{"RegionMeasure", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MeshPrimitives", "[", 
           RowBox[{"vm0", ",", "2"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"allPointsPBD1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"strainback", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vm1", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"min", "+", 
              RowBox[{"0.001", "*", "min"}]}], ",", 
             RowBox[{"max", "+", 
              RowBox[{"0.001", "*", "max"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Vareas1", "=", 
       RowBox[{"PropertyValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vm1", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Vperis1", "=", 
       RowBox[{"RegionMeasure", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MeshPrimitives", "[", 
           RowBox[{"vm1", ",", "2"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons1", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons1", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD1", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ka", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vareas0", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                 ")"}], "^", "2"}]}], "+", 
             RowBox[{"kp", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vperis0", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                 ")"}], "^", "2"}]}], "-", 
             RowBox[{"ka", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vareas1", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                 ")"}], "^", "2"}]}], "-", 
             RowBox[{"kp", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vperis1", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                 ")"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "ddx"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}], "-", 
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ka", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VareasI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                     ")"}], "^", "2"}]}], "+", 
                 RowBox[{"kp", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VperisI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                     ")"}], "^", "2"}]}]}], ")"}]}]}], ")"}], "/", "ddx"}], 
           "/", "ddx"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numdericalCell\[Epsilon]y", "[", 
    RowBox[{
    "allPoints_List", ",", "box_List", ",", "ddx_", ",", "ka_", ",", "kp_", 
     ",", "pa_", ",", "pp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Vareas0", ",", "Vperis0", ",", "Vareas1", ",", "Vperis1", ",", 
       "VareasI", ",", "VperisI", ",", "copies", ",", "translations", ",", 
       "translatedCopies", ",", "allPointsPBD", ",", "cellIndex", ",", 
       "cellIndex0", ",", "cellIndex1", ",", "strainfor", ",", "strainback", 
       ",", "vm", ",", "vm1", ",", "vm0", ",", "allPointsPBD0", ",", 
       "allPointsPBD1", ",", "min", ",", "max", ",", "voronoiPolygons", ",", 
       "voronoiPolygons1", ",", "voronoiPolygons0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"copies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"translations", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"box", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
      RowBox[{"translatedCopies", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "translation"}], "&"}], ",", 
           RowBox[{"copies", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"allPointsPBD", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"translatedCopies", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"strainfor", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "+", "ddx"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"strainback", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "-", "ddx"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{
        RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
      RowBox[{"max", "=", 
       RowBox[{
        RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vm", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"VareasI", "=", 
       RowBox[{"PropertyValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vm", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"VperisI", "=", 
       RowBox[{"RegionMeasure", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MeshPrimitives", "[", 
           RowBox[{"vm", ",", "2"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"allPointsPBD0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"strainfor", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vm0", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons0", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm0", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons0", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD0", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD0", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Vareas0", "=", 
       RowBox[{"PropertyValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vm0", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Vperis0", "=", 
       RowBox[{"RegionMeasure", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MeshPrimitives", "[", 
           RowBox[{"vm0", ",", "2"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"allPointsPBD1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"strainback", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vm1", "=", 
       RowBox[{"VoronoiMesh", "[", 
        RowBox[{"allPointsPBD1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"min", "+", 
              RowBox[{"0.001", "*", "min"}]}], ",", 
             RowBox[{"max", "+", 
              RowBox[{"0.001", "*", "max"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Vareas1", "=", 
       RowBox[{"PropertyValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vm1", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Vperis1", "=", 
       RowBox[{"RegionMeasure", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MeshPrimitives", "[", 
           RowBox[{"vm1", ",", "2"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"Polygon", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"voronoiPolygons1", "=", 
       RowBox[{"MeshPrimitives", "[", 
        RowBox[{"vm1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellIndex1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RegionMember", "[", 
               RowBox[{
                RowBox[{"voronoiPolygons1", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"allPointsPBD1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "allPointsPBD1", "]"}]}], "}"}]}], 
             "]"}], ",", "True"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ka", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vareas0", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                 ")"}], "^", "2"}]}], "+", 
             RowBox[{"kp", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vperis0", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                 ")"}], "^", "2"}]}], "-", 
             RowBox[{"ka", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vareas1", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                 ")"}], "^", "2"}]}], "-", 
             RowBox[{"kp", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Vperis1", "[", 
                  RowBox[{"[", 
                   RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                 ")"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "ddx"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}], "-", 
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ka", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VareasI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                     ")"}], "^", "2"}]}], "+", 
                 RowBox[{"kp", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VperisI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                     ")"}], "^", "2"}]}]}], ")"}]}]}], ")"}], "/", "ddx"}], 
           "/", "ddx"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903626715198685*^9, 3.903626826615308*^9}, {
   3.9036268679519577`*^9, 3.903626873735411*^9}, {3.903626942452201*^9, 
   3.903626944611924*^9}, {3.903627039394018*^9, 3.903627044507419*^9}, {
   3.9036314828750973`*^9, 3.903631515196673*^9}, {3.904605602190879*^9, 
   3.904605676747971*^9}, {3.904605919754586*^9, 3.9046059212402062`*^9}, {
   3.904749830201756*^9, 3.90474998966967*^9}, {3.904750061925131*^9, 
   3.904750065768656*^9}, {3.904750132076775*^9, 3.904750139359756*^9}, {
   3.906131477293146*^9, 3.906131742280287*^9}, {3.906131787250983*^9, 
   3.906131820951946*^9}, {3.906131854588011*^9, 3.906131914810781*^9}, {
   3.906132142017092*^9, 3.9061321582109547`*^9}, {3.906132205471896*^9, 
   3.906132401838616*^9}, {3.906132548247774*^9, 3.9061325735235987`*^9}, {
   3.906132613232308*^9, 3.906132648239827*^9}, {3.906132679997253*^9, 
   3.906132708293361*^9}, 3.9062197541342583`*^9, {3.906220761831339*^9, 
   3.906220839703073*^9}, 3.906221018139063*^9, {3.906222223804881*^9, 
   3.906222230351351*^9}, 3.921778021139808*^9, {3.921778127156601*^9, 
   3.921778179485294*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"967a39b9-849d-4c27-bc3a-d4d20cb8f69b"]
}, Closed]],

Cell[CellGroupData[{

Cell["One snapshot to test numerical and analytical", "Section",
 CellChangeTimes->{{3.91372777665914*^9, 3.913727798549033*^9}, {
  3.921778194371974*^9, 
  3.92177820075561*^9}},ExpressionUUID->"7c3b2c47-fe19-4dde-81f5-\
bec6171cb843"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</Users/chengling/Downloads/nvt_stress_tensor_N100_p3.800_T0.\
01000000_0.nc\>\"", ",", "\"\<Data\>\""}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</home/chengling/Research/Project/Cell/AnalyticalG/data/N100/\
derivativeTest/nvt_stress_tensor_N100_p3.800_T0.01000000_0.nc\>\"", ",", 
     "\"\<Data\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.913392370327138*^9, 3.913392382077566*^9}, {
   3.913393695986911*^9, 3.913393696127836*^9}, {3.9133937315792513`*^9, 
   3.913393731743902*^9}, {3.913473284568802*^9, 3.913473287706699*^9}, 
   3.9134752661052713`*^9, 3.913556214896843*^9, 3.913726531327618*^9, 
   3.9137266888488703`*^9, 3.9137271803335114`*^9, 3.913727233569957*^9, 
   3.9137272991368093`*^9, 3.913727398367738*^9, 3.913738396648456*^9, {
   3.921778186916108*^9, 3.921778228620979*^9}, {3.921778275440714*^9, 
   3.9217782894461203`*^9}, {3.921825796894518*^9, 3.921825804097046*^9}, {
   3.921841562951129*^9, 3.921841573945501*^9}, {3.922208466292858*^9, 
   3.922208467668425*^9}, {3.9222085219123287`*^9, 3.922208541373795*^9}, {
   3.922208611989833*^9, 3.922208629947854*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"c09bc8d5-b04c-4b76-9ae8-e7bd10cd5372"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"/BoxMatrix\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    
                    TemplateBox[{
                    "10.`", "\", \"", "0.`", "\", \"", "0.`", "\", \"", 
                    "10.`"}, "RowDefault"], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     RawArray["Real64",{{10., 0., 0., 10.}}],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/d2Edgammadgamma\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    
                    TemplateBox[{
                    "2.4789578207609555`", "\", \"", "5.301676378380087`", 
                    "\", \"", "2.3626204044062455`", "\", \"", 
                    RowBox[{"-", "10.161171240893772`"}], "\", \"", 
                    "7.545661575710668`", "\", \"", "\"\[Ellipsis]\""}, 
                    "RowDefault"], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIRiE8AccrypmvP
rzA7cFTyLH9lIurA6nOubekzJocpyYWcrUEqBy4WVr44qCfn8Gj5marEA1/t
F56Pff2c5bP9SrE3VkFZigd2b/bYaRjAd6BY4POWL2yCDoavjmjlXnuzPy+T
L8L/DL/Dv3/7w+0nijk8VT23IC6B0+HXkp9nbzeqOqiFfv7/j+O1vYBD8o+P
NXIHbj2fu/gUE69D1o+Gj0fO8h2YtMFxi+vn3/sLq8Laoyq/7Pe2yZ3oE/lo
/1+9F897Fbkdlrluzr1hyeHgbBWm379AyEExrWSrvdtt+zmzrxd4zBI+0Lj/
yCzV6f/2O/DpNxS63Np/a+f3Mv0V3Ac6F94suGor6PDzuVDi3MsKDv4zPsVc
2/JzfxbzjI2HOR/ZT+7NF/DczHBgX5z4QytV4QO7vv6YzC/1y77JI2Tx61Oc
Dht7qzbyXXltz2Hx+33Siw/2CWcXzJq2zMahtfXDwqJuJwfZ6wJeXdISB3Z0
FVZ+Dj9jv8royU+xbiOHvxsfr0g8weVgHnG0ZMFbjgMGqRNPP5JVdAiJ+ST9
tZnP4eiOls+zJgg6cCwM/afK/cNeYbLihWlbN9k/nCzIdHi/lUNCxqsDhxXu
2Ztt2Jt/ssPOwfy3Dtfsa5IHFqldj/E4yOGwxmz+p6yH/+w7FXeZlHGIHCg8
L6pnFXvVfh/jFhXdHWwOfga1sapl3+wrWCSfiu1VdKi+cq+x6f4n+wSrHed6
JWwcLOyL1Xrt+R12F4SlHSvhdtDLUJKIlL1m73lgzXL5tV/snyvtnXtG7PF+
m+WizzQnyjrs2R7NkBT7an+Q/a6A01xv9hudDKlc+1rIoaNv6v6EdbIH3i4X
tX13U8Jh+eISFXcWoQMXe+cUMSoLH7CcqudSlsF1IFE2/HLNWjkHkaJDuvsv
/Nv/vfB2QIIlv4PA1I/+a5azHli36LL9ZHZGh0UlE1qNm1Qcll3TOluz/pu9
zHvrxwvnXLVPL3SWadoj5CAiKWAsPIPBIdxSKFF00k17oRL7oHaFt/ZbYkqb
Np7Sd9jEOEOzUv++/bU1gZsdbKUcFJjmJHklJ+zvW/JHYMbBd/a2TzysHthL
HDA8cu/65pt8DtFmE/8GXlFwWMbtrtJc9cqeAQoCofQGZp+LpmEMDBOeeYNp
UkEAlF7ACKEfMELME7hgB6ZB2ZQVipmhNEiMHYg5GBDy7FA2C5SNrI4di3pW
JDYLGh9Zng1JHMbmgOphQbKbA8luDiT3wNyAbi4LkhyyO7nR3MmGZh5IjBPJ
bmY0c7mQ2JxI6mE0sn9YkexFFudAkoeBhYwYUTcKsAAA4UCSjw==
     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/energy\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TemplateBox[{"144.68315964738693`"}, "RowDefault"], 
                    "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     RawArray["Real64",{{144.68315964738693`}}],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/neighbor\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Integer32\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2000"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Integer32\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2000"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    
                    TemplateBox[{
                    "13", "\", \"", "57", "\", \"", "29", "\", \"", "69", 
                    "\", \"", "83", "\", \"", "\"\[Ellipsis]\""}, 
                    "RowDefault"], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJztl/lSlFcQxS+IhCVsgjMQXEC2YRsEZtQIzCJimCjIIuKGbGX8T6tIqizf
Mm+U9Kn5TdU4de+dB/DrqpNUmP76dp8+3fdm/OLrwV+tzrm/O+wfB+ffyldX
598PO+0/Kl/++fT509Xqyhf93mL49xfneuzfvxtuG7YMh4b/AvbYfntrKBlW
DNOGRcNrzze99rcL4hUMTyJxFeuN4ZahK+Ine2C/DxuODduGG4abgW+Um2go
GlYNHyKxt6hL9f1pGI34ljnzTpNcazmIpyHyuB755pH9ljb8YTgxLBiOAv7X
4CtvuGt4yBkrHn/VMkGfFuHhKX1p7PcxZ58a7hk2Dc8COaTQjiPO80htL+23
PTTRih5GDDOeb+bIT3nuGAYNvwViT9rf1wyPIlzVbB+ujtCQtLRs2PB8p/62
obFMk14rtz5yPTeM0UOf7zQ96qJnl+iiw+O/TI5t6Fw52Mi6ssd33v52Rq/U
kx76sefxLcDvHLwq1044XGvw1/kDcLbA3LUFauulr5Po0tfbmqU5v4/+hviS
SVuaz3ZXnU1puTsyF284O+/i+0Q8zRLbNdGOeL9JHzKBHtTsIefm4U387Qf8
T6h9EO2cRuIe4FMxvDPcj/j+Six9s+uqcxzyHYVX7T7t+NcRfkfosXTST335
gO82epEu59FiJuCrvdTCbAwF5qFm6q/2ifQ2wvm3Av7ql/KY4vyyC8/yJlyJ
1yy6uM08Ne7ANDPU58K7qWZTcJAKzGO9HTGLJ3A3HPHvplfibRrOdL/47jnV
tGR4b/hoyLnqfbfFDNT7vsMv20Rjsl00No4ml/iuMaZMut1gHh4wT+rHK3Kq
91WPrzFHQ9TXQs6NcT9Qd5HZ0IzsBPLOcpbOXDe8CMSUdaGrGXQ2id7vevwH
6FUbdS1HeOsihnbCJfWFfPuZtTS6iN1xKXQ6i25lPQF/7dC3cOp7v9Wb6tbM
F8hD90R/4Jsc3JbR+kv4feHxL1L/PppYpn++uHoz6B7oZu7S8OJ7V3bA6SV6
U8xV53975chtnVyluxV4ET/tzEiW/NRb3QXaIRlqXKfm+rjaTa1wtoZ2RgK1
aVfrrbVL70LvLVkBDqR57Z45uPD5zpJ3iTpG4dChj3rfM1fdN8plkzy091Ke
2J2cqb2ne2vMVfeVL4cbzIRiT7nw/pepR0V6Jq41p9pD2ivaL+d137bTnwkX
f6vLUsyBar9w8R2co5+lJjFlffRhldwGI9+ov9qT9+E2dh+XyEF5Skcz6NLn
m4HXeXr1nBp70bPi1N4qG8yE3ifaPwNN8j2lrnHy3g34O2ZkFG0W0P4F+dTv
oI/0tkxuuUgOyjHP7GjfaO9Ie3qHDjfk340W9H7R7C5G4g4T4wS9a97O4HHb
/fi+LcGjeqC7QHeS7/+xZHpDtaOdFnKZCPiK0wr6XnLxe3aJGagwE9mIrzT5
lD6Ig+vo03cfLsCn3p9j9Ft8HHt833O+eveKvoXyGEM30vs9Yob2wxTnPUO/
85HadqilgiYPyFnnNc6e9L+H/g7RYyjuEDOhe0gzUoz4JpZYYoklllhiiSWW
WGKJJfZz2v++GUxL
     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/position\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, 
                GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    
                    TemplateBox[{
                    "6.230916198220728`", "\", \"", "9.703199993403826`", 
                    "\", \"", "3.207940152166047`", "\", \"", 
                    "8.147672192050777`", "\", \"", "8.170150164350776`", 
                    "\", \"", "\"\[Ellipsis]\""}, "RowDefault"], 
                    "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJwVk3s81IkCxWUwRENjXgYzv5kp696wyGvV+p12cm1lqamtq8eqrEQeea6k
Vmsjj9tiPdNjb8grF2n1qSbC1aiVMrfyzNadLWLGc7wra//4ns/nfM758xzB
4TDJEU0NDY1I3WWRHPpuU0TEoRM7df4y/oeCnRz8/wpXLNO2jPHbe9uilRxQ
w/Y/0zsqQtEvbUn95XrQeJBUU7iNwN48ntJ8D4H7gumEnBQBDGQB/zzVtUCe
WUm7UNdH4FzL4PvCCCECe08sjvmvQsKetWLtXl2E+oSEfzbEhfjz/d3BUXTI
i7rqPlYIcb3w6mi0soekqwTdjpPaCD23pZ8+QsWmrles5M2mYH0YrC0X8tDR
0PnTuB8bs6ddpKn5c6S0QD11tYEHiWDL4rq/GyNDIwdxpTxk5aTMZHdxMVbl
au0TpQet351ihu6Yw3rcO0KHIyV3qicUTwuE8Batb49+KIDZi4rtDqcZ4Pm5
ha2SstHbVtlad0iA7AmK/dnHprixMCpSkJOkZaVLbpQTExpaFlPK30Soymrw
rlihA6Oqb8OnstjQYh9dO3WSiYzUnFv+ThRw5HJnI8IMzTHiEEFEDyn4RF3p
NaaD2qrpf9Rp83He0bNcohwjM3ofuEYmcmHT7fuG88wENy1oWT9WCrDux89t
qojVSP+gUzuiEoKhu6Q+5s7HadHvEU9n2KhpkLbK9rExtyc+NDnbGJnJDjZF
7wQIkL5Wx/tOkNl11+i3YgiMBYTc+CKdAzn7psIlPIS8f85yvaKyi6QMyriU
YG3ctpgviq4bJxsZmzfWR3Cx9GZb0NehHJxUBN3MPU6Hv99KhdVPdITKrO/X
6qzCbiu7bzaOsjDQodTN69CDckv39ep5I9R5pPQ8/TeBpRsvo1TfChHZabD9
2gEebqoOWny1QGCtQrc1JWuRdK8J/4MY0ELJeUWGlo8Z9KzunT1xdZgMP9cl
DSokMCBo31G9R4RPf9goV8dq4hvZE7+sYDYWq7YGu+xbJOeTEzVFlSwkT/Bo
cZ+a4EOGYA69fJS+jGZEHZghhabdbQyhAP8tbe1ZYtPxpO9YvKVaDzqqfzEs
vzTH3njXu56zVARd3FxKYgXkg9nFVjwjxFDbmUPWeqhNivNZX2eMfQ5y2zRD
XRy1kyVMxc+SO/zK3gYGGmLCtZzmPvmeVOt/UsRrJ1Dta3b4P5uMkBA7eeu7
XBY2Fh+cVpZQYI/LDkPt06SXcVhMqMYAqaaOjVxIN4dHXP3Xnv97TSp5ljJt
5mpMP7JhPGpQk0ccxS153ly42heGXXtPwLOxJTWxjYvdApbu4jpTxEnGyyLX
PiOPG9yhmUtpOLlhiWsVQqC7Nf/0q+V+d2qAv99OM/gmzmX7jX0gB9ymQqo9
xskzPeLBixHzpIO47jjPjol7DLF7i68JvD4aVUXV8kGogiv/aNZCs+LUgxCq
CbyHV6bsjdDCqF2p2yVJN9nnnL7eOVZF1l7amlxmp4385Kt85yECYcojE6+r
CZhsW1KHxXKQseXa89RkKiyP/J+224OFL6z0VYtVpriz6fvb9TQmhm1nRLPv
RDimKZNJLpsh/0n6LjfTBXJ7ZtL1tCEOmv3EDbSPTFh61lZMfSaC5apIL4NF
ChLL9u/sn9BG6pr4hZdyI5xRb6gnh1YDFv2F+koBGJlFgaOPeci8a/mLu1oE
VvRMTMAzDTjcrap0vj1KzkikjxptjaEudvPeeoWF4Njie25HmTAMNm72Y+hi
WHylR9NASfbpmXWS+SIkeZ16l3RFiLNpQQ1M7iQpDr3YbGirJqMKPFTDShYu
d/reHbzAQHHZhc7ENTRYFH7v2XOAA312/sfmCgEcRw6U8jxXYJ9pR3reSgo6
zEfcXVIFkL83yc9aw8VwtOe8xhVDqH8ttn9uTcD9rc2Qri8fNz4S2tIQfWxv
+VvIialZ8pJiyTg3XIDzb+yJpnIj1D4MLDn8qwCJjnOKgOW9yn/OMU1f/t+u
8/zeud/08MJnWGbVpYOmmue7SrTpiHtcre6rZ6PpVatkF4eHpRJQCyl0FH+1
g2qUSwG/qeAFJZ2C3I6AcLkFByVM6uzDgdXgkzVOsjw+NnALPJoMZ0nbde8q
+jONMZ1GZYUK6WjUVPicOkhAkuD7Q/VmIaYTTFRPdJbItMaD9pcSTfAndi7S
Gw==
     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/sigma\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TemplateBox[{
                    RowBox[{"-", "0.2618547532316889`"}], "\", \"", 
                    RowBox[{"-", "0.010216064836690766`"}], "\", \"", 
                    "0.43408664422673937`", "\", \"", "1.4912241219305642`", 
                    "\", \"", "\"\[Ellipsis]\""}, "RowDefault"], 
                    "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJztkm1U01Ucx7fxZBA4HsTsxHMdmAMcC8RAuX8T6SBIQshhEspSVscKJrBD
TjHgyGm+qIargcPEIRuKjoYgCAN+fxZ5UOEwHEQMgcUZRUIwnuRBqZBtp+RN
vexF33N+93Pu935/v/viXo/30uNYJAKBkLlhdYljZu/OyGCefMfy2SaV+dH2
wNRnh8TVal8t28okdohSBVVsPYkycRYcjr3GcGwfQClUqtr24QKacMqOPsg1
xx3ju+gC1mM0ZMWvsxOK4DiF75vuVoX4eeqi33xHwJ+exlDdHUCVHx/7475/
J6pFOWm192ZBJ2MmLO4cRK6k/BO+LUpQbAuPsZYSsI3y969zSb/DK+RSxbCL
Hf4J2y9vgjONelpilcKSGcSbrLR50V0FixEzTXSfGVR8wOOGpLkPApsyo7zi
+SD/tVkia5uAhoY6p9HvR6Fe4H1ddPMWoqdi6sQPVIjJbbAukPeBuLjlvt/8
MgQU7CnrHcOBLK8/PCAm4Uoa4/TmuXkIH3PlzUorgD5UY3Nk8wggZYTCzUeP
Xhbr4loVP0GEu2W6qLoXRnNCma2Jd2Dgh5BxybgWuQ8HFsllMgh2zFrp0pCw
DZq42MKdnjiyo1Gtj2pBeTuVkVBtifvTvAorpJZ4efCgRPl2B7jUOrMml4lY
x6Xs4MGMati6sLfSKXMOXGp6PJT3auBdEa5boivg8TfnAgZhETSaJPsgPzI2
FxPacnKqDtl4nmo9tcUT8yaLRE0Nw/B0r30R9TMiXnpIprq6T4Wq1P7lNAsL
nHdeEC9duoC26S5Suf2zKJebFRQqvAM/HuELu2+YYeJvqYF5pW3oly3pnGW9
N+58msci5Y8D081Z5EvRQZvm1ab0F75DOZT2cIs3pOiy4y5aMWcGDePnl1Z6
CDj2lqxaG9UOzqKQ5a05nTDCSmJLhVb41U0MUPVtwlPzwyuIxQso7CgxUTJk
hQk8OF/EsCeRPlK4HBz5BAnEB/1Xzlhh8hO3gz4ceQJZ9XZajkMZ0v28qzEM
74aHb5Zc4lMfoWufv977NXEBHszbXpAVzqCiaVcuz2IK7LuvNLOTFxG31TpF
s/QA5R0e3u7gVAy7u0C/v7QDeT2inOnyM8NYgaLkZPNrqPwmw1twZRrktKn+
zoKz8FVaya0IpxaQHvqynjcvQWU+x/eP322ESD4vV9mvBlFjJEU4tgQEo8RE
wnMiq8K6gxII/+s/Ig8j5UWRa++iUuxbo7vRN9HcSOyipybs07/6Y025RkOf
NinKwBJDzsT195l8/Jwhf8Do55rOFwy+6b/sMPpkY637VgT5U0PebJ2/w5g1
9f2TAoxMiTDMS3kpeo2XbaKeI82YY1v+i6GrwlYr+m/7PwH1sN0J
     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/time\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TemplateBox[{"4.68320599902335`*^-310"}, "RowDefault"], 
                    "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     {{4.68320599902335*^-310}},
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.913392384428406*^9, 3.91339369652736*^9, 3.913393732083776*^9, 
   3.913394410782865*^9, 3.9134732896346407`*^9, 3.913475267317169*^9, 
   3.913554264354388*^9, 3.913556220257312*^9, 3.9137265318446207`*^9, 
   3.913726689176271*^9, 3.9137271813702393`*^9, 3.913727233973132*^9, 
   3.91372730162633*^9, 3.913727398610985*^9, 3.913737724699085*^9, 
   3.913738397216159*^9, 3.913738517193323*^9, 3.913741777125329*^9, {
   3.92177827702912*^9, 3.921778290272038*^9}, {3.92177860079086*^9, 
   3.921778621440159*^9}, 3.9217787081532297`*^9, 3.921825827293518*^9, 
   3.92184157597217*^9, 3.921842171879115*^9, 3.92220846912267*^9, 
   3.922208535588451*^9, 3.9222086316818657`*^9, 3.922208781745632*^9, 
   3.922208821361599*^9, 3.922208858313512*^9, 3.9222088988932242`*^9, 
   3.922208939737656*^9, 3.92220897771255*^9, 3.922209249104124*^9, 
   3.9222093525717177`*^9, 3.922209399411441*^9, 3.92220944118787*^9, 
   3.922213562916688*^9, 3.922213633491703*^9, 3.9222137329529757`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"a700ddfc-e858-455e-af1f-2a6f91ef0e7a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "cellGPU", " ", "values", " ", "for", " ", "one", " ", "snapshot", 
    "\[IndentingNewLine]", 
    RowBox[{"sigmaXX", ":", "2.17859"}]}], ";", 
   RowBox[{"sigmaYY", ":", 
    RowBox[{"2.53152", "d2EdeXX2"}], ":", "1383.15"}], ";", 
   RowBox[{"d2EdeYY2", ":", "1202.97"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.92184161181919*^9, 3.921841613756771*^9}, 
   3.921842194317395*^9, {3.9218429464633303`*^9, 3.921842982407549*^9}, {
   3.922208662229816*^9, 3.922208665928094*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"c0f767ae-b527-439c-9cb1-0f02d24f6633"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"sigma", " ", "is", " ", 
   RowBox[{"dei", "/", "dgamma"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.91373780145113*^9, 3.913737868600988*^9}, {
  3.913737912772257*^9, 3.913737925048787*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"41b3d4fb-9436-46a8-ad75-2bbbead72d04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"positions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"5", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"5", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "+", "2"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "99"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913299871380925*^9, 3.913299954936655*^9}, {
   3.913300005203134*^9, 3.91330008464412*^9}, {3.913300154967265*^9, 
   3.913300181605715*^9}, 3.913388102078426*^9, {3.9133924177888527`*^9, 
   3.913392420356285*^9}, {3.913473338896167*^9, 3.9134733413375053`*^9}, 
   3.913737744014029*^9, {3.921778317758621*^9, 3.921778320862665*^9}, {
   3.921825841274139*^9, 3.92182584295593*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"731b91b0-0a28-42a9-9a13-4600e5c0ba50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.921841712863126*^9, 3.921841758884357*^9}, {
  3.9218418732000227`*^9, 3.92184187473042*^9}, {3.921841905270959*^9, 
  3.921841938522785*^9}, {3.921842204615357*^9, 3.9218422285220547`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"49249748-c9d3-4404-b6cc-76be0ffd698a"],

Cell[BoxData["ana1x"], "Output",
 CellChangeTimes->{{3.921841755243429*^9, 3.921841759274838*^9}, 
   3.921841835436949*^9, 3.921841875200695*^9, 3.921841938987057*^9, {
   3.921842211868658*^9, 3.921842229160816*^9}, 3.922208781824431*^9, 
   3.922208821567432*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"d5674574-cf04-4735-ab2f-e249761c7568"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ana1x", "=", 
   RowBox[{"Analytical\[Epsilon]xCell", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "100"}], "}"}]}], "]"}], ",", "1", ",", "1", ",", 
     "1", ",", "3.80"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.921837844521731*^9, 3.921837853711289*^9}, {
   3.921841642842409*^9, 3.9218416459554462`*^9}, 3.921841798574255*^9, 
   3.921842180642962*^9, {3.921842240320787*^9, 3.921842251173109*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"2cd80de2-1ace-4624-a3cd-2210bfee1b76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.92220875958672*^9, 3.922208764255165*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"9e18f200-fca9-43b8-9452-318cad625ca1"],

Cell[BoxData["217.85884008475102`"], "Output",
 CellChangeTimes->{3.922208873788499*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"ccc06c4c-fb7d-4251-9a2f-c2e4a7a446f9"],

Cell[BoxData["1383.1541981191474`"], "Output",
 CellChangeTimes->{3.922208873797934*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"5e43a2ea-3149-4f8c-a8a9-655356bc2fa5"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.913737879083346*^9, 3.913737887570783*^9}, {
   3.913737929377396*^9, 3.913737978614402*^9}, 
   3.921842502828749*^9},ExpressionUUID->"71f9168c-b3b7-44c7-9337-\
5f3e93dbdc60"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ana1y", "=", 
   RowBox[{"Analytical\[Epsilon]yCell", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "100"}], "}"}]}], "]"}], ",", "1", ",", "1", ",", 
     "1", ",", "3.80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1y", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1y", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.921842257922639*^9, 3.921842275850844*^9}, {
  3.922208735065938*^9, 3.922208737483123*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"1701dee6-1fb9-48f2-a394-0e9bf0f040cd"],

Cell[BoxData["253.15165150008175`"], "Output",
 CellChangeTimes->{3.921842291851368*^9, 3.922208696071497*^9, 
  3.922208919137774*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"339bd794-0eb7-4b7c-ac22-a79638d112e2"],

Cell[BoxData["1202.9732411860848`"], "Output",
 CellChangeTimes->{3.921842291851368*^9, 3.922208696071497*^9, 
  3.922208919146991*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"f1f45230-99ce-448c-8d59-6845a734f9f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1x", "=", 
   RowBox[{"numdericalCell\[Epsilon]x", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", "0.0001", ",", "1", ",", "1", 
     ",", "1", ",", "3.80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.913300104545122*^9, 3.9133001154518557`*^9}, {
  3.913300229335664*^9, 3.913300230398267*^9}, {3.921778338607361*^9, 
  3.921778347376163*^9}, {3.921841658410215*^9, 3.92184165873085*^9}, {
  3.921842287168519*^9, 3.921842300857524*^9}, {3.922208745587014*^9, 
  3.922208747473063*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"79d44025-8d51-46a7-b107-fb4458241a5c"],

Cell[BoxData["217.85884303029752`"], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"90ea7e67-58fa-455f-a6d7-ea4ccc8bfbe1"],

Cell[BoxData["1383.154186934514`"], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.922209302250751*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"ee7589d4-ee16-4dd9-bd20-0d326e4e797c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1y", "=", 
   RowBox[{"numdericalCell\[Epsilon]y", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", "0.0001", ",", "1", ",", "1", 
     ",", "1", ",", "3.80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1y", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1y", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.921842320787776*^9, 3.921842328274319*^9}, {
  3.922208751266975*^9, 3.92220875309063*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"936b0194-5185-4cca-aaf4-7f7783d8b96b"],

Cell[BoxData["253.15165415532852`"], "Output",
 CellChangeTimes->{3.9218423804411073`*^9, 3.922209348251233*^9, 
  3.922213768331305*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"efc2e267-6530-4850-862b-7dbd4baaaa26"],

Cell[BoxData["1202.9732448002628`"], "Output",
 CellChangeTimes->{3.9218423804411073`*^9, 3.922209348251233*^9, 
  3.922213768340784*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"6f2d9004-5204-4679-995c-3b27da4488cd"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1y", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1y", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.922208693734317*^9, 
  3.922208722615221*^9}},ExpressionUUID->"85dd0aec-a4cd-4fc0-8650-\
e49754e0e512"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "ana", " ", "and", " ", "num", " ", "are", " ", "consistent", " ", "with", 
   " ", "each", " ", 
   RowBox[{"other", "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.913738155765427*^9, 
  3.913738177312245*^9}},ExpressionUUID->"7a855fc2-c3ad-423f-9dd4-\
0a421f7519e0"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{720, 532.5},
WindowMargins->{{120, Automatic}, {Automatic, 81.75}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3df13c3c-03a9-455f-ac08-6a5116348bd4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 180, 3, 98, "Title",ExpressionUUID->"d2015dce-3ef2-45c8-bb1e-1928e3fd48f9"],
Cell[CellGroupData[{
Cell[785, 29, 165, 3, 67, "Section",ExpressionUUID->"55216139-4dd1-47d1-b3e7-3efeeb28d2c0"],
Cell[953, 34, 169, 2, 29, "Input",ExpressionUUID->"60971f4b-0750-4d2f-9e72-24ba65137fb2"],
Cell[1125, 38, 3660, 91, 370, "Input",ExpressionUUID->"4df5e789-61f6-4abc-b9ca-476070b47347"],
Cell[CellGroupData[{
Cell[4810, 133, 502, 12, 71, "Input",ExpressionUUID->"147655eb-c482-4ae1-ae06-6ba830ab83f3"],
Cell[5315, 147, 925, 14, 70, "Output",ExpressionUUID->"21474344-9bdf-4a4b-b3d7-5155c8dadc9e"],
Cell[6243, 163, 925, 14, 70, "Output",ExpressionUUID->"9f9eb0c2-43cd-405f-a70f-be379da1aadc"],
Cell[7171, 179, 925, 14, 70, "Output",ExpressionUUID->"b12db5bc-a571-4427-9221-8ad94fa7dab7"]
}, Open  ]],
Cell[8111, 196, 1182, 24, 71, "Input",ExpressionUUID->"ccdb8f92-9908-4ff7-9083-9a9fbcd2eb40"],
Cell[9296, 222, 391, 8, 32, "Input",ExpressionUUID->"6150d537-8093-4cd6-926e-7fe11d02f637"],
Cell[9690, 232, 1599, 47, 68, "Input",ExpressionUUID->"456d064b-1631-4123-a34f-e6400be5eb9b"],
Cell[11292, 281, 3713, 102, 113, "Input",ExpressionUUID->"37f99c5c-e836-4c04-9f11-a149fb588508"],
Cell[15008, 385, 3772, 103, 133, "Input",ExpressionUUID->"8605aa80-7be8-40cc-80c4-8a86208058b3"],
Cell[18783, 490, 397, 9, 32, "Input",ExpressionUUID->"b0924c0d-21d1-4e8f-a9ba-c8afeeeb4c0d"],
Cell[19183, 501, 28046, 822, 883, "Input",ExpressionUUID->"4ef6c424-5997-4ae8-b30e-d4e18764eac3"],
Cell[47232, 1325, 1169, 34, 51, "Input",ExpressionUUID->"109bf558-5bb1-4fa9-a4b4-7640877ba7ae"],
Cell[48404, 1361, 2209, 65, 92, "Input",ExpressionUUID->"0fc6ac9f-a60a-4f30-a371-8ce79c0aa046"],
Cell[50616, 1428, 562, 16, 52, "Input",ExpressionUUID->"9a963995-e6ef-4ba0-98b6-636718eb9554"],
Cell[CellGroupData[{
Cell[51203, 1448, 1214, 29, 29, "Input",ExpressionUUID->"212e4b68-f3cb-47a4-8e87-efd21d9ebb2b"],
Cell[52420, 1479, 813, 14, 70, "Output",ExpressionUUID->"443ab112-c708-4c7e-bfd5-6a300338404b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53270, 1498, 816, 23, 29, "Input",ExpressionUUID->"bd55ef78-c87e-4327-b7b6-8474ef4333e3"],
Cell[54089, 1523, 802, 14, 70, "Output",ExpressionUUID->"d48e6906-d082-4574-a2a1-41f6976c3bbe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54928, 1542, 856, 24, 29, "Input",ExpressionUUID->"6139bc93-1e3a-4f9f-9ba5-00cad59b3fb8"],
Cell[55787, 1568, 727, 13, 70, "Output",ExpressionUUID->"b0e6e669-b840-4ba4-96ce-636b63a0e618"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56551, 1586, 857, 24, 29, "Input",ExpressionUUID->"ce7ae7ae-61b9-4dd6-8c8a-63fa9f41af9d"],
Cell[57411, 1612, 730, 13, 70, "Output",ExpressionUUID->"a84b92a5-9c33-42cd-8f2f-b5f7d467ba70"]
}, Open  ]],
Cell[58156, 1628, 795, 18, 93, "Input",ExpressionUUID->"de8f91a1-9c1c-4593-9152-b2d8fa7cd8b1"],
Cell[CellGroupData[{
Cell[58976, 1650, 1907, 58, 177, "Input",ExpressionUUID->"bd7a54ea-0e51-4575-ba11-b646dc12b58f"],
Cell[60886, 1710, 733, 13, 70, "Output",ExpressionUUID->"8b532742-57e6-477c-8b84-1c27ed231bdf"],
Cell[61622, 1725, 715, 12, 70, "Output",ExpressionUUID->"237c38a0-fa49-437c-b662-194694089218"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62374, 1742, 366, 6, 51, "Input",ExpressionUUID->"d2883164-1c11-4471-8369-7496a7bd8038"],
Cell[62743, 1750, 738, 13, 70, "Output",ExpressionUUID->"367c36fd-66ab-4047-9519-ee9aa83cf472"],
Cell[63484, 1765, 719, 12, 70, "Output",ExpressionUUID->"dcba15df-2a56-46eb-94b3-6d5b7b7e6df6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64240, 1782, 1907, 58, 177, "Input",ExpressionUUID->"a3f6bcf1-b5f4-4769-8d4d-564b8e6f6ca0"],
Cell[66150, 1842, 753, 13, 70, "Output",ExpressionUUID->"4b908e89-653e-4a39-8717-d1d2cfb6bc8c"],
Cell[66906, 1857, 749, 13, 70, "Output",ExpressionUUID->"45033e5c-4d96-4c48-8b1c-e2380dadfad7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67692, 1875, 471, 8, 51, "Input",ExpressionUUID->"47e70d17-214f-474f-8597-50ff11d3b8fb"],
Cell[68166, 1885, 804, 14, 70, "Output",ExpressionUUID->"d12cb718-0fcd-4f88-85d9-5cbbb631ef43"],
Cell[68973, 1901, 1034, 19, 70, "Output",ExpressionUUID->"8e41fd1a-82d0-438b-a8f7-1f2762422af6"]
}, Open  ]],
Cell[70022, 1923, 2992, 81, 155, "Input",ExpressionUUID->"97592e27-686d-40d1-af7f-e41f521bb520"],
Cell[CellGroupData[{
Cell[73039, 2008, 168, 3, 54, "Subsection",ExpressionUUID->"64e6dd28-0afc-40a6-9ba8-413f8cb3ad69"],
Cell[73210, 2013, 5446, 148, 460, "Input",ExpressionUUID->"3ff30ab7-2c15-4798-8fd6-e2fed1e9b966"],
Cell[78659, 2163, 81798, 2129, 5796, "Input",ExpressionUUID->"b317a457-21a4-44d5-b47a-f4da402f9fd1"]
}, Closed]],
Cell[CellGroupData[{
Cell[160494, 4297, 166, 3, 38, "Subsection",ExpressionUUID->"50212625-7264-4f7b-a10f-17542044be56"],
Cell[CellGroupData[{
Cell[160685, 4304, 752, 12, 29, "Input",ExpressionUUID->"c6a20729-3051-4a4b-99b9-5348d1f3c5c0"],
Cell[161440, 4318, 2681, 75, 70, "Output",ExpressionUUID->"d1c6eb18-08ca-4069-abbd-06b01562a723"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164158, 4398, 332, 6, 29, "Input",ExpressionUUID->"612a99df-5611-4aca-87c3-a30c66570bf6"],
Cell[164493, 4406, 2595, 72, 70, "Output",ExpressionUUID->"e19921bb-9cb6-42f6-8a65-6c293e251876"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167125, 4483, 367, 6, 29, "Input",ExpressionUUID->"48114874-44c8-4143-9ac2-463acf254ea1"],
Cell[167495, 4491, 1841, 51, 70, "Output",ExpressionUUID->"b68c0ac4-2705-4fe5-a699-fcdc36130814"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169373, 4547, 371, 6, 29, "Input",ExpressionUUID->"b6f7702f-bd81-435e-82f0-518350d6df1f"],
Cell[169747, 4555, 1837, 51, 70, "Output",ExpressionUUID->"9c81bec5-6fa9-461b-8003-470f80f2fd81"]
}, Open  ]],
Cell[171599, 4609, 12966, 344, 649, "Input",ExpressionUUID->"8fb65a32-ade6-47fc-90e0-ec83862c1d3d"],
Cell[184568, 4955, 13020, 290, 535, "Input",ExpressionUUID->"084a8052-a8ea-415c-ba1f-e49291980e5e"],
Cell[197591, 5247, 5740, 136, 304, "Input",ExpressionUUID->"1075be55-173e-4441-a5ff-043fd0bf882f"],
Cell[203334, 5385, 605, 12, 52, "Input",ExpressionUUID->"f198c114-d3d9-456f-92dd-4f1160169939"],
Cell[203942, 5399, 5561, 137, 409, "Input",ExpressionUUID->"7a8148f7-b39b-403d-a384-94edf263cde6"],
Cell[209506, 5538, 14573, 360, 753, "Input",ExpressionUUID->"b8302214-8022-48c4-9cbc-ff24758ebba7"],
Cell[224082, 5900, 12553, 327, 703, "Input",ExpressionUUID->"e0864ef4-a0c2-4055-9af3-189c094808d0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[236684, 6233, 164, 3, 53, "Section",ExpressionUUID->"d94f9a14-62f1-49f6-8b5a-e9ec9ecfdf7e"],
Cell[236851, 6238, 445, 9, 37, "Input",ExpressionUUID->"7eba5210-dcce-495b-bdf7-67c18d8ab094"],
Cell[237299, 6249, 32407, 845, 1818, "Input",ExpressionUUID->"967a39b9-849d-4c27-bc3a-d4d20cb8f69b"]
}, Closed]],
Cell[CellGroupData[{
Cell[269743, 7099, 237, 4, 53, "Section",ExpressionUUID->"7c3b2c47-fe19-4dde-81f5-bec6171cb843"],
Cell[CellGroupData[{
Cell[270005, 7107, 1376, 26, 170, "Input",ExpressionUUID->"c09bc8d5-b04c-4b76-9ae8-e7bd10cd5372"],
Cell[271384, 7135, 40642, 824, 410, "Output",ExpressionUUID->"a700ddfc-e858-455e-af1f-2a6f91ef0e7a"]
}, Open  ]],
Cell[312041, 7962, 618, 13, 50, "Input",ExpressionUUID->"c0f767ae-b527-439c-9cb1-0f02d24f6633"],
Cell[312662, 7977, 313, 6, 29, "Input",ExpressionUUID->"41b3d4fb-9436-46a8-ad75-2bbbead72d04"],
Cell[312978, 7985, 1179, 29, 29, "Input",ExpressionUUID->"731b91b0-0a28-42a9-9a13-4600e5c0ba50"],
Cell[CellGroupData[{
Cell[314182, 8018, 429, 8, 29, "Input",ExpressionUUID->"49249748-c9d3-4404-b6cc-76be0ffd698a"],
Cell[314614, 8028, 345, 5, 33, "Output",ExpressionUUID->"d5674574-cf04-4735-ab2f-e249761c7568"]
}, Open  ]],
Cell[314974, 8036, 683, 15, 29, "Input",ExpressionUUID->"2cd80de2-1ace-4624-a3cd-2210bfee1b76"],
Cell[CellGroupData[{
Cell[315682, 8055, 421, 10, 51, "Input",ExpressionUUID->"9e18f200-fca9-43b8-9452-318cad625ca1"],
Cell[316106, 8067, 167, 2, 33, "Output",ExpressionUUID->"ccc06c4c-fb7d-4251-9a2f-c2e4a7a446f9"],
Cell[316276, 8071, 167, 2, 33, "Output",ExpressionUUID->"5e43a2ea-3149-4f8c-a8a9-655356bc2fa5"]
}, Open  ]],
Cell[316458, 8076, 225, 4, 29, "Input",ExpressionUUID->"71f9168c-b3b7-44c7-9337-5f3e93dbdc60"],
Cell[CellGroupData[{
Cell[316708, 8084, 864, 22, 71, "Input",ExpressionUUID->"1701dee6-1fb9-48f2-a394-0e9bf0f040cd"],
Cell[317575, 8108, 214, 3, 33, "Output",ExpressionUUID->"339bd794-0eb7-4b7c-ac22-a79638d112e2"],
Cell[317792, 8113, 214, 3, 33, "Output",ExpressionUUID->"f1f45230-99ce-448c-8d59-6845a734f9f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318043, 8121, 942, 21, 71, "Input",ExpressionUUID->"79d44025-8d51-46a7-b107-fb4458241a5c"],
Cell[318988, 8144, 244, 4, 33, "Output",ExpressionUUID->"90ea7e67-58fa-455f-a6d7-ea4ccc8bfbe1"],
Cell[319235, 8150, 241, 4, 33, "Output",ExpressionUUID->"ee7589d4-ee16-4dd9-bd20-0d326e4e797c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319513, 8159, 747, 18, 71, "Input",ExpressionUUID->"936b0194-5185-4cca-aaf4-7f7783d8b96b"],
Cell[320263, 8179, 216, 3, 33, "Output",ExpressionUUID->"efc2e267-6530-4850-862b-7dbd4baaaa26"],
Cell[320482, 8184, 216, 3, 33, "Output",ExpressionUUID->"6f2d9004-5204-4679-995c-3b27da4488cd"]
}, Open  ]],
Cell[320713, 8190, 679, 19, 92, "Input",ExpressionUUID->"85dd0aec-a4cd-4fc0-8650-e49754e0e512"],
Cell[321395, 8211, 313, 8, 32, "Input",ExpressionUUID->"7a855fc2-c3ad-423f-9dd4-0a421f7519e0"]
}, Open  ]]
}, Open  ]]
}
]
*)

