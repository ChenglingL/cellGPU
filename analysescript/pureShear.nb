(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    325778,       8143]
NotebookOptionsPosition[    316084,       7993]
NotebookOutlinePosition[    316483,       8009]
CellTagsIndexPosition[    316440,       8006]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Calculation of trace of stress tensor", "Title",
 CellChangeTimes->{{3.921773128870708*^9, 
  3.921773141134547*^9}},ExpressionUUID->"d2015dce-3ef2-45c8-bb1e-\
1928e3fd48f9"],

Cell[CellGroupData[{

Cell["Analytical functions", "Section",
 CellChangeTimes->{{3.906130030072163*^9, 
  3.906130041829665*^9}},ExpressionUUID->"55216139-4dd1-47d1-b3e7-\
3efeeb28d2c0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906130176580935*^9, 3.90613017877917*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"60971f4b-0750-4d2f-9e72-24ba65137fb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Cross", " ", "product", " ", "for", " ", "2", "d", " ", "vectors"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Cross2d", "[", 
     RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"r1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"r2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"r1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"r2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "vertex", " ", "position", " ", "given", " ", "the", " ", 
     "three", " ", "adjecent", " ", "cell", " ", "positions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"voro", "[", 
      RowBox[{"ri_", ",", "rj_", ",", "rk_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rij", ",", "rjk", ",", "rik", ",", "cross", ",", "d", ",", 
         "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rij", "=", 
         RowBox[{"ri", "-", "rj"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rjk", "=", 
         RowBox[{"rj", "-", "rk"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rik", "=", 
         RowBox[{"ri", "-", "rk"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"cross", "=", 
         RowBox[{"Cross2d", "[", 
          RowBox[{"rij", ",", "rjk"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"2", "*", "cross", "*", "cross"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rjk", ".", "rjk"}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rij", ".", "rik"}], ")"}], "/", "d"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Beta]", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"rik", ".", "rik"}], ")"}]}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rij", ".", "rjk"}], ")"}], "/", "d"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rij", ".", "rij"}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rik", ".", "rjk"}], ")"}], "/", "d"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Alpha]", "*", "ri"}], "+", 
         RowBox[{"\[Beta]", "*", "rj"}], "+", 
         RowBox[{"\[Gamma]", "*", "rk"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7021149776264772`*^9, 3.702115029400317*^9}, {
  3.702115105977425*^9, 3.702115106740584*^9}, {3.702115641476828*^9, 
  3.7021156740891857`*^9}, {3.702115937679511*^9, 3.702115970430769*^9}, {
  3.7021160716576014`*^9, 3.702116093688979*^9}, {3.702116333940885*^9, 
  3.702116367283513*^9}, {3.702116697174008*^9, 3.702116716983386*^9}, {
  3.702117069252245*^9, 3.702117092274171*^9}, {3.702117181705346*^9, 
  3.7021171837511787`*^9}, {3.702117722524921*^9, 3.702117731376658*^9}, {
  3.702117777086854*^9, 3.7021177930464067`*^9}, {3.702117832077812*^9, 
  3.702117850958396*^9}, {3.702118822968773*^9, 3.702118832692359*^9}, {
  3.906130184098963*^9, 3.906130249675869*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"4df5e789-61f6-4abc-b9ca-476070b47347"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ri", "=", 
  RowBox[{"{", 
   RowBox[{"rix", ",", "riy"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"rj", "=", 
  RowBox[{"{", 
   RowBox[{"rjx", ",", "rjy"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"rk", "=", 
  RowBox[{"{", 
   RowBox[{"rkx", ",", "rky"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.702221524635298*^9, 3.7022215284528103`*^9}, {
  3.903517203533676*^9, 3.903517238737976*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"147655eb-c482-4ae1-ae06-6ba830ab83f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"rix", ",", "riy"}], "}"}]], "Output",
 CellChangeTimes->{{3.903517212023604*^9, 3.903517243153616*^9}, 
   3.903562439107212*^9, 3.903786935486725*^9, 3.903795516375733*^9, 
   3.904149388608132*^9, 3.904340178984725*^9, 3.904384814793366*^9, 
   3.904474771740842*^9, 3.9046891135948153`*^9, 3.904744355061328*^9, 
   3.92177355884501*^9, 3.9217737704296083`*^9, {3.921778599314196*^9, 
   3.921778619974407*^9}, 3.921778706009364*^9, 3.921825790568774*^9, 
   3.9218415557594557`*^9, 3.922208454035009*^9, 3.922208779027813*^9, 
   3.922208819182055*^9, 3.922208854785626*^9, 3.9222088962886553`*^9, {
   3.922208937231409*^9, 3.92220897499047*^9}, 3.922209247218298*^9, 
   3.922209342787221*^9, 3.922209394714941*^9, 3.9222094390672092`*^9, 
   3.922213560915195*^9, 3.922213629685645*^9, 3.922213730085787*^9, 
   3.922268638280715*^9, 3.92227683125254*^9, 3.92227732858953*^9, 
   3.92252878410704*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"b934c4c1-9a5d-4fd7-93aa-5e553e96e6d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"rjx", ",", "rjy"}], "}"}]], "Output",
 CellChangeTimes->{{3.903517212023604*^9, 3.903517243153616*^9}, 
   3.903562439107212*^9, 3.903786935486725*^9, 3.903795516375733*^9, 
   3.904149388608132*^9, 3.904340178984725*^9, 3.904384814793366*^9, 
   3.904474771740842*^9, 3.9046891135948153`*^9, 3.904744355061328*^9, 
   3.92177355884501*^9, 3.9217737704296083`*^9, {3.921778599314196*^9, 
   3.921778619974407*^9}, 3.921778706009364*^9, 3.921825790568774*^9, 
   3.9218415557594557`*^9, 3.922208454035009*^9, 3.922208779027813*^9, 
   3.922208819182055*^9, 3.922208854785626*^9, 3.9222088962886553`*^9, {
   3.922208937231409*^9, 3.92220897499047*^9}, 3.922209247218298*^9, 
   3.922209342787221*^9, 3.922209394714941*^9, 3.9222094390672092`*^9, 
   3.922213560915195*^9, 3.922213629685645*^9, 3.922213730085787*^9, 
   3.922268638280715*^9, 3.92227683125254*^9, 3.92227732858953*^9, 
   3.922528784116734*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"423c4acf-b5d6-4a63-bcdc-be0668cf1f1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"rkx", ",", "rky"}], "}"}]], "Output",
 CellChangeTimes->{{3.903517212023604*^9, 3.903517243153616*^9}, 
   3.903562439107212*^9, 3.903786935486725*^9, 3.903795516375733*^9, 
   3.904149388608132*^9, 3.904340178984725*^9, 3.904384814793366*^9, 
   3.904474771740842*^9, 3.9046891135948153`*^9, 3.904744355061328*^9, 
   3.92177355884501*^9, 3.9217737704296083`*^9, {3.921778599314196*^9, 
   3.921778619974407*^9}, 3.921778706009364*^9, 3.921825790568774*^9, 
   3.9218415557594557`*^9, 3.922208454035009*^9, 3.922208779027813*^9, 
   3.922208819182055*^9, 3.922208854785626*^9, 3.9222088962886553`*^9, {
   3.922208937231409*^9, 3.92220897499047*^9}, 3.922209247218298*^9, 
   3.922209342787221*^9, 3.922209394714941*^9, 3.9222094390672092`*^9, 
   3.922213560915195*^9, 3.922213629685645*^9, 3.922213730085787*^9, 
   3.922268638280715*^9, 3.92227683125254*^9, 3.92227732858953*^9, 
   3.9225287841204643`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"3be5e196-c73f-4aa2-a285-7c5856dbf215"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hijk", "=", 
   RowBox[{"voro", "[", 
    RowBox[{"ri", ",", "rj", ",", "rk"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"den", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"rjx", "*", "rky"}], "-", 
      RowBox[{"rjy", "*", "rkx"}]}], ")"}], "^", "3"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7021149776264772`*^9, 3.702115029400317*^9}, {
   3.702115105977425*^9, 3.702115106740584*^9}, {3.702115641476828*^9, 
   3.7021156740891857`*^9}, {3.702115937679511*^9, 3.702115970430769*^9}, {
   3.7021160716576014`*^9, 3.702116093688979*^9}, {3.702116333940885*^9, 
   3.702116367283513*^9}, {3.702116697174008*^9, 3.702116716983386*^9}, {
   3.702117069252245*^9, 3.702117092274171*^9}, {3.702117181705346*^9, 
   3.7021171837511787`*^9}, {3.702117722524921*^9, 3.702117731376658*^9}, {
   3.702117777086854*^9, 3.7021177930464067`*^9}, {3.702117832077812*^9, 
   3.702117850958396*^9}, {3.702118822968773*^9, 3.702118832692359*^9}, 
   3.903517309272399*^9, {3.903537123584051*^9, 3.903537127506509*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ccdb8f92-9908-4ff7-9083-9a9fbcd2eb40"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Analytical", " ", "dirivatives", " ", "of", " ", "dhdr", " ", "and", " ", 
   "dhdr"}], "*)"}]], "Input",
 CellChangeTimes->{{3.903631550530129*^9, 3.903631571968574*^9}, {
  3.903631613453341*^9, 3.903631616768702*^9}, {3.9036318927940474`*^9, 
  3.903631896205661*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"6150d537-8093-4cd6-926e-7fe11d02f637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v1dri", "[", 
   RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}]},
       {
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hijk", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}]}
      }], ")"}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rix", "\[Rule]", 
      RowBox[{"r1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"riy", "\[Rule]", 
      RowBox[{"r1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"rjx", "\[Rule]", 
      RowBox[{"r2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"rjy", "\[Rule]", 
      RowBox[{"r2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"rkx", "\[Rule]", 
      RowBox[{"r3", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"rky", "\[Rule]", 
      RowBox[{"r3", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.903565821240597*^9, 3.903565821746937*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"456d064b-1631-4123-a34f-e6400be5eb9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v2drirj", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjx"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjx"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjx"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjx"}], "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjy"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
            "rjy"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjy"}], "]"}], ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hijk", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
            "rjy"}], "]"}]}], "}"}]}], "}"}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rix", "\[Rule]", 
       RowBox[{"r1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"riy", "\[Rule]", 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"rjx", "\[Rule]", 
       RowBox[{"r2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"rjy", "\[Rule]", 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"rkx", "\[Rule]", 
       RowBox[{"r3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"rky", "\[Rule]", 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.702308783477057*^9, 3.702308917615642*^9}, {
   3.702309238826765*^9, 3.702309311722497*^9}, {3.70230939231063*^9, 
   3.702309394825799*^9}, {3.9035372124633427`*^9, 3.903537227484953*^9}, {
   3.903538433255641*^9, 3.90353843798347*^9}, 3.903538493235571*^9, {
   3.903562683764697*^9, 3.9035626920055447`*^9}, {3.903571719792268*^9, 
   3.903571725927569*^9}, {3.903605660009725*^9, 3.903605663152857*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"37f99c5c-e836-4c04-9f11-a149fb588508"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v2driri", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "rix"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "rix"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "rix"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "rix"}], "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "riy"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "rix"}], "]"}], ",", 
             "riy"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "riy"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hijk", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "riy"}], "]"}], ",", 
             "riy"}], "]"}]}], "}"}]}], "}"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rix", "\[Rule]", 
        RowBox[{"r1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"riy", "\[Rule]", 
        RowBox[{"r1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"rjx", "\[Rule]", 
        RowBox[{"r2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"rjy", "\[Rule]", 
        RowBox[{"r2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"rkx", "\[Rule]", 
        RowBox[{"r3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"rky", "\[Rule]", 
        RowBox[{"r3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.903537241362403*^9, 3.903537251355837*^9}, {
  3.9035384894593678`*^9, 3.903538537749229*^9}, {3.903539541062944*^9, 
  3.903539541152039*^9}, {3.9035626547940187`*^9, 3.903562662564859*^9}, {
  3.903567167463319*^9, 3.903567197379348*^9}, {3.903571745169484*^9, 
  3.903571756417726*^9}, {3.903605666680064*^9, 3.903605668003092*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"8605aa80-7be8-40cc-80c4-8a86208058b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "+", "\[Epsilon]"}]], ",", "\[Epsilon]"}], "]"}], ",", 
    "\[Epsilon]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1", "+", "\[Epsilon]"}]], ",", "\[Epsilon]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Epsilon]", "->", "0"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.9222677792570744`*^9, 3.92226780929494*^9}, {
  3.922268200393146*^9, 3.922268217009469*^9}, {3.922268480001243*^9, 
  3.92226849927041*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"2015afab-a615-480a-8228-f77fb434e7d1"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.922267800569961*^9, 3.922267809898563*^9}, 
   3.922268218536108*^9, 3.9222685003860273`*^9, 3.92227683130407*^9, 
   3.922277328695794*^9, 3.9225287841571198`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"e04cee27-725f-47c1-9f41-52d7d5963c28"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.922267800569961*^9, 3.922267809898563*^9}, 
   3.922268218536108*^9, 3.9222685003860273`*^9, 3.92227683130407*^9, 
   3.922277328695794*^9, 3.922528784162242*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"34550987-49ab-471a-b280-2686435a554e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"111", ",", "112"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"211", ",", "212"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"121", ",", "122"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"221", ",", "222"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"test", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "y1"}], "}"}]}], ")"}], ".", 
  RowBox[{"{", 
   RowBox[{"x2", ",", "y2"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.922275239831608*^9, 3.922275274805121*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"8784ad44-2308-4ce1-82be-f4d479a73dee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"111", " ", "x1"}], "+", 
     RowBox[{"211", " ", "y1"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"121", " ", "x1"}], "+", 
     RowBox[{"221", " ", "y1"}]}], ")"}], " ", "y2"}]}]], "Output",
 CellChangeTimes->{3.922275275638013*^9, 3.922276831320857*^9, 
  3.9222773287116013`*^9, 3.9225287841730213`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"78c4b579-7f06-4d7d-b763-16608e8129eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"111", ",", "112"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"121", ",", "122"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"211", ",", "212"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"221", ",", "222"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"test", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"x2", ",", "y2"}], "}"}]}], ")"}], ".", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "y1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.922274447575021*^9, 3.922274535406396*^9}, {
  3.922274575995963*^9, 3.922274646745388*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"372822ec-0715-44ad-8aa1-d891569e5d02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"111", " ", "x2"}], "+", 
     RowBox[{"121", " ", "y2"}]}], ")"}]}], "+", 
  RowBox[{"y1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"211", " ", "x2"}], "+", 
     RowBox[{"221", " ", "y2"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.922274536007691*^9, 3.922274593611658*^9, {3.922274634485464*^9, 
   3.922274647159958*^9}, 3.922276831332651*^9, 3.922277328726274*^9, 
   3.9225287841840343`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"558c8085-1e2d-4772-856f-665fd09d13e3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
   "Analytical", " ", "dirivatives", " ", "of", " ", "dhdg", " ", "and", " ", 
    "d2hdgdg"}], "*)"}]}]], "Input",
 CellChangeTimes->{
  3.9036056792891607`*^9, {3.903631581116619*^9, 3.9036316110544043`*^9}, {
   3.9036319023678207`*^9, 3.903631905174819*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"b0924c0d-21d1-4e8f-a9ba-c8afeeeb4c0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dridg", "=", 
   RowBox[{"{", 
    RowBox[{"riy", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drjdg", "=", 
   RowBox[{"{", 
    RowBox[{"rjy", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drkdg", "=", 
    RowBox[{"{", 
     RowBox[{"rky", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"dh2dgdg", "[", 
      RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2driri", "[", 
          RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2driri", "[", 
          RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2drirj", "[", 
          RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2driri", "[", 
          RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dh2dgdg", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2drirj", "[", 
           RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v2driri", "[", 
           RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
       RowBox[{"r3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dh2d\[Epsilon]d\[Epsilon]", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2driri", "[", 
            RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2driri", "[", 
            RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2driri", "[", 
            RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2driri", "[", 
            RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r1", ",", "r3", ",", "r2"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2driri", "[", 
            RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r2", ",", "r3", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2driri", "[", 
            RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r3", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r3", ",", "r2", ",", "r1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v2drirj", "[", 
            RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "2"}], "]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"r3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"r1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}]}], "}"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"2", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"2", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"2", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.903542849860942*^9, 3.903542885382741*^9}, {
   3.903543096145893*^9, 3.903543105486513*^9}, {3.9035447780323467`*^9, 
   3.903544840712337*^9}, {3.903544880359651*^9, 3.9035451278955803`*^9}, 
   3.9035635842417707`*^9, {3.903563623546873*^9, 3.903563656747323*^9}, {
   3.903567209077092*^9, 3.903567225961917*^9}, {3.903567377967236*^9, 
   3.9035673867502623`*^9}, {3.9035674484390383`*^9, 3.903567529635664*^9}, {
   3.903572195288945*^9, 3.903572426945136*^9}, {3.9035724736961946`*^9, 
   3.903572532295334*^9}, {3.903605706901718*^9, 3.903605731000478*^9}, {
   3.903605763702444*^9, 3.903605774198662*^9}, {3.921776065133325*^9, 
   3.9217761305904617`*^9}, {3.921776160743354*^9, 3.921776227920836*^9}, {
   3.922268428903021*^9, 3.922268432793707*^9}, {3.922268627964798*^9, 
   3.922268634070716*^9}, {3.922274374257873*^9, 3.922274390658599*^9}, 
   3.922274443142598*^9, {3.922275315526935*^9, 3.922275361283792*^9}, {
   3.922275397780387*^9, 3.922275440566331*^9}, {3.9222754948069153`*^9, 
   3.922275775330287*^9}, {3.922275832030271*^9, 3.9222758621136312`*^9}, {
   3.922275918289308*^9, 3.922275927984186*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"4ef6c424-5997-4ae8-b30e-d4e18764eac3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dhdg", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r3", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.903564640362316*^9, 3.9035646915297194`*^9}, {
  3.903565837174224*^9, 3.903565900654749*^9}, {3.9035659494695063`*^9, 
  3.903565951727913*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"109bf558-5bb1-4fa9-a4b4-7640877ba7ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dhd\[Epsilon]", "[", 
    RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r2", ",", "r1", ",", "r3"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v1dri", "[", 
       RowBox[{"r3", ",", "r1", ",", "r2"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r3", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.903564640362316*^9, 3.9035646915297194`*^9}, {
   3.903565837174224*^9, 3.903565900654749*^9}, {3.9035659494695063`*^9, 
   3.903565951727913*^9}, {3.921775556056182*^9, 3.921775632553735*^9}, {
   3.921777009867077*^9, 3.921777011130507*^9}, {3.92226854027289*^9, 
   3.922268556872069*^9}, 3.9222686492515087`*^9, {3.922269959657789*^9, 
   3.9222699862815866`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"0fc6ac9f-a60a-4f30-a371-8ce79c0aa046"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", 
    RowBox[{"C", "++"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"r1", "=", 
    RowBox[{"{", 
     RowBox[{"r1x", ",", "r1y"}], "}"}]}], ";", 
   RowBox[{"r2", "=", 
    RowBox[{"{", 
     RowBox[{"r2x", ",", "r2y"}], "}"}]}], ";", 
   RowBox[{"r3", "=", 
    RowBox[{"{", 
     RowBox[{"r3x", ",", "r3y"}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.9217763146502666`*^9, 3.921776327743198*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"9a963995-e6ef-4ba0-98b6-636718eb9554"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"dhd\[Epsilon]", "[", 
      RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1x", "->", "0"}], ",", 
       RowBox[{"r1y", "->", "0"}]}], "}"}]}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_", "^", "2"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x_", "^", "3"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x", "*", "x"}], "]"}]}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.903795352687204*^9, 3.903795440132812*^9}, {
   3.903795838604693*^9, 3.90379584018342*^9}, {3.903795900108468*^9, 
   3.90379590100532*^9}, {3.903795994917081*^9, 3.9037960064053926`*^9}, {
   3.903796054634122*^9, 3.903796071339532*^9}, 3.9037983789762383`*^9, {
   3.903800169376627*^9, 3.9038001707602262`*^9}, {3.9038022300365143`*^9, 
   3.9038022306007233`*^9}, {3.921776349490902*^9, 3.921776377482992*^9}, 
   3.9217776272770777`*^9, 3.922276525981043*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"212e4b68-f3cb-47a4-8e87-efd21d9ebb2b"],

Cell["\<\
List((-(r3y*(r2x*r2x)) + 3*r3y*(r2y*r2y) + r2y*(r3x*r3x) - \
3*r2y*(r3y*r3y))/(2*r2y*r3x - 2*r2x*r3y),
   (3*r3x*(r2x*r2x) - r3x*(r2y*r2y) - 3*r2x*(r3x*r3x) + \
r2x*(r3y*r3y))/(2*r2y*r3x - 2*r2x*r3y))\
\>", "Output",
 CellChangeTimes->{{3.921776364226894*^9, 3.9217763779538193`*^9}, 
   3.921777633496007*^9, {3.921778599407528*^9, 3.9217786200588818`*^9}, 
   3.921778706477976*^9, 3.921825790663548*^9, 3.921841555818123*^9, 
   3.922208454292253*^9, 3.9222087792857018`*^9, 3.9222088192853823`*^9, 
   3.9222088548799047`*^9, 3.922208896529491*^9, {3.922208937426433*^9, 
   3.9222089752254972`*^9}, 3.9222092473191643`*^9, 3.9222093428775587`*^9, 
   3.922209394842787*^9, 3.922209439171414*^9, 3.9222135610116577`*^9, 
   3.922213629782371*^9, 3.9222137304401817`*^9, {3.922276531143045*^9, 
   3.9222765370232573`*^9}, 3.922276831515732*^9, 3.922277328810609*^9, 
   3.922528784245473*^9},
 CellLabel->
  "Out[28]//CForm=",ExpressionUUID->"9f2d4a48-d8ba-4a77-8161-277bd43eb050"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"dh2d\[Epsilon]d\[Epsilon]", "[", 
      RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1x", "->", "0"}], ",", 
       RowBox[{"r1y", "->", "0"}]}], "}"}]}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_", "^", "2"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"x_", "^", "3"}], "\[RuleDelayed]", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"x", "*", "x", "*", "x"}], "]"}]}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.921776402371735*^9, 3.921776410075952*^9}, 
   3.9217776304520197`*^9, {3.9222765440534286`*^9, 3.922276544638357*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"6139bc93-1e3a-4f9f-9ba5-00cad59b3fb8"],

Cell["\<\
List((6*r2y*(r2y - r3y)*r3y)/(-(r2y*r3x) + r2x*r3y),
   (3*r3x*(r2x*r2x) + r3x*(r2y*r2y) - 3*r2x*(r3x*r3x) - \
r2x*(r3y*r3y))/(r2y*r3x - r2x*r3y))\
\>", "Output",
 CellChangeTimes->{
  3.9217764118939342`*^9, 3.9217776372615423`*^9, {3.921778599488887*^9, 
   3.921778620139003*^9}, 3.92177870657067*^9, 3.921825790738122*^9, 
   3.921841555880978*^9, 3.9222084544234047`*^9, 3.9222087794395514`*^9, 
   3.9222088194785423`*^9, 3.922208854988809*^9, 3.922208896749199*^9, {
   3.922208937575165*^9, 3.922208975443482*^9}, 3.922209247413747*^9, 
   3.922209342990438*^9, 3.92220939493279*^9, 3.922209439273017*^9, 
   3.92221356114038*^9, 3.9222136300399313`*^9, 3.9222137306322823`*^9, 
   3.92227654861552*^9, 3.922276831646248*^9, 3.92227732902195*^9, 
   3.9225287843521137`*^9},
 CellLabel->
  "Out[29]//CForm=",ExpressionUUID->"b9f2361b-8e80-49e8-99d8-f403aa179e28"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Numerical", " ", "test"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"p1", "=", 
    RowBox[{"{", 
     RowBox[{"15.764422379230995`", ",", "17.23195769060852`"}], "}"}]}], ";", 
   RowBox[{"p2", "=", 
    RowBox[{"{", 
     RowBox[{"16.240740458209697`", ",", "16.83431037696828`"}], "}"}]}], ";", 
   RowBox[{"p3", "=", 
    RowBox[{"{", 
     RowBox[{"15.803192711415326`", ",", "16.385277852647548`"}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.921776635081626*^9, 3.921776642995364*^9}, {
  3.921776681714613*^9, 3.9217767854289494`*^9}, {3.921776822493496*^9, 
  3.9217768421260977`*^9}, {3.921776896207911*^9, 3.92177689674303*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"de8f91a1-9c1c-4593-9152-b2d8fa7cd8b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "verifies", " ", "dhd\[Epsilon]", " ", "and", " ", 
    "d2hd\[Epsilon]d\[Epsilon]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"strainfor", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", "0.0001"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "0.0001"}], ")"}]}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"strainback", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "-", "0.0001"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "0.0001"}], ")"}]}]}], "}"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"hForward", "=", 
     RowBox[{"voro", "[", 
      RowBox[{
       RowBox[{"strainfor", ".", "p1"}], ",", 
       RowBox[{"strainfor", ".", "p2"}], ",", 
       RowBox[{"strainfor", ".", "p3"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hback", "=", 
     RowBox[{"voro", "[", 
      RowBox[{
       RowBox[{"strainback", ".", "p1"}], ",", 
       RowBox[{"strainback", ".", "p2"}], ",", 
       RowBox[{"strainback", ".", "p3"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"originalh", "=", 
     RowBox[{"voro", "[", 
      RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hback", "+", "hForward", "-", 
      RowBox[{"2", "*", "originalh"}]}], ")"}], "/", 
    RowBox[{"0.0001", "^", "2"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"hback", "-", "hForward"}], ")"}]}], "/", 
    "0.0002"}]}]}]], "Input",
 CellChangeTimes->{{3.921776904775814*^9, 3.921776918863687*^9}, {
  3.922268663627632*^9, 3.922268677475334*^9}, {3.922276472319601*^9, 
  3.922276477100293*^9}, {3.9222765084989433`*^9, 3.922276512227663*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"bd7a54ea-0e51-4575-ba11-b646dc12b58f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.338611260199741`"}], ",", "33.66188430220518`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.92177682373316*^9, 3.921776843562276*^9}, {
   3.9217785995703382`*^9, 3.921778620218583*^9}, 3.921778706652871*^9, 
   3.9218257908112926`*^9, 3.921841555948847*^9, 3.922208454497842*^9, 
   3.922208779516296*^9, 3.922208819629406*^9, 3.922208855060849*^9, 
   3.922208896828843*^9, {3.922208937656636*^9, 3.922208975518663*^9}, 
   3.9222092475251207`*^9, 3.922209343095024*^9, 3.9222093950460253`*^9, 
   3.922209439362146*^9, 3.922213561215885*^9, 3.922213630120101*^9, 
   3.922213730712599*^9, 3.922268681000431*^9, 3.922276478882379*^9, 
   3.922276513278143*^9, 3.922276831661579*^9, 3.922277329043548*^9, 
   3.922528784369296*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"7dc34406-eceb-47e8-9edb-6ad0a0eee968"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.595929765008677`", ",", 
   RowBox[{"-", "16.768445802544107`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.92177682373316*^9, 3.921776843562276*^9}, {
   3.9217785995703382`*^9, 3.921778620218583*^9}, 3.921778706652871*^9, 
   3.9218257908112926`*^9, 3.921841555948847*^9, 3.922208454497842*^9, 
   3.922208779516296*^9, 3.922208819629406*^9, 3.922208855060849*^9, 
   3.922208896828843*^9, {3.922208937656636*^9, 3.922208975518663*^9}, 
   3.9222092475251207`*^9, 3.922209343095024*^9, 3.9222093950460253`*^9, 
   3.922209439362146*^9, 3.922213561215885*^9, 3.922213630120101*^9, 
   3.922213730712599*^9, 3.922268681000431*^9, 3.922276478882379*^9, 
   3.922276513278143*^9, 3.922276831661579*^9, 3.922277329043548*^9, 
   3.922528784373951*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"083470d9-b834-42fa-b572-57cb9f459ab7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dh2d\[Epsilon]d\[Epsilon]", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"dhd\[Epsilon]", "[", 
  RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.921776850398985*^9, 3.92177688127888*^9}, {
  3.922268684211974*^9, 3.922268688507125*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"d2883164-1c11-4471-8369-7496a7bd8038"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.3386105023461212`"}], ",", "33.661884031745515`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.921776863928555*^9, 3.9217768818548727`*^9}, {
   3.921778599612177*^9, 3.921778620260253*^9}, 3.9217787066990013`*^9, 
   3.921825790851984*^9, 3.9218415559901953`*^9, 3.922208454591964*^9, 
   3.9222087795814543`*^9, 3.9222088197355957`*^9, 3.9222088551425877`*^9, 
   3.922208896927552*^9, {3.9222089377312107`*^9, 3.9222089755759687`*^9}, 
   3.922209247575026*^9, 3.92220934319998*^9, 3.9222093951159487`*^9, 
   3.922209439407213*^9, 3.922213561267967*^9, 3.922213630180785*^9, 
   3.922213730774087*^9, 3.922268689395499*^9, {3.9222699708909407`*^9, 
   3.922269989876131*^9}, 3.9222756564791603`*^9, 3.9222757277124243`*^9, 
   3.922275780918648*^9, 3.9222758650113163`*^9, 3.9222759318811398`*^9, 
   3.9222768317155943`*^9, 3.922277329120328*^9, 3.922528784409338*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"9bc6aeb3-2c4c-47fe-9f13-1ec989632361"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.595929745504797`", ",", 
   RowBox[{"-", "16.76844563467451`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921776863928555*^9, 3.9217768818548727`*^9}, {
   3.921778599612177*^9, 3.921778620260253*^9}, 3.9217787066990013`*^9, 
   3.921825790851984*^9, 3.9218415559901953`*^9, 3.922208454591964*^9, 
   3.9222087795814543`*^9, 3.9222088197355957`*^9, 3.9222088551425877`*^9, 
   3.922208896927552*^9, {3.9222089377312107`*^9, 3.9222089755759687`*^9}, 
   3.922209247575026*^9, 3.92220934319998*^9, 3.9222093951159487`*^9, 
   3.922209439407213*^9, 3.922213561267967*^9, 3.922213630180785*^9, 
   3.922213730774087*^9, 3.922268689395499*^9, {3.9222699708909407`*^9, 
   3.922269989876131*^9}, 3.9222756564791603`*^9, 3.9222757277124243`*^9, 
   3.922275780918648*^9, 3.9222758650113163`*^9, 3.9222759318811398`*^9, 
   3.9222768317155943`*^9, 3.922277329120328*^9, 3.9225287844136353`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"4216b899-58a6-445d-b966-7357df02846a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "calculate", " ", "perimetes", " ", "and", " ", "areas", " ", "given", " ",
     "the", " ", "positions", " ", "of", " ", "all", " ", "the", " ", 
    "vertices"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"peri", "[", "hv_List", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", 
           RowBox[{"hv", "[", 
            RowBox[{"[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "+", "i"}], "==", 
                RowBox[{"Length", "[", "hv", "]"}]}], ",", 
               RowBox[{"Length", "[", "hv", "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"1", "+", "i"}], ",", 
                 RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
            "]"}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", 
           RowBox[{"hv", "[", 
            RowBox[{"[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "+", "i"}], "==", 
                RowBox[{"Length", "[", "hv", "]"}]}], ",", 
               RowBox[{"Length", "[", "hv", "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"1", "+", "i"}], ",", 
                 RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
            "]"}]}], ")"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "hv", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"area", "[", "hv_List", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"0.5", "*", 
        RowBox[{"Cross2d", "[", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "+", "i"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "hv", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.906130090477276*^9, 3.906130134870748*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"97592e27-686d-40d1-af7f-e41f521bb520"],

Cell[CellGroupData[{

Cell["energy derivatives", "Subsection",
 CellChangeTimes->{{3.9217738467518263`*^9, 
  3.9217738540962563`*^9}},ExpressionUUID->"64e6dd28-0afc-40a6-9ba8-\
413f8cb3ad69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "1", "st", " ", "derivative", " ", 
    "of", " ", "e", " ", 
    RowBox[{"w", ".", "r", ".", "t", ".", " ", "h"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dedhGeneral", "[", 
    RowBox[{"hv_List", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dedhx", ",", "dedhy", ",", "hix", ",", "hiy", ",", "hiLastx", ",", 
       "hiLasty", ",", "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",",
        "hjLastx", ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", 
       ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hix", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"hiy", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", 
      RowBox[{"hiLastx", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"hiLasty", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", 
      RowBox[{"hiNextx", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"hiNexty", "=", 
       RowBox[{
        RowBox[{"hv", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dedhx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", "hiLasty"}], "+", 
           RowBox[{"1.`", " ", "hiNexty"}]}], ")"}], " ", "KA", " ", 
         RowBox[{"(", 
          RowBox[{"a", "-", "PA"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiLastx"}], "+", "hix"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiNextx"}], "+", "hix"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}], 
          ")"}], " ", "KP", " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "PP"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dedhy", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1.`"}], " ", "hiLastx"}], "+", 
           RowBox[{"1.`", " ", "hiNextx"}]}], ")"}], " ", "KA", " ", 
         RowBox[{"(", 
          RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}], 
          ")"}], " ", "KP", " ", 
         RowBox[{"(", 
          RowBox[{"p", "-", "PP"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"dedhx", ",", "dedhy"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9045833741432323`*^9, 3.904583548806188*^9}, {
  3.9045836066291523`*^9, 3.9045836070636253`*^9}, {3.904583682480673*^9, 
  3.904583686629364*^9}, {3.9045849899093447`*^9, 3.904584999523973*^9}, {
  3.90613032621171*^9, 3.9061303271513033`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"3ff30ab7-2c15-4798-8fd6-e2fed1e9b966"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "generalized", " ", "function", " ", 
    "for", " ", "de2dhidhj"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjxx", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2xx", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                  RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], "2"], " ", 
               "KA"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                  "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                  ")"}], "2"], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "-", 
                 FractionBox[
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiy"}], "+", 
                 RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                 RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hix", "-", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hix"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hiy", "-", "hjy"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiy"}], "-", 
                 RowBox[{"0.5`", " ", "hjLasty"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiNexty"}], "-", 
                 RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hix", "-", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hix"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
                " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hiy", "-", "hjy"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2xx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
               RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hjLasty"}], "+", 
               RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2xx"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjxy", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2xy", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiLastx"}], "-", 
                 RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                 RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", "KA"}], "+", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]]}], ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hix"}], "-", 
               RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
               RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hix", "-", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiy"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}], "-", " ", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hix"}], "+", 
               RowBox[{"0.5`", " ", "hjLastx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiNexty"}], "-", 
               RowBox[{"0.5`", " ", "hjy"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hix", "-", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiy"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
              " ", "KP"}], "+", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2xy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
               RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hjLastx"}], "-", 
               RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2xy"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjyx", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2yx", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiLastx"}], "-", 
                 RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiLasty"}], "+", 
                 RowBox[{"0.5`", " ", "hiNexty"}]}], ")"}], " ", "KA"}], "+", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLastx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNextx"}], "+", "hix"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]]}], ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiy"}], "+", 
               RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiLastx"}], "-", 
               RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hiy", "-", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hix"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}], "+", " ", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiy"}], "-", 
               RowBox[{"0.5`", " ", "hjLasty"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hiNextx"}], "+", 
               RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hix"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
              " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{"hiy", "-", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
             " ", "KP"}], "-", 
            RowBox[{"KA", " ", 
             RowBox[{"(", 
              RowBox[{"PA", "-", "a"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]], "2", " ", 
             RowBox[{"(", 
              RowBox[{"hix", "-", "hjx"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"hiy", "-", "hjy"}], ")"}], " ", "KP", " ", 
             RowBox[{"(", 
              RowBox[{"p", "-", "PP"}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2yx", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiLastx"}], "-", 
               RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5`"}], " ", "hjLasty"}], "+", 
               RowBox[{"0.5`", " ", "hjNexty"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLastx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNextx"}], "+", "hjx"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2yx"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"de2dhihjyy", "[", 
      RowBox[{
      "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "de2yy", ",", "hix", ",", "hiy", ",", "hiLastx", ",", "hiLasty", ",", 
         "hiNextx", ",", "hiNexty", ",", "hjx", ",", "hjy", ",", "hjLastx", 
         ",", "hjLasty", ",", "hjNextx", ",", "hjNexty", ",", "p", ",", "a"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"peri", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"area", "[", "hv", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hix", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "hv", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hiNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hiNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hjx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjy", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjLastx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjLasty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "-", "1"}], "==", "0"}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"hjNextx", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"hjNexty", "=", 
         RowBox[{
          RowBox[{"hv", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "+", "1"}], "==", 
               RowBox[{"Length", "[", "hv", "]"}]}], ",", 
              RowBox[{"Length", "[", "hv", "]"}], ",", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"Length", "[", "hv", "]"}]}], "]"}]}], "]"}], "]"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "we", " ", "are", " ", "doing", " ", "de2dhidhi"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "1"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "0.5`"}], " ", "hiLastx"}], "+", 
                  RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], "2"], " ", 
               "KA"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                  "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                  ")"}], "2"], " ", "KP"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                    RowBox[{"3", "/", "2"}]]]}], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "-", 
                 FractionBox[
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}], 
                    ")"}], 
                   RowBox[{"3", "/", "2"}]]], "+", 
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", "2"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hix"}], "-", 
                 RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.5`", " ", "hiLastx"}], "-", 
                 RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hiy", "-", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiy"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
                 ")"}], " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hix", "-", "hjx"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "==", 
           RowBox[{"Length", "[", "hv", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hix"}], "+", 
                 RowBox[{"0.5`", " ", "hjLastx"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5`"}], " ", "hiNextx"}], "+", 
                 RowBox[{"0.5`", " ", "hjx"}]}], ")"}], " ", "KA"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                    
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]], 
                 "+", 
                 FractionBox[
                  RowBox[{"hiy", "-", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hiy"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}]]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]]}], ")"}],
                " ", "KP"}], "-", 
              RowBox[{
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hix", "-", "hjx"}], ")"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"hiy", "-", "hjy"}], ")"}], "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"hix", "-", "hjx"}], ")"}], "2"], " ", "KP", " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "PP"}], ")"}]}]}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "2"}], "||", 
             RowBox[{"j", "==", 
              RowBox[{"Length", "[", "hv", "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"de2yy", "=", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hiLastx"}], "-", 
               RowBox[{"0.5`", " ", "hiNextx"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.5`", " ", "hjLastx"}], "-", 
               RowBox[{"0.5`", " ", "hjNextx"}]}], ")"}], " ", "KA"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiLasty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLastx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiLasty"}], "+", "hiy"}], ")"}], "2"]}]]], 
               "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hiNexty"}], "+", "hiy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNextx"}], "+", "hix"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hiNexty"}], "+", "hiy"}], ")"}], "2"]}]]]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjLasty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLastx", "-", "hjx"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"hjLasty", "-", "hjy"}], ")"}], "2"]}]]], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"-", "hjNexty"}], "+", "hjy"}], 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNextx"}], "+", "hjx"}], ")"}], "2"], "+", 
                  
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "hjNexty"}], "+", "hjy"}], ")"}], "2"]}]]]}],
               ")"}], " ", "KP"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "de2yy"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"de2dhdhGeneral", "[", 
     RowBox[{
     "hv_List", ",", "j_", ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"de2dhihjxx", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}], ",", 
          RowBox[{"de2dhihjxy", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"de2dhihjyx", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}], ",", 
          RowBox[{"de2dhihjyy", "[", 
           RowBox[{
           "hv", ",", "j", ",", "KA", ",", "KP", ",", "PA", ",", "PP"}], 
           "]"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.904314259355904*^9, 3.9043143013526907`*^9}, {
   3.9043143488790083`*^9, 3.904314354014255*^9}, {3.904314415027624*^9, 
   3.904314423363253*^9}, {3.904314555148417*^9, 3.9043145991016417`*^9}, {
   3.904318762868161*^9, 3.9043188176425133`*^9}, {3.90431885241038*^9, 
   3.904318873326839*^9}, 3.904319021039928*^9, {3.904392556249627*^9, 
   3.904392556401775*^9}, {3.904392810921649*^9, 3.9043929592934637`*^9}, {
   3.904394000984392*^9, 3.904394001412709*^9}, {3.9043940324469557`*^9, 
   3.904394048533761*^9}, {3.904394098399927*^9, 3.904394174732284*^9}, {
   3.9043942389510593`*^9, 3.904394320233054*^9}, {3.904394353552403*^9, 
   3.904394461711257*^9}, {3.904394493168469*^9, 3.904394583446862*^9}, {
   3.90439462560255*^9, 3.904394702784791*^9}, {3.904394771091137*^9, 
   3.904394790284346*^9}, {3.9043948518335752`*^9, 3.9043948724480667`*^9}, {
   3.904394910666058*^9, 3.904394959684085*^9}, 3.9043950345912848`*^9, {
   3.904395570557641*^9, 3.904395606225356*^9}, {3.904395759800148*^9, 
   3.904395828380295*^9}, {3.904396020172752*^9, 3.90439605649513*^9}, {
   3.904396092602581*^9, 3.904396095458459*^9}, 3.9044012109332657`*^9, {
   3.904401864022257*^9, 3.904401889614188*^9}, {3.904402268602522*^9, 
   3.904402273229042*^9}, {3.904403439743452*^9, 3.904403444015863*^9}, {
   3.9044034866216917`*^9, 3.904403614145093*^9}, 3.904404080036344*^9, {
   3.9044748992823067`*^9, 3.904474940737397*^9}, {3.904474997295217*^9, 
   3.9044750614039793`*^9}, {3.9044756769934483`*^9, 
   3.9044757109442053`*^9}, {3.906130378818466*^9, 3.9061304112686157`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"b317a457-21a4-44d5-b47a-f4da402f9fd1"]
}, Closed]],

Cell[CellGroupData[{

Cell["vertex derivatives", "Subsection",
 CellChangeTimes->{{3.921773897312565*^9, 
  3.921773903497148*^9}},ExpressionUUID->"50212625-7264-4f7b-a10f-\
17542044be56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"dhd\[Epsilon]", "[", 
   RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.903795352687204*^9, 3.903795440132812*^9}, {
   3.903795838604693*^9, 3.90379584018342*^9}, {3.903795900108468*^9, 
   3.90379590100532*^9}, {3.903795994917081*^9, 3.9037960064053926`*^9}, {
   3.903796054634122*^9, 3.903796071339532*^9}, 3.9037983789762383`*^9, {
   3.903800169376627*^9, 3.9038001707602262`*^9}, {3.9038022300365143`*^9, 
   3.9038022306007233`*^9}, {3.921776349490902*^9, 3.921776377482992*^9}, {
   3.921777454811824*^9, 3.921777455467723*^9}, 3.921777574528479*^9, 
   3.921837744762615*^9, 3.9222765696545477`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"c6a20729-3051-4a4b-99b9-5348d1f3c5c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"r2y", " ", 
      SuperscriptBox["r3x", "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["r1y", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"r2y", "-", "r3y"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["r2x", "2"], " ", "r3y"}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["r2y", "2"], " ", "r3y"}], "-", 
     RowBox[{"3", " ", "r2y", " ", 
      SuperscriptBox["r3y", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["r1x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}], "+", 
     RowBox[{"r1y", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r2x", "2"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["r2y", "2"]}], "-", 
        SuperscriptBox["r3x", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["r3y", "2"]}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r1y", " ", 
        RowBox[{"(", 
         RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
       RowBox[{"r2y", " ", "r3x"}], "-", 
       RowBox[{"r2x", " ", "r3y"}], "+", 
       RowBox[{"r1x", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["r1x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["r2x", "2"], " ", "r3x"}], "-", 
     RowBox[{
      SuperscriptBox["r2y", "2"], " ", "r3x"}], "-", 
     RowBox[{"3", " ", "r2x", " ", 
      SuperscriptBox["r3x", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["r1y", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
     RowBox[{"r2x", " ", 
      SuperscriptBox["r3y", "2"]}], "+", 
     RowBox[{"r1x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         SuperscriptBox["r2x", "2"]}], "+", 
        SuperscriptBox["r2y", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["r3x", "2"]}], "-", 
        SuperscriptBox["r3y", "2"]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r1y", " ", 
        RowBox[{"(", 
         RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
       RowBox[{"r2y", " ", "r3x"}], "-", 
       RowBox[{"r2x", " ", "r3y"}], "+", 
       RowBox[{"r1x", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}]}], ")"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.921776364226894*^9, 3.9217763779538193`*^9}, 
   3.921777455974271*^9, 3.921777645320986*^9, {3.921778599773904*^9, 
   3.921778620416403*^9}, 3.921778706998489*^9, 3.921825790999748*^9, 
   3.9218377452698183`*^9, 3.921841556080271*^9, 3.922208455011086*^9, 
   3.922208780145316*^9, 3.9222088200440273`*^9, 3.92220885545957*^9, 
   3.92220889728831*^9, {3.922208938098648*^9, 3.922208976110648*^9}, 
   3.922209247841673*^9, 3.922209343567905*^9, 3.922209395390934*^9, 
   3.922209439659915*^9, 3.92221356154722*^9, 3.9222136323293743`*^9, 
   3.9222137312229757`*^9, 3.922276572480988*^9, 3.9222768318954363`*^9, 
   3.9222773311295443`*^9, 3.922528784547203*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"38457c6b-358e-4d67-827b-0b6487436228"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"dh2d\[Epsilon]d\[Epsilon]", "[", 
   RowBox[{"r1", ",", "r2", ",", "r3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.921776402371735*^9, 3.921776410075952*^9}, {
   3.9217774655725107`*^9, 3.92177746712381*^9}, 3.92183775942223*^9, {
   3.9222765778930798`*^9, 3.922276578420611*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"48114874-44c8-4143-9ac2-463acf254ea1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
     RowBox[{"r1y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
     RowBox[{"r1x", " ", 
      RowBox[{"(", 
       RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
     RowBox[{"r2x", " ", "r3y"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"3", " ", 
      SuperscriptBox["r1x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["r1y", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["r2x", "2"], " ", "r3x"}], "+", 
     RowBox[{
      SuperscriptBox["r2y", "2"], " ", "r3x"}], "-", 
     RowBox[{"3", " ", "r2x", " ", 
      SuperscriptBox["r3x", "2"]}], "-", 
     RowBox[{"r2x", " ", 
      SuperscriptBox["r3y", "2"]}], "+", 
     RowBox[{"r1x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         SuperscriptBox["r2x", "2"]}], "-", 
        SuperscriptBox["r2y", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["r3x", "2"]}], "+", 
        SuperscriptBox["r3y", "2"]}], ")"}]}]}], 
    RowBox[{
     RowBox[{"r1y", " ", 
      RowBox[{"(", 
       RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
     RowBox[{"r2y", " ", "r3x"}], "-", 
     RowBox[{"r2x", " ", "r3y"}], "+", 
     RowBox[{"r1x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9217764118939342`*^9, 3.921777470602911*^9, {3.921778600054521*^9, 
   3.921778620681086*^9}, 3.9217787073775806`*^9, 3.921825791158532*^9, 
   3.921837760174185*^9, 3.921841556140285*^9, 3.922208455304578*^9, 
   3.922208780543644*^9, 3.922208820415353*^9, 3.922208857394388*^9, 
   3.922208897686308*^9, {3.922208938438067*^9, 3.9222089763986588`*^9}, 
   3.9222092481258707`*^9, 3.922209343847865*^9, 3.922209395662767*^9, 
   3.922209439951063*^9, 3.9222135618716297`*^9, 3.922213632615529*^9, 
   3.922213731564142*^9, 3.92227657997269*^9, 3.922276832825623*^9, 
   3.922277331991984*^9, 3.922528785364133*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"d8b01075-f34e-47cf-9f1e-c8186963feb4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "analytical", " ", "forms", " ", 
    "for", " ", "dhdgamma", " ", "and", " ", "d2hdgamma2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dhd\[Epsilon]General", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"r2y", " ", 
             SuperscriptBox["r3x", "2"]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["r1y", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["r2x", "2"], " ", "r3y"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["r2y", "2"], " ", "r3y"}], "-", 
            RowBox[{"3", " ", "r2y", " ", 
             SuperscriptBox["r3y", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["r1x", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r2x", "2"], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["r2y", "2"]}], "-", 
               SuperscriptBox["r3x", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["r3y", "2"]}]}], ")"}]}]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r1y", " ", 
               RowBox[{"(", 
                RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
              RowBox[{"r2y", " ", "r3x"}], "-", 
              RowBox[{"r2x", " ", "r3y"}], "+", 
              RowBox[{"r1x", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}]}], ")"}]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{"3", " ", 
             SuperscriptBox["r1x", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["r2x", "2"], " ", "r3x"}], "-", 
            RowBox[{
             SuperscriptBox["r2y", "2"], " ", "r3x"}], "-", 
            RowBox[{"3", " ", "r2x", " ", 
             SuperscriptBox["r3x", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["r1y", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
            RowBox[{"r2x", " ", 
             SuperscriptBox["r3y", "2"]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", 
                SuperscriptBox["r2x", "2"]}], "+", 
               SuperscriptBox["r2y", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["r3x", "2"]}], "-", 
               SuperscriptBox["r3y", "2"]}], ")"}]}]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r1y", " ", 
               RowBox[{"(", 
                RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
              RowBox[{"r2y", " ", "r3x"}], "-", 
              RowBox[{"r2x", " ", "r3y"}], "+", 
              RowBox[{"r1x", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}]}], ")"}]}]]}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2hd\[Epsilon]d\[Epsilon]General", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"6", " ", 
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
            RowBox[{"r2x", " ", "r3y"}]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{"3", " ", 
             SuperscriptBox["r1x", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r1y", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["r2x", "2"], " ", "r3x"}], "+", 
            RowBox[{
             SuperscriptBox["r2y", "2"], " ", "r3x"}], "-", 
            RowBox[{"3", " ", "r2x", " ", 
             SuperscriptBox["r3x", "2"]}], "-", 
            RowBox[{"r2x", " ", 
             SuperscriptBox["r3y", "2"]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", 
                SuperscriptBox["r2x", "2"]}], "-", 
               SuperscriptBox["r2y", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["r3x", "2"]}], "+", 
               SuperscriptBox["r3y", "2"]}], ")"}]}]}], 
           RowBox[{
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}]}], "+", 
            RowBox[{"r2y", " ", "r3x"}], "-", 
            RowBox[{"r2x", " ", "r3y"}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}]}]]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "These", " ", "are", " ", "the", " ", "analytical", " ", "forms", " ", 
     "for", " ", "dhdgamma", " ", "and", " ", "d2hdgamma2"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dhdgGeneral", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"r1x", " ", "r1y", " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
            RowBox[{"r2y", " ", 
             RowBox[{"(", 
              RowBox[{"r2x", "-", "r3x"}], ")"}], " ", "r3y"}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r2x"}], " ", "r2y"}], "+", 
               RowBox[{"r3x", " ", "r3y"}]}], ")"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
            RowBox[{"r2x", " ", "r3y"}]}]], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "r2x", " ", "r2y", " ", "r3x"}], "+", 
             RowBox[{"r2y", " ", 
              SuperscriptBox["r3x", "2"]}], "-", 
             RowBox[{
              SuperscriptBox["r2x", "2"], " ", "r3y"}], "-", 
             RowBox[{
              SuperscriptBox["r2y", "2"], " ", "r3y"}], "+", 
             RowBox[{"2", " ", "r2x", " ", "r3x", " ", "r3y"}], "+", 
             RowBox[{"r2y", " ", 
              SuperscriptBox["r3y", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["r1x", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["r1y", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}], "+", 
             RowBox[{"2", " ", "r1x", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"r2x", " ", "r2y"}], "+", 
                RowBox[{"r1y", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "-", 
                RowBox[{"r3x", " ", "r3y"}]}], ")"}]}], "+", 
             RowBox[{"r1y", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r2x", "2"], "+", 
                SuperscriptBox["r2y", "2"], "-", 
                SuperscriptBox["r3x", "2"], "-", 
                SuperscriptBox["r3y", "2"]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
               RowBox[{"r1y", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
               RowBox[{"r1x", " ", 
                RowBox[{"(", 
                 RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
               RowBox[{"r2x", " ", "r3y"}]}], ")"}]}], ")"}]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2hdgdgGeneral", "[", 
      RowBox[{"r1_List", ",", "r2_List", ",", "r3_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "r1x", ",", "r1y", ",", "r2x", ",", "r2y", ",", "r3x", ",", "r3y"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1x", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r1y", "=", 
         RowBox[{"r1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r2x", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r2y", "=", 
         RowBox[{"r2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", 
        RowBox[{"r3x", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"r3y", "=", 
         RowBox[{"r3", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r2y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r1y", "-", "r3y"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"r2y", "-", "r3y"}], ")"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
            RowBox[{"r1y", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
            RowBox[{"r1x", " ", 
             RowBox[{"(", 
              RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
            RowBox[{"r2x", " ", "r3y"}]}]], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["r2y", "2"]}], " ", "r3x"}], "+", 
             RowBox[{
              SuperscriptBox["r1y", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "-", 
             RowBox[{"2", " ", "r2x", " ", "r2y", " ", "r3y"}], "+", 
             RowBox[{"2", " ", "r2y", " ", "r3x", " ", "r3y"}], "+", 
             RowBox[{"r2x", " ", 
              SuperscriptBox["r3y", "2"]}], "+", 
             RowBox[{"r1x", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r2y", "2"], "-", 
                SuperscriptBox["r3y", "2"]}], ")"}]}], "+", 
             RowBox[{"2", " ", "r1y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"r2x", " ", "r2y"}], "-", 
                RowBox[{"r3x", " ", "r3y"}], "+", 
                RowBox[{"r1x", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "r2y"}], "+", "r3y"}], ")"}]}]}], ")"}]}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r2y"}], " ", "r3x"}], "+", 
             RowBox[{"r1y", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2x"}], "+", "r3x"}], ")"}]}], "+", 
             RowBox[{"r1x", " ", 
              RowBox[{"(", 
               RowBox[{"r2y", "-", "r3y"}], ")"}]}], "+", 
             RowBox[{"r2x", " ", "r3y"}]}], ")"}]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9045841279265203`*^9, 3.904584142283367*^9}, {
   3.904584625055174*^9, 3.904584639323862*^9}, {3.906130438548835*^9, 
   3.906130451769902*^9}, {3.921777484879904*^9, 3.921777494934762*^9}, {
   3.9217776525374727`*^9, 3.921777713723765*^9}, {3.921777783996724*^9, 
   3.921777784988348*^9}, 3.921836847563768*^9, {3.9218369419078007`*^9, 
   3.9218369513323803`*^9}, {3.9218377871046877`*^9, 3.921837825188109*^9}, {
   3.922276587939825*^9, 3.9222766160210114`*^9}, 3.922277476287847*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"8fb65a32-ade6-47fc-90e0-ec83862c1d3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "this", " ", "is", " ", "to", " ", "calculate", " ", 
    "de2dgammadgamma", " ", "for", " ", "cell", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d2eid\[Epsilon]d\[Epsilon]General", "[", 
     RowBox[{
     "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", 
      ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"de2dhdhGeneral", "[", 
             RowBox[{
              RowBox[{"RotateLeft", "[", 
               RowBox[{"vList", ",", "i"}], "]"}], ",", "j", ",", "KA", ",", 
              "KP", ",", "PA", ",", "PP"}], "]"}], ".", 
            RowBox[{"dhd\[Epsilon]General", "[", 
             RowBox[{"ri", ",", 
              RowBox[{"allPoints", "[", 
               RowBox[{"[", 
                RowBox[{"neilist", "[", 
                 RowBox[{"[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"j", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"allPoints", "[", 
               RowBox[{"[", 
                RowBox[{"neilist", "[", 
                 RowBox[{"[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}], "]"}], "]"}]}], "]"}], ".", 
            RowBox[{"dhd\[Epsilon]General", "[", 
             RowBox[{"ri", ",", 
              RowBox[{"allPoints", "[", 
               RowBox[{"[", 
                RowBox[{"neilist", "[", 
                 RowBox[{"[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"allPoints", "[", 
               RowBox[{"[", 
                RowBox[{"neilist", "[", 
                 RowBox[{"[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "vList", "]"}]}], "}"}]}], "]"}], "+", 
         RowBox[{
          RowBox[{"dedhGeneral", "[", 
           RowBox[{
            RowBox[{"RotateLeft", "[", 
             RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
            "PA", ",", "PP"}], "]"}], ".", 
          RowBox[{"d2hd\[Epsilon]d\[Epsilon]General", "[", 
           RowBox[{"ri", ",", 
            RowBox[{"allPoints", "[", 
             RowBox[{"[", 
              RowBox[{"neilist", "[", 
               RowBox[{"[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "+", "i"}], "==", 
                   RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}], ",", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"allPoints", "[", 
             RowBox[{"[", 
              RowBox[{"neilist", "[", 
               RowBox[{"[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"2", "+", "i"}], "==", 
                   RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}], ",", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.904588774883918*^9, 3.904588884153892*^9}, {
  3.904588916453887*^9, 3.90458896383661*^9}, {3.904589002328372*^9, 
  3.904589083617495*^9}, {3.904589212787785*^9, 3.904589218872802*^9}, {
  3.904589279843504*^9, 3.904589283398299*^9}, {3.904589394633286*^9, 
  3.904589429824355*^9}, {3.90458948833243*^9, 3.904589507708624*^9}, {
  3.904589579432266*^9, 3.904589605469116*^9}, {3.904589662919032*^9, 
  3.90458970306603*^9}, {3.904589924188938*^9, 3.904589924310618*^9}, {
  3.9045900036701*^9, 3.904590007945014*^9}, {3.904590687997143*^9, 
  3.9045907041614733`*^9}, {3.904591200828555*^9, 3.904591253354176*^9}, {
  3.904591591505011*^9, 3.9045916028670387`*^9}, {3.904605382965023*^9, 
  3.904605515344393*^9}, {3.906130493495236*^9, 3.906130552771426*^9}, {
  3.921777725322528*^9, 3.921777829589095*^9}, {3.92227663871754*^9, 
  3.9222766524421043`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"084a8052-a8ea-415c-ba1f-e49291980e5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "this", " ", "is", " ", "to", " ", "calculate", " ", 
    "dedgamma", " ", "for", " ", "cell", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"deid\[Epsilon]General", "[", 
     RowBox[{
     "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", 
      ",", "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dedhGeneral", "[", 
          RowBox[{
           RowBox[{"RotateLeft", "[", 
            RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
           "PA", ",", "PP"}], "]"}], ".", 
         RowBox[{"dhd\[Epsilon]General", "[", 
          RowBox[{"ri", ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neilist", "[", 
              RowBox[{"[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "+", "1"}], "==", 
                  RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                 RowBox[{"Length", "[", "vList", "]"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
               "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neilist", "[", 
              RowBox[{"[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"2", "+", "i"}], "==", 
                   RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                  RowBox[{
                   RowBox[{"2", "+", "i"}], "==", 
                   RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                 RowBox[{"Length", "[", "vList", "]"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"2", "+", "i"}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
               "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.906132827205215*^9, 3.9061328533171377`*^9}, 
   3.906132884082106*^9, {3.906132923021924*^9, 3.906132956481184*^9}, {
   3.906133662693007*^9, 3.906133662922853*^9}, {3.906133712658743*^9, 
   3.906133715944762*^9}, {3.906218817065702*^9, 3.906218818843371*^9}, {
   3.921777839694077*^9, 3.921777862860722*^9}, {3.922276654883193*^9, 
   3.922276661048958*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"1075be55-173e-4441-a5ff-043fd0bf882f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "this", " ", "is", " ", "to", " ", "calculate", " ", 
    "de2dgammadgamma", " ", "for", " ", "cell", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d2eidgdgGeneral", "[", 
    RowBox[{
    "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", ",",
      "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"de2dhdhGeneral", "[", 
            RowBox[{
             RowBox[{"RotateLeft", "[", 
              RowBox[{"vList", ",", "i"}], "]"}], ",", "j", ",", "KA", ",", 
             "KP", ",", "PA", ",", "PP"}], "]"}], ".", 
           RowBox[{"dhdgGeneral", "[", 
            RowBox[{"ri", ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"j", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], "==", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"dhdgGeneral", "[", 
            RowBox[{"ri", ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"allPoints", "[", 
              RowBox[{"[", 
               RowBox[{"neilist", "[", 
                RowBox[{"[", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "+", "i"}], "==", 
                    RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "vList", "]"}]}], "}"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"dedhGeneral", "[", 
          RowBox[{
           RowBox[{"RotateLeft", "[", 
            RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
           "PA", ",", "PP"}], "]"}], ".", 
         RowBox[{"d2hdgdgGeneral", "[", 
          RowBox[{"ri", ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neilist", "[", 
              RowBox[{"[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "+", "i"}], "==", 
                  RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                 RowBox[{"Length", "[", "vList", "]"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"1", "+", "i"}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
               "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neilist", "[", 
              RowBox[{"[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"2", "+", "i"}], "==", 
                  RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                 RowBox[{"Length", "[", "vList", "]"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"2", "+", "i"}], ",", 
                   RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
               "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{
          RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.904588774883918*^9, 3.904588884153892*^9}, {
  3.904588916453887*^9, 3.90458896383661*^9}, {3.904589002328372*^9, 
  3.904589083617495*^9}, {3.904589212787785*^9, 3.904589218872802*^9}, {
  3.904589279843504*^9, 3.904589283398299*^9}, {3.904589394633286*^9, 
  3.904589429824355*^9}, {3.90458948833243*^9, 3.904589507708624*^9}, {
  3.904589579432266*^9, 3.904589605469116*^9}, {3.904589662919032*^9, 
  3.90458970306603*^9}, {3.904589924188938*^9, 3.904589924310618*^9}, {
  3.9045900036701*^9, 3.904590007945014*^9}, {3.904590687997143*^9, 
  3.9045907041614733`*^9}, {3.904591200828555*^9, 3.904591253354176*^9}, {
  3.904591591505011*^9, 3.9045916028670387`*^9}, {3.904605382965023*^9, 
  3.904605515344393*^9}, {3.906130493495236*^9, 3.906130552771426*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"7912d349-653f-4f93-b533-de4c297fc545"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "this", " ", "is", " ", "to", " ", "calculate", " ", 
    "dedgamma", " ", "for", " ", "cell", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"deidgGeneral", "[", 
    RowBox[{
    "allPoints_List", ",", "vList_List", ",", "ri_", ",", "neilist_List", ",",
      "KA_", ",", "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dedhGeneral", "[", 
         RowBox[{
          RowBox[{"RotateLeft", "[", 
           RowBox[{"vList", ",", "i"}], "]"}], ",", "KA", ",", "KP", ",", 
          "PA", ",", "PP"}], "]"}], ".", 
        RowBox[{"dhdgGeneral", "[", 
         RowBox[{"ri", ",", 
          RowBox[{"allPoints", "[", 
           RowBox[{"[", 
            RowBox[{"neilist", "[", 
             RowBox[{"[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "+", "1"}], "==", 
                 RowBox[{"Length", "[", "vList", "]"}]}], ",", 
                RowBox[{"Length", "[", "vList", "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
              "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"allPoints", "[", 
           RowBox[{"[", 
            RowBox[{"neilist", "[", 
             RowBox[{"[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"2", "+", "i"}], "==", 
                  RowBox[{"Length", "[", "vList", "]"}]}], "||", 
                 RowBox[{
                  RowBox[{"2", "+", "i"}], "==", 
                  RowBox[{"2", "*", 
                   RowBox[{"Length", "[", "vList", "]"}]}]}]}], ",", 
                RowBox[{"Length", "[", "vList", "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"2", "+", "i"}], ",", 
                  RowBox[{"Length", "[", "vList", "]"}]}], "]"}]}], "]"}], 
              "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{
          RowBox[{"Length", "[", "vList", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.906132827205215*^9, 3.9061328533171377`*^9}, 
   3.906132884082106*^9, {3.906132923021924*^9, 3.906132956481184*^9}, {
   3.906133662693007*^9, 3.906133662922853*^9}, {3.906133712658743*^9, 
   3.906133715944762*^9}, {3.906218817065702*^9, 3.906218818843371*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"1a93e89b-e6c9-42f2-9400-9e028220bb8f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "This", " ", "gives", " ", "the", " ", "neighbor", " ", "list", " ", "of", 
    " ", "cell", " ", "i", " ", "in", " ", "a", " ", "counterclock"}], "-", 
   RowBox[{
   "wise", " ", "order", " ", "and", " ", "this", " ", "neighbor", " ", 
    "list", " ", "aligns", " ", "with", " ", "the", " ", "vertex", " ", "id", 
    " ", "list"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.906130586835259*^9, 3.906130590643478*^9}, {
  3.906130701731743*^9, 3.9061307771468363`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"f198c114-d3d9-456f-92dd-4f1160169939"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reorderCCWIndices", "[", 
    RowBox[{"centerIndex_", ",", "neighborIndices_List", ",", "allPoints_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "center", ",", "neighbors", ",", "angles", ",", "sortedIndices"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"center", "=", 
       RowBox[{"allPoints", "[", 
        RowBox[{"[", "centerIndex", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"neighbors", "=", 
       RowBox[{"allPoints", "[", 
        RowBox[{"[", "neighborIndices", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"angles", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "-", "center"}], "&"}], "/@", "neighbors"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sortedIndices", "=", 
       RowBox[{"Ordering", "[", "angles", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"neighborIndices", "[", 
       RowBox[{"[", "sortedIndices", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"neighborIndices", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"FirstPosition", "[", 
           RowBox[{"sortedIndices", ",", "i"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "neighborIndices", "]"}]}], "}"}]}], "]"}], 
     "*)"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"neighborListRightOrder", "[", 
    RowBox[{
    "i_", ",", "voronoiPolygons_List", ",", "cellIndex_", ",", "allPoints_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trianglesWithCenteri", ",", "neighborListRandomOrder", ",", 
       "neighborListCCWOrder", ",", "delaunay", ",", "vetices", ",", 
       "firstVerticeID"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"delaunay", "=", 
       RowBox[{"DelaunayMesh", "[", "allPoints", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trianglesWithCenteri", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"First", "/@", 
          RowBox[{"MeshCells", "[", 
           RowBox[{"delaunay", ",", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"#", ",", "i"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"neighborListRandomOrder", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "trianglesWithCenteri", "]"}], "]"}], ",", 
         "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"neighborListCCWOrder", "=", 
       RowBox[{"reorderCCWIndices", "[", 
        RowBox[{"i", ",", "neighborListRandomOrder", ",", "allPoints"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vetices", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"voro", "[", 
          RowBox[{
           RowBox[{"allPoints", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neighborListCCWOrder", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"allPoints", "[", 
            RowBox[{"[", 
             RowBox[{"neighborListCCWOrder", "[", 
              RowBox[{"[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"j", "+", "1"}], "==", 
                  RowBox[{"Length", "[", "neighborListCCWOrder", "]"}]}], ",", 
                 RowBox[{"Length", "[", "neighborListCCWOrder", "]"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", 
                   RowBox[{"Length", "[", "neighborListCCWOrder", "]"}]}], 
                  "]"}]}], "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "neighborListCCWOrder", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"firstVerticeID", "=", 
       RowBox[{
        RowBox[{"Nearest", "[", 
         RowBox[{
          RowBox[{"vetices", "->", "Automatic"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"voronoiPolygons", "[", 
             RowBox[{"[", 
              RowBox[{"cellIndex", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RotateLeft", "[", 
       RowBox[{"neighborListCCWOrder", ",", 
        RowBox[{"firstVerticeID", "-", "1"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.90468534869175*^9, 3.904685348696452*^9}, {
   3.90468560748496*^9, 3.904685619254031*^9}, {3.904687047825791*^9, 
   3.90468714544456*^9}, {3.90468790441046*^9, 3.90468794568607*^9}, 
   3.904688618553898*^9, {3.904690094631613*^9, 3.904690095727626*^9}, {
   3.906130806424521*^9, 3.9061308069205217`*^9}, 3.906130877827166*^9, 
   3.906219735103504*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"7a8148f7-b39b-403d-a384-94edf263cde6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "function", " ", "that", " ", 
    "returns", " ", "a", " ", "list", " ", "of", " ", 
    FractionBox["dei", "dg"], " ", "and", " ", 
    FractionBox["d2ei", "dg2"], " ", "for", " ", "each", " ", "cell"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Analytical\[Epsilon]Cell", "[", 
      RowBox[{
      "allPoints_", ",", "box_List", ",", "pointID_List", ",", "KA_", ",", 
       "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vm", ",", "voronoiPolygons", ",", "min", ",", "max", ",", 
         "cellIndex", ",", "copies", ",", "translatedCopies", ",", 
         "translations", ",", "allPointsPBD"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"copies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"translations", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
        RowBox[{"translatedCopies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "+", "translation"}], "&"}], ",", 
             RowBox[{"copies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"allPointsPBD", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"translatedCopies", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min", "=", 
         RowBox[{
          RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
        RowBox[{"max", "=", 
         RowBox[{
          RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vm", "=", 
         RowBox[{"VoronoiMesh", "[", 
          RowBox[{"allPointsPBD", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"voronoiPolygons", "=", 
         RowBox[{"MeshPrimitives", "[", 
          RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cellIndex", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"RegionMember", "[", 
                 RowBox[{
                  RowBox[{"voronoiPolygons", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"allPointsPBD", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
               "]"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"deid\[Epsilon]General", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}], ",", 
            RowBox[{"d2eid\[Epsilon]d\[Epsilon]General", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "pointID"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "the", " ", "function", " ", "that", " ", 
     "returns", " ", "a", " ", "list", " ", "of", " ", 
     FractionBox["dei", "dg"], " ", "and", " ", 
     FractionBox["d2ei", "dg2"], " ", "for", " ", "each", " ", "cell"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AnalyticalgCell", "[", 
      RowBox[{
      "allPoints_", ",", "box_List", ",", "pointID_List", ",", "KA_", ",", 
       "KP_", ",", "PA_", ",", "PP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vm", ",", "voronoiPolygons", ",", "min", ",", "max", ",", 
         "cellIndex", ",", "copies", ",", "translatedCopies", ",", 
         "translations", ",", "allPointsPBD"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"copies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"translations", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
        RowBox[{"translatedCopies", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "+", "translation"}], "&"}], ",", 
             RowBox[{"copies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"allPointsPBD", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"translatedCopies", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allPointsPBD", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"allPointsPBD", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], "<", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{"box", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "3"}]}], "&&", 
             RowBox[{
              RowBox[{"-", "3"}], "<", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{"box", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", "3"}]}]}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"min", "=", 
         RowBox[{
          RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
        RowBox[{"max", "=", 
         RowBox[{
          RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vm", "=", 
         RowBox[{"VoronoiMesh", "[", 
          RowBox[{"allPointsPBD", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"voronoiPolygons", "=", 
         RowBox[{"MeshPrimitives", "[", 
          RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cellIndex", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"RegionMember", "[", 
                 RowBox[{
                  RowBox[{"voronoiPolygons", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"allPointsPBD", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
               "]"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"deidgGeneral", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}], ",", 
            RowBox[{"d2eidgdgGeneral", "[", 
             RowBox[{"allPointsPBD", ",", 
              RowBox[{
               RowBox[{"voronoiPolygons", "[", 
                RowBox[{"[", 
                 RowBox[{"cellIndex", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"allPointsPBD", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"neighborListRightOrder", "[", 
               RowBox[{
               "i", ",", "voronoiPolygons", ",", "cellIndex", ",", 
                "allPointsPBD"}], "]"}], ",", "KA", ",", "KP", ",", "PA", ",",
               "PP"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "pointID"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9061309008804817`*^9, 3.906130902084465*^9}, {
   3.906130944911058*^9, 3.906131000856138*^9}, 3.9061310366252117`*^9, {
   3.9061311006207237`*^9, 3.906131101861796*^9}, {3.906133757928031*^9, 
   3.906133781273082*^9}, {3.9061338404375687`*^9, 3.9061338924887133`*^9}, {
   3.9062171089465723`*^9, 3.906217320241297*^9}, {3.906217354916769*^9, 
   3.906217380642602*^9}, 3.9062197625754967`*^9, 3.9062204061114902`*^9, {
   3.906220492405673*^9, 3.906220507516293*^9}, {3.921777958192114*^9, 
   3.9217780086249943`*^9}, {3.922276667167231*^9, 3.922276679087454*^9}, 
   3.922276736686689*^9, {3.922277395677464*^9, 3.922277406736454*^9}, 
   3.922277497914296*^9, {3.922277542356756*^9, 3.922277542612372*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"b8302214-8022-48c4-9cbc-ff24758ebba7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906218400714576*^9, 3.9062184085961027`*^9}, {
   3.90621856274302*^9, 3.906218572019668*^9}, {3.906219670250162*^9, 
   3.906219672226655*^9}, 3.906219759154039*^9, {3.9062199548309517`*^9, 
   3.906219955245036*^9}, {3.9217785054196043`*^9, 3.92177851327596*^9}, {
   3.921826076550517*^9, 3.921826084642733*^9}, 3.922276684921262*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"e0864ef4-a0c2-4055-9af3-189c094808d0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical function:", "Section",
 CellChangeTimes->{{3.906131141235631*^9, 
  3.906131160496708*^9}},ExpressionUUID->"d94f9a14-62f1-49f6-8b5a-\
e9ec9ecfdf7e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "function", " ", "returns", " ", 
   FractionBox["dei", "dg"], " ", "and", " ", 
   FractionBox["d2ei", 
    RowBox[{"dg", "^", "2"}]], " ", "for", " ", "each", " ", "cell"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9061326579081097`*^9, 3.906132664814098*^9}, {
  3.9061327204674053`*^9, 3.906132746401671*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"7eba5210-dcce-495b-bdf7-67c18d8ab094"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numdericalCell\[Epsilon]", "[", 
     RowBox[{
     "allPoints_List", ",", "box_List", ",", "ddx_", ",", "ka_", ",", "kp_", 
      ",", "pa_", ",", "pp_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Vareas0", ",", "Vperis0", ",", "Vareas1", ",", "Vperis1", ",", 
        "VareasI", ",", "VperisI", ",", "copies", ",", "translations", ",", 
        "translatedCopies", ",", "allPointsPBD", ",", "cellIndex", ",", 
        "cellIndex0", ",", "cellIndex1", ",", "strainfor", ",", "strainback", 
        ",", "vm", ",", "vm1", ",", "vm0", ",", "allPointsPBD0", ",", 
        "allPointsPBD1", ",", "min", ",", "max", ",", "voronoiPolygons", ",", 
        "voronoiPolygons1", ",", "voronoiPolygons0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"copies", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"translations", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
       RowBox[{"translatedCopies", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "translation"}], "&"}], ",", 
            RowBox[{"copies", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], 
       ";", 
       RowBox[{"allPointsPBD", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"translatedCopies", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"strainfor", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "+", "ddx"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", "ddx"}], ")"}]}]}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"strainback", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "ddx"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "ddx"}], ")"}]}]}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"min", "=", 
        RowBox[{
         RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
       RowBox[{"max", "=", 
        RowBox[{
         RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allPointsPBD", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"allPointsPBD", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "<", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "3"}]}], "&&", 
            RowBox[{
             RowBox[{"-", "3"}], "<", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "3"}]}]}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vm", "=", 
        RowBox[{"VoronoiMesh", "[", 
         RowBox[{"allPointsPBD", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"voronoiPolygons", "=", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellIndex", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"voronoiPolygons", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"allPointsPBD", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
              "]"}], ",", "True"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"VareasI", "=", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vm", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"VperisI", "=", 
        RowBox[{"RegionMeasure", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MeshPrimitives", "[", 
            RowBox[{"vm", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"allPointsPBD0", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"strainfor", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vm0", "=", 
        RowBox[{"VoronoiMesh", "[", 
         RowBox[{"allPointsPBD0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"voronoiPolygons0", "=", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"vm0", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellIndex0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"voronoiPolygons0", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"allPointsPBD0", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "allPointsPBD0", "]"}]}], "}"}]}], 
              "]"}], ",", "True"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Vareas0", "=", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vm0", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vperis0", "=", 
        RowBox[{"RegionMeasure", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MeshPrimitives", "[", 
            RowBox[{"vm0", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"allPointsPBD1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"strainback", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vm1", "=", 
        RowBox[{"VoronoiMesh", "[", 
         RowBox[{"allPointsPBD1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"min", "+", 
               RowBox[{"0.001", "*", "min"}]}], ",", 
              RowBox[{"max", "+", 
               RowBox[{"0.001", "*", "max"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Vareas1", "=", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vm1", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vperis1", "=", 
        RowBox[{"RegionMeasure", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MeshPrimitives", "[", 
            RowBox[{"vm1", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"voronoiPolygons1", "=", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"vm1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellIndex1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"voronoiPolygons1", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"allPointsPBD1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "allPointsPBD1", "]"}]}], "}"}]}], 
              "]"}], ",", "True"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}], "-", 
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "-", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", "ddx"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ka", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vareas0", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                   ")"}], "^", "2"}]}], "+", 
               RowBox[{"kp", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vperis0", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                   ")"}], "^", "2"}]}], "+", 
               RowBox[{"ka", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vareas1", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                   ")"}], "^", "2"}]}], "+", 
               RowBox[{"kp", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vperis1", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                   ")"}], "^", "2"}]}], "-", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ka", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VareasI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                     ")"}], "^", "2"}]}], "+", 
                  RowBox[{"kp", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VperisI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                     ")"}], "^", "2"}]}]}], ")"}]}]}], ")"}], "/", "ddx"}], 
            "/", "ddx"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.9036267151986856`*^9, 3.903626826615308*^9}, {
   3.9036268679519567`*^9, 3.9036268737354107`*^9}, {3.903626942452201*^9, 
   3.903626944611924*^9}, {3.903627039394018*^9, 3.903627044507419*^9}, {
   3.9036314828750963`*^9, 3.903631515196673*^9}, {3.904605602190879*^9, 
   3.904605676747971*^9}, {3.904605919754586*^9, 3.9046059212402067`*^9}, {
   3.904749830201756*^9, 3.90474998966967*^9}, {3.904750061925131*^9, 
   3.904750065768656*^9}, {3.904750132076775*^9, 3.904750139359756*^9}, {
   3.906131477293146*^9, 3.906131742280287*^9}, {3.9061317872509823`*^9, 
   3.9061318209519453`*^9}, {3.906131854588011*^9, 3.906131914810781*^9}, {
   3.9061321420170918`*^9, 3.9061321582109537`*^9}, {3.906132205471896*^9, 
   3.906132401838616*^9}, {3.906132548247774*^9, 3.9061325735235987`*^9}, {
   3.906132613232308*^9, 3.906132648239827*^9}, {3.906132679997253*^9, 
   3.9061327082933607`*^9}, 3.9062197541342583`*^9, {3.906220761831339*^9, 
   3.906220839703073*^9}, 3.906221018139063*^9, {3.906222223804881*^9, 
   3.906222230351351*^9}, 3.9217780211398087`*^9, {3.921778127156601*^9, 
   3.9217781794852943`*^9}, {3.9222766920736*^9, 3.9222767167720537`*^9}, {
   3.922277211849393*^9, 3.922277250669353*^9}, {3.922277302464829*^9, 
   3.922277312808958*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"967a39b9-849d-4c27-bc3a-d4d20cb8f69b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numdericalCellg", "[", 
     RowBox[{
     "allPoints_List", ",", "box_List", ",", "ddx_", ",", "ka_", ",", "kp_", 
      ",", "pa_", ",", "pp_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Vareas0", ",", "Vperis0", ",", "Vareas1", ",", "Vperis1", ",", 
        "VareasI", ",", "VperisI", ",", "copies", ",", "translations", ",", 
        "translatedCopies", ",", "allPointsPBD", ",", "cellIndex", ",", 
        "cellIndex0", ",", "cellIndex1", ",", "strainfor", ",", "strainback", 
        ",", "vm", ",", "vm1", ",", "vm0", ",", "allPointsPBD0", ",", 
        "allPointsPBD1", ",", "min", ",", "max", ",", "voronoiPolygons", ",", 
        "voronoiPolygons1", ",", "voronoiPolygons0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"copies", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"allPoints", ",", "9"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"translations", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"box", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"box", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";", 
       RowBox[{"translatedCopies", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "translation"}], "&"}], ",", 
            RowBox[{"copies", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"translation", ",", "translations"}], "}"}]}], "]"}]}], 
       ";", 
       RowBox[{"allPointsPBD", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"translatedCopies", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"strainfor", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "ddx"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"strainback", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "ddx"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"min", "=", 
        RowBox[{
         RowBox[{"Min", "[", "allPointsPBD", "]"}], "-", ".1"}]}], ";", 
       RowBox[{"max", "=", 
        RowBox[{
         RowBox[{"Max", "[", "allPointsPBD", "]"}], "+", ".1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allPointsPBD", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"allPointsPBD", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "<", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"box", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "3"}]}], "&&", 
            RowBox[{
             RowBox[{"-", "3"}], "<", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"box", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "3"}]}]}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vm", "=", 
        RowBox[{"VoronoiMesh", "[", 
         RowBox[{"allPointsPBD", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"voronoiPolygons", "=", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"vm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellIndex", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"voronoiPolygons", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"allPointsPBD", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "allPointsPBD", "]"}]}], "}"}]}], 
              "]"}], ",", "True"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"VareasI", "=", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vm", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"VperisI", "=", 
        RowBox[{"RegionMeasure", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MeshPrimitives", "[", 
            RowBox[{"vm", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"allPointsPBD0", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"strainfor", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vm0", "=", 
        RowBox[{"VoronoiMesh", "[", 
         RowBox[{"allPointsPBD0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"voronoiPolygons0", "=", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"vm0", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellIndex0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"voronoiPolygons0", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"allPointsPBD0", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "allPointsPBD0", "]"}]}], "}"}]}], 
              "]"}], ",", "True"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Vareas0", "=", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vm0", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vperis0", "=", 
        RowBox[{"RegionMeasure", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MeshPrimitives", "[", 
            RowBox[{"vm0", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"allPointsPBD1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"strainback", ".", "#"}], "&"}], "/@", "allPointsPBD"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vm1", "=", 
        RowBox[{"VoronoiMesh", "[", 
         RowBox[{"allPointsPBD1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"min", "+", 
               RowBox[{"0.001", "*", "min"}]}], ",", 
              RowBox[{"max", "+", 
               RowBox[{"0.001", "*", "max"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", "max"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Vareas1", "=", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vm1", ",", "2"}], "}"}], ",", "MeshCellMeasure"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vperis1", "=", 
        RowBox[{"RegionMeasure", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MeshPrimitives", "[", 
            RowBox[{"vm1", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Polygon", "[", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y__"}], "}"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "x"}], "}"}], "]"}]}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"voronoiPolygons1", "=", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"vm1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellIndex1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RegionMember", "[", 
                RowBox[{
                 RowBox[{"voronoiPolygons1", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"allPointsPBD1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "allPointsPBD1", "]"}]}], "}"}]}], 
              "]"}], ",", "True"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "+", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis0", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}], "-", 
              RowBox[{"ka", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vareas1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                  ")"}], "^", "2"}]}], "-", 
              RowBox[{"kp", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Vperis1", "[", 
                   RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                  ")"}], "^", "2"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", "ddx"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ka", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vareas0", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                   ")"}], "^", "2"}]}], "+", 
               RowBox[{"kp", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vperis0", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex0", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                   ")"}], "^", "2"}]}], "+", 
               RowBox[{"ka", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vareas1", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                   ")"}], "^", "2"}]}], "+", 
               RowBox[{"kp", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Vperis1", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                   ")"}], "^", "2"}]}], "-", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ka", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VareasI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pa"}],
                     ")"}], "^", "2"}]}], "+", 
                  RowBox[{"kp", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"VperisI", "[", 
                    RowBox[{"[", 
                    RowBox[{"cellIndex", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "-", "pp"}],
                     ")"}], "^", "2"}]}]}], ")"}]}]}], ")"}], "/", "ddx"}], 
            "/", "ddx"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "allPoints", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.922277585773345*^9, 3.92227761058204*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"729fefa4-fbf8-4992-aba5-011486ee1b58"]
}, Closed]],

Cell[CellGroupData[{

Cell["One snapshot to test numerical and analytical", "Section",
 CellChangeTimes->{{3.91372777665914*^9, 3.913727798549033*^9}, {
  3.921778194371974*^9, 
  3.92177820075561*^9}},ExpressionUUID->"7c3b2c47-fe19-4dde-81f5-\
bec6171cb843"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"data", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</Users/chengling/Downloads/nvt_stress_tensor_N100_p3.800_T0.\
01000000_0.nc\>\"", ",", "\"\<Data\>\""}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</home/chengling/Research/Project/Cell/AnalyticalG/data/N100/\
derivativeTest/nvt_pureShear_N100_p3.800_T0.01000000_0.nc\>\"", ",", 
     "\"\<Data\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.913392370327138*^9, 3.913392382077566*^9}, {
   3.913393695986911*^9, 3.913393696127836*^9}, {3.9133937315792513`*^9, 
   3.913393731743902*^9}, {3.913473284568802*^9, 3.913473287706699*^9}, 
   3.9134752661052713`*^9, 3.913556214896843*^9, 3.9137265313276176`*^9, 
   3.9137266888488703`*^9, 3.9137271803335114`*^9, 3.913727233569957*^9, 
   3.9137272991368093`*^9, 3.913727398367738*^9, 3.913738396648456*^9, {
   3.921778186916108*^9, 3.9217782286209784`*^9}, {3.921778275440714*^9, 
   3.9217782894461203`*^9}, {3.921825796894518*^9, 3.921825804097046*^9}, {
   3.921841562951129*^9, 3.9218415739455013`*^9}, {3.922208466292858*^9, 
   3.922208467668425*^9}, {3.9222085219123287`*^9, 3.922208541373795*^9}, {
   3.922208611989833*^9, 3.922208629947854*^9}, {3.9222858935718203`*^9, 
   3.9222859235396442`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"c09bc8d5-b04c-4b76-9ae8-e7bd10cd5372"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"/BoxMatrix\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    
                    TemplateBox[{
                    "10.`", "\", \"", "0.`", "\", \"", "0.`", "\", \"", 
                    "10.`"}, "RowDefault"], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     RawArray["Real64",{{10., 0., 0., 10.}}],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/d2Edgammadgamma\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TemplateBox[{
                    RowBox[{"-", "0.7931972677312094`"}], "\", \"", 
                    RowBox[{"-", "0.5053013574202618`"}], "\", \"", 
                    RowBox[{"-", "4.3775948008697405`"}], "\", \"", 
                    RowBox[{"-", "4.622320528752274`"}], "\", \"", 
                    "\"\[Ellipsis]\""}, "RowDefault"], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIRiE8A8ZHLrTb3
E1/uT7o0/UCu9oP9Og3KZiuaBA+EVe+a7lgrdODqUqHemyoODiIufRJpx77Z
/5olay3l/MjeoyA6rKFJ8sA//7mH5us/3//oj4FLkJ6Qw69Hf7aoXxM9sP0T
i/5WuZ/2VTI+ftNceQ/MrMudwd1u4DD1jHdXz3eeA+/X5ralhKkdyFyS5/94
kpoDD9OxG761vAdY7jl8uJHK6rCBc0Yu1ywJhxNRDFWL83rsSxS+BP79q+2g
9/D4FNlGFgedPKELxikKDqeWXU7cwCPt4P9cctq7SQoHupl2WxWWKDqEnd2u
ZpnB5LDl47W5V7cxHHCduJdt1htph67lvoa1Ga/sX7nOPRoWpeuwVO/mNfsY
ngOq/cdmTn6l5qAkdPGrRt0H+4zgCuPmi9/sXygYTmJUUnRI+bzvoDyT4oEV
f67tmpfyaL/Uw1DvvKnP7ds7BD8e/fRvv5Wy7cWnfF/3JzAWv5NrmWh/QSps
2ulZf/Yb3HzuuqtIxMEiQvio8jNrh5Tj3ZJ8oYwOnmJ7hDyW/7Wf5xVXxGrw
z75457dlgX8YHGYs4p3/1l/wwM81n44aT5RyuGwRIPhtmryDn+SLT/OWMh7Y
LHQr/8K/a/tFHy7W+hL1c39AwZuPX3ZLHWDx/BR+yXS1/bxfUx6cvHjLPm7y
ExZFrZ/7d6yfIbf6wnr7ugNvrB+7SDicq7aqmT7z4n7+5mMzAp05Djw8+mbO
/Af37QVjKnY7sH2yDxHzKC1QfW3/bU8559EL3A53orzrcmPf7p9XKHHuxvkf
9hpcyhJdz5kPhISkHu8IdnD48IlhdfKrffZh0ZovL5xQczgo+knoUvPn/V55
cpVBx9/bH2I8Jy/SInFgFUfsjANBD/cvF2x3efxD2iE7Wbtaof6TfU4dw5R8
RRmHickz3nPPf7zfJ83H57CRkMOUjUtWLl5v6iC375rBOfnr+2dlLNpx9flj
+6SLxxsuxx2xPxzdt/KaIItDYIpAUI/ay/0tSf488TKf91tM1zqf/IX7wIG/
cXeSUxfZf6q6zvYyUdNBQelrI/umk/baNfcrgtm5DixUZpzYdvyd/bZMto2S
Yu/t+V/2LpM7x3FAeskZn6fcL+2f2dmpJKx7Yc8ABYFQ+sKi0mXTQhkYNrRC
aFJBAJRewAhlLISYI1CQAaa5gEKsSJgFiNmgbBjNDmWzINEgMQ4onwOqjhMq
zoKkH5nNgWYuTAxmLrI4yBwuJDEOJDXo7kN2FxvUHcjuZsWCkc1lR1PPBrWb
nQHVH+hqWZHUI+tFDkNONDk2NH0wsJCRYRQQAQD7PJzs
     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/energy\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TemplateBox[{"135.4012141592477`"}, "RowDefault"], 
                    "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     RawArray["Real64",{{135.4012141592477}}],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/neighbor\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Integer32\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2000"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Integer32\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2000"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    
                    TemplateBox[{
                    "27", "\", \"", "81", "\", \"", "15", "\", \"", "1", 
                    "\", \"", "80", "\", \"", "\"\[Ellipsis]\""}, 
                    "RowDefault"], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJztl1tTE0EQhVcDKsjNACKJCIgIkoACAgKCoIQYgspVkDuh1DetQqss/6X/
SPvIZ9U6zuTVl+2qlsrs2b6e7ll7K583PlyOoujLNftn4/Tb4vn56ffNOvtR
+vT1/cf35+Njn/T8kumPq1GUtb/rps2crZneN/3piJ6PmE6btpgWwUYOtsd+
15i+Nl0wXTQ98th7ZGeHpldM75o+9mAkZ3Y+bzpnesu0gm3lIF9tpm9Nc6aj
puOmL5V6wF4Kv3umHfj24d7Zedn0CTkfB3CNdt6O/9UARjJlz2ZNn5sOm3ab
tnrwz8iph7oNBGzetvMV05v0pYOcXNwbO1s2HcL3bMDeCXlcI48x0zf0OY6b
wMYU8asnOx6bI/Apgl+huhTBqcb9poOmJx58xs6WTLdN71Sxp7pumk6aPjDt
Ne3i3TiuQuxN5FJHTw5M78WwefhVQ0/qTZ95/O/DlzvEmKOWjU4+6tmu6Qx9
ux7IZY9nI9QvC7dH4ewV3tshB/WiQpyalTXH7pb9Lpk+JZ9Q/Q6og+p1o0qt
1+mtdsUrYuvwYB/C0+sBfv4R+UvTL71zGMAqvgyxbcPZsgerfg7DhTT5ZOhv
fO7aqJn2yRH99flNw6cB8nkIr1xcit500KvQXluFI9pTmk3N6JgHWyFexf0C
7si/9upCDK/50a7S/LRUqXOWvq3Bk3n65+IewPN66rJCb1ycfO7DcfntD/jW
POaxOYCttAerOvRRF/G1EF3srQYH207/H1Fj1bqW9/S+6qv524LvbfhWXpMB
vjzH3yYz4MtD+1azq3prb+leXKff8VnuIkfV7Tbc93F6G27qWYpcch5cLed6
fhd/4x7cKvmrjtrfjYE8aqmZ7GThwEsPNkeNU/gdDdjbwZ/uhqYq/CvQkzy9
SFNvFyc7dXC/mj37hPk9//twv5/euDj17DS6uMevMiv9cFZ9HOEd9XcX7HTs
3JUJ8m2AN4p1yhNrCU6qtmdwsdNjU3OoXaq51L1UE/D7CtwcmLMALg/nNb8D
1NqH097T95T2jO69xSq4BTDitO+bTjJLTYaYpWFq4+Jk54B+nFJzn71uONLF
jIiLmhnt/0zsnRK8moRPw/RlyLHbx1kD/fPtXMkluHHCDAm7E/17r6q3mqVx
Zkj9eOqxucF5J3EWPLFJtEO0L3S/9NK7I/pyjzqJo++on+7ndvj/BG7H7WkH
aob7yDW0DxR/Fm7Nk4dvH1yGd5Xo7/vHlSK+5HOZeosbE9Hf34tz+JSo5kWe
33Jsa09pFpvBZgO++8i3lvhV85Kn1gW4Im51wxefPfVLM5sHX8CeixMfl+Bn
jp74vp06iemMOrZhe8vBFuGc6tVEPVzuSVbghb4NNEcz8MPFiStl+BH6v4xE
3y6H8E88FB9933WD8K1MricBm4qtlRpnqEkZ/h4Tt3Bd+NQ9qRhS1NL9bhf/
NAvKW7Oh/dbj8S27B/hRztPUx8XtE38j3NPMD3pwu8R6jK2ZQL419KqVvixE
F/vVxb2FB+Ko9sZ8FN75iSSSSCKJJJJIIokkkkgiiSSSyP+VX1gnSlY=
     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/position\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, 
                GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    
                    TemplateBox[{
                    "7.893677999937059`", "\", \"", "6.891334458165668`", 
                    "\", \"", "7.137903116114167`", "\", \"", 
                    "6.92064757715813`", "\", \"", "8.606657315746439`", 
                    "\", \"", "\"\[Ellipsis]\""}, "RowDefault"], 
                    "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJwVVHs4lAkfnXGbxqWGuTUzmncuKmk3xDe7afMeZVZutYR2hb6pFF1suWa/
QssjShE+FNkvX5eliUoKLaFtUbq4ZDfaJrVJFDMx7rT2j3POc57z1/k9z++I
t33vvVOHQqFEzJsjb0WMU3i4InaTwT8mWLFXZh/8T0idQ9Mc/pu6ZZMoi4Db
D4OTVRkCrO+LjpWdMEeJhfGa2lIBPtO/2JwvE4NnafmKa6EH5YBnH3Wwj/RS
fc3u7xFhMuWH//Q6ieB02tVmxno+Cu9oXddlaMmrMcykxcE8hNam+BzOu0W6
OXRv+HmTGETE1pS1oxwIKg/IGJNi2EcGFv9UTUfVu5qb9j58HPyz4/Pv5PNR
+gvrqfSCAaofn2o5UC6B3qmVnfa+VCQzfzGur5Vga5nOdkaVBPZnGeUvckyQ
yIx38ZKb4olP4b7ucRP4ktu3ZkzzUbictyblOxbau/eYDu4xxBknzwD9TALL
XjctHb8gRJz6CF17nYtdIkrIZZE57kVWWwaP0rGwbZXLYiMpGl5YRLl++Rfp
aVAiHw2ZJnMf5F3SlbMgdhAond9QkKBoA00txo0EXWnaWQPUrne+5sc2RlHZ
6lTVajH0HlURki4CZplFa5X9EowdLo6qY0rx7fLsgXCOCOIIVS6lfiFuPfvN
+qKPIdonrfbe8leRHot1NcU9DJAH6/nWdCPc79fSLNulaA+11qPEiBGW5xHm
lMdD+LbOdekyKXKu00v9hVKcvpabnZ85RCbF+gieb5YiTnlVs+ieMd709m88
p56747idysCFhqHmVB9q4xip4X3h/H2RGIE5R8dTK/SxoVng4GN1lcy0DO5/
oOknRVJZxWWrblLX5mNA0wkR4utuLxlR0dD+NKIlJ2ghRtjt51vLBagZMNWf
Oqkh2RUdiXlnuDC+7Rz2nE/gUJTJZ+FOYrjJ8s2vmPPwYVXmV7u0EmTvAbWw
fIosWMe08r/IQmTiTOX2fAI9odo+z8EeciYwpdqxY4acHtxZdDiJBkvaZNLq
AVMoIqNt0+kUtLmY+IdIhBhMfNSVZFlHjmqSDD3f0BGf5Tv8h5kOkhJM1rQf
1oWDgVXbIyqBnIDk34/JRXCMmmhY9kEK9y8a9iXPKX51rSnxHiGzi8MuldqJ
IXV3SJ4/piY30zUyupwPpaL4YdrQPMxKPv08P26ubxbdaseYFB6BAjvZKi7u
BgVIfd5oyKyfhO5kI4EQ2xQ3YRgL2WHfzJTPM4aX2plgdKnJTrtaputLGpqc
7uc+6TBFqMtAlVRIw7dLUhl9WRzU9yuxYkqElgCVR3QaDxZG+rH7uCL04tAg
tWERjr2/45jpOPc/y3MeFyhN8bIgOO2ttRGulNZlESIV+U3Chx1b+Uzs/3yU
FeJMQM3lPG8s5UB973VRz1sxaAu2vAoKYGN2p1prMyhB2WiCUmFLxczXqWrW
KSHez0ZE7XmoA+KAccfkTRGSK1jHW5dScP3K67PaHcbI8FXaBMmNwOlcNJP+
QABxsCK+q1KK6tyNhYeOUGGlnb1huPQaObE77/gkMUUem7447GJqiHIdb0qK
lyHKbqafXxZrhpL9zySyu2wUxVm9zY/gIs3epbLxaA1Zu8r27PoRFk7udFv5
a+I4SYnnXT1nZYZ8gyVTslcixPn17P+y4DwZo7PS8bdhNhac4KSV8iVQn8vK
rgmi4+nx3/f+6zUPw5lbppw2SbC7dfeFozUcfFzsEGwhE8I2slD3UpIeuq1p
0ZKYBagO+XHC19sMRnk3Hno8E6KBM3Eq5BMHcovAtnfDBBT5L82b/y3E2ve9
frfNp8iNwaGNdh1cJL07waj0o6IlN2PRrSe68HmsPZbi20uGmSeMDU0ag+hb
0VnKpCNZf5p5p0GChZF1f1L6Kskt/sqeOwoG+n+0qarXsBGxocmdm2EC9oVZ
R8FNIWb8gj4W20iheH5Gt2AXF+s3V+nwX0jQqlv77MhHKZRBC7aNpIihw4mY
Gvdj4nL0U23XaQLNDi2tdl+xYSO+y/1f7QDpoDO666TLB7KaofiLeCTB/50D
3A9WieHkXaYMKvhE3h+J3VwBHmpjme/ShySgoGS5qtQMLDeT7hVtQijjlUSx
hTkK94Xenpzbq6NyT0GiFx9Bf1xp50/QYB2iOadfL0HeqFfFRjDxN1/ZvNQ=

     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/sigma\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "200"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TemplateBox[{"0.5654512129279614`", "\", \"", 
                    RowBox[{"-", "0.6601951993926161`"}], "\", \"", 
                    RowBox[{"-", "0.40561104679685656`"}], "\", \"", 
                    RowBox[{"-", "0.1561255070966142`"}], "\", \"", 
                    "\"\[Ellipsis]\""}, "RowDefault"], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIRiE8A8RGvBBVd
iUf2BYdOrwtUeLq/4ZEFZ8fXm/tzJretff378P4fL+5z5/GoOlhNeasUG3LJ
XiDtQZKS0If9y8W6w97ve7hf4/V5tu7L1+x3+6ofu/Hoq/36HLOdgsFCDptE
daxePdhk39Gl4v176Q/789v7nR8e53KoWfT+zKmw//u3aO962ZN+1F7wwq7q
jN3P7L3SmF+VfD2zP3CHZPG922/sO2KPNAtv4D3w4ck5e9OExfbVc9+rTRF+
bh+gbXbz+PnX+7vSteOu1wk4NDkGntyhJ+LAm5Xdw2T/ef/bmsSApOt37J8V
T/soE3RpP/d7heApx27u51tVIuU08Zr9tqTvVyyCT9lfkJ2w78fkjfY3Iu/L
HQr8bs/GcN6h+OIW+6dHZl737fts379k4+JLbAf32346yf4l+sP+VNYFW7vC
tuw/Jxf4q4Pxg33+XK91NnOP2yfs2rhg7uuH+9d/6BOImHJ2/5UU7gKRgxf2
x2i2bHm/5op97fV0ppflt+yV7y5UWntG4sAUvu6V+c/22kd8ebiK232qvf5U
n3dfLly1L6lTcN5g8N4+6OfsryyrVtmr7Ps07XnYc3vJk728tlPP7Zc/+eS9
Z8h9+0U/Ps1vzpts/0er8ufUSx/tc76HPbriPmM/n/Oi83c9e+yn9Kl83p40
cf/at7PSnil9sRewutV6SLHC/sHibeuXTf1lLzDhvkqJ3kn7Q78OZ5t8uWKv
/dBvCovlwf1swtb7anO22DM71AiIhxTbJzIdY7LOPrO/oCqGr8GdwcH5+8KF
K7kP78/4uKezMOS5Pfc+J7bom2oOG658e/1Oot3eZ+EJzbP9b+2zLoUFTL13
x36m+rml9cWH7IUfnzJ9N/3G/k0fba8y5/6yP1Pmlcqn93y/FouKo/25u/t/
8/jkMLNzOchcexSdeua4fYRW/bWsA6fs9Q6IRURXCh5QXn7V7kPYY/t5E/2m
m2RstVf552NwxGWtPUvlhvUz/l+3n6y8Wt2X54a96JlSvlnXj9ivOf1Skt3h
on2Y2E7Vs19e7g/gyggPYRY8MO2VQqGi0qX9rg9srsXf2Gu/rVH1S8b8U/sf
tF0/yS53f39Y2d8+mZc37ePany6YtfL8/u9M6XuYwk7aM0DBQkYGFCBQkLFs
WijDKBgkQBFKXzArBsfLh6gSMK0AFYfRLFDa4U2Znk89Qn8gTDwSoo/hN4R+
8BqiDkaj2weX1ygFqw+AijfAFE6HiMPSiwVUWACK0ZIVw4XZEPXMaOIWULUw
fYSAIcwdTyH+aNgOMffAqhIU2gCqroAN1V+4gAsaHwAsRt9t
     "],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}], ",", 
   RowBox[{"\<\"/time\"\>", "\[Rule]", 
    InterpretationBox[
     RowBox[{
      TagBox["NumericArray",
       "SummaryHead"], "[", 
      DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
       "Ready"}, 
       TemplateBox[{
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxOpener"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SummaryBoxCloser"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                 "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 
                   3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
               GridBox[{{
                  RowBox[{
                    TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"Real64\"", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Data: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TemplateBox[{"4.64943075781583`*^-310"}, "RowDefault"], 
                    "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic]},
        "SummaryPanel"],
       DynamicModuleValues:>{}], "]"}],
     RawArray["Real64",{{4.64943075781583*^-310}}],
     Editable->False,
     SelectWithContents->True,
     Selectable->False]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.913392384428406*^9, 3.91339369652736*^9, 3.913393732083776*^9, 
   3.913394410782865*^9, 3.9134732896346407`*^9, 3.913475267317169*^9, 
   3.913554264354388*^9, 3.913556220257312*^9, 3.9137265318446207`*^9, 
   3.913726689176271*^9, 3.9137271813702393`*^9, 3.913727233973132*^9, 
   3.91372730162633*^9, 3.913727398610985*^9, 3.913737724699085*^9, 
   3.913738397216159*^9, 3.913738517193323*^9, 3.913741777125329*^9, {
   3.92177827702912*^9, 3.921778290272038*^9}, {3.92177860079086*^9, 
   3.921778621440159*^9}, 3.9217787081532297`*^9, 3.921825827293518*^9, 
   3.92184157597217*^9, 3.921842171879115*^9, 3.92220846912267*^9, 
   3.922208535588451*^9, 3.9222086316818666`*^9, 3.922208781745632*^9, 
   3.922208821361599*^9, 3.922208858313512*^9, 3.9222088988932247`*^9, 
   3.922208939737656*^9, 3.92220897771255*^9, 3.922209249104124*^9, 
   3.9222093525717173`*^9, 3.922209399411441*^9, 3.92220944118787*^9, 
   3.922213562916688*^9, 3.922213633491703*^9, 3.9222137329529753`*^9, 
   3.922276718827614*^9, 3.922276833722602*^9, 3.922277333989648*^9, 
   3.922285924365754*^9, 3.922528787936222*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"55d23996-8e98-423d-aa47-5c68e2276c3f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "cellGPU", " ", "values", " ", "for", " ", "one", " ", "snapshot", 
    "\[IndentingNewLine]", "1", "stD", " ", "pure", " ", 
    RowBox[{"shear", ":", "11.4891"}]}], ";", 
   RowBox[{"2", "ndD", " ", "pure", " ", 
    RowBox[{"shear", ":", "842.491"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.92184161181919*^9, 3.921841613756771*^9}, 
   3.921842194317395*^9, {3.9218429464633303`*^9, 3.921842982407549*^9}, {
   3.922208662229816*^9, 3.922208665928094*^9}, 
   3.922285890400277*^9},ExpressionUUID->"c0f767ae-b527-439c-9cb1-\
0f02d24f6633"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"sigma", " ", "is", " ", 
   RowBox[{"dei", "/", "dgamma"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.91373780145113*^9, 3.913737868600988*^9}, {
  3.913737912772257*^9, 3.913737925048787*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"41b3d4fb-9436-46a8-ad75-2bbbead72d04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"positions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"5", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"5", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", "*", "i"}], "+", "2"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "99"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913299871380925*^9, 3.913299954936655*^9}, {
   3.913300005203134*^9, 3.91330008464412*^9}, {3.913300154967265*^9, 
   3.913300181605715*^9}, 3.913388102078426*^9, {3.9133924177888527`*^9, 
   3.913392420356285*^9}, {3.913473338896167*^9, 3.9134733413375053`*^9}, 
   3.913737744014029*^9, {3.921778317758621*^9, 3.921778320862665*^9}, {
   3.921825841274139*^9, 3.9218258429559298`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"731b91b0-0a28-42a9-9a13-4600e5c0ba50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ana", "=", 
   RowBox[{"Analytical\[Epsilon]Cell", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "100"}], "}"}]}], "]"}], ",", "1", ",", "1", ",", 
     "1", ",", "3.80"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.921837844521731*^9, 3.921837853711289*^9}, {
   3.921841642842409*^9, 3.9218416459554462`*^9}, 3.921841798574255*^9, 
   3.921842180642962*^9, {3.921842240320787*^9, 3.921842251173109*^9}, 
   3.922276726916642*^9, {3.92228594073186*^9, 3.9222859437958*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"2cd80de2-1ace-4624-a3cd-2210bfee1b76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.92220875958672*^9, 3.922208764255165*^9}, {
  3.922285941783722*^9, 3.922285944947075*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"9e18f200-fca9-43b8-9452-318cad625ca1"],

Cell[BoxData["11.489074663043251`"], "Output",
 CellChangeTimes->{3.922208873788499*^9, 3.922276775384406*^9, 
  3.922285960273683*^9, 3.9225288062499437`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"32519445-7ae1-451d-af42-8621a54ef1a6"],

Cell[BoxData["842.490645616401`"], "Output",
 CellChangeTimes->{3.922208873788499*^9, 3.922276775384406*^9, 
  3.922285960273683*^9, 3.922528806258985*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"0cea401e-b569-416b-b03a-87e33b7e58ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"numdericalCell\[Epsilon]", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", "0.01", ",", "1", ",", "1", ",", 
     "1", ",", "3.80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.913300104545122*^9, 3.9133001154518557`*^9}, {
   3.913300229335664*^9, 3.913300230398267*^9}, {3.921778338607361*^9, 
   3.921778347376163*^9}, {3.921841658410215*^9, 3.92184165873085*^9}, {
   3.921842287168519*^9, 3.921842300857524*^9}, {3.922208745587014*^9, 
   3.922208747473063*^9}, 3.922276794924158*^9, {3.9222859673323402`*^9, 
   3.922285970476571*^9}, {3.9225287959534483`*^9, 3.922528796145358*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"3b2a0f30-c92f-4e99-a7f1-feec428307fd"],

Cell[BoxData["13.56116531080049`"], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345871385*^9, 
   3.92228598109585*^9, 3.9225288155532084`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"fd8ce936-57f4-4ff4-a52a-4033932790f4"],

Cell[BoxData[
 RowBox[{"-", "154.74926850489817`"}]], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345871385*^9, 
   3.92228598109585*^9, 3.9225288155623503`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"29ea6e7c-72a4-4057-a955-c356c5f7cf7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"numdericalCell\[Epsilon]", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", "0.001", ",", "1", ",", "1", ",",
      "1", ",", "3.80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.913300104545122*^9, 3.9133001154518557`*^9}, {
   3.913300229335664*^9, 3.913300230398267*^9}, {3.921778338607361*^9, 
   3.921778347376163*^9}, {3.921841658410215*^9, 3.92184165873085*^9}, {
   3.921842287168519*^9, 3.921842300857524*^9}, {3.922208745587014*^9, 
   3.922208747473063*^9}, 3.922276794924158*^9, {3.9222859673323402`*^9, 
   3.922285970476571*^9}, {3.9225287959534483`*^9, 3.922528796145358*^9}, 
   3.922528847437459*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"500cea7a-25cc-4707-8f42-6cb731dbe806"],

Cell[BoxData["12.132532876218797`"], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345871385*^9, 
   3.92228598109585*^9, 3.9225288155532084`*^9, 3.922528857400881*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"e88e82b8-b863-43d3-b998-f9fbe817423e"],

Cell[BoxData[
 RowBox[{"-", "445.4784220012157`"}]], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345871385*^9, 
   3.92228598109585*^9, 3.9225288155532084`*^9, 3.9225288574106617`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"91152c25-8100-42a5-99ca-f8dc48d14b3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"numdericalCell\[Epsilon]", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", "0.0001", ",", "1", ",", "1", 
     ",", "1", ",", "3.80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.913300104545122*^9, 3.9133001154518557`*^9}, {
   3.913300229335664*^9, 3.913300230398267*^9}, {3.921778338607361*^9, 
   3.921778347376163*^9}, {3.921841658410215*^9, 3.92184165873085*^9}, {
   3.921842287168519*^9, 3.921842300857524*^9}, {3.922208745587014*^9, 
   3.922208747473063*^9}, 3.922276794924158*^9, {3.9222859673323402`*^9, 
   3.922285970476571*^9}, {3.9225287959534483`*^9, 3.922528796145358*^9}, 
   3.922528847437459*^9, 3.922528894554006*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"76d1fe5e-43ab-44b1-8109-f51cc50e6aac"],

Cell[BoxData["11.489069345886705`"], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345871385*^9, 
   3.92228598109585*^9, 3.9225288155532084`*^9, 3.922528857400881*^9, {
   3.922528891531827*^9, 3.922528904899198*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"9dd74e8e-a899-4e28-82e6-ce9f2b04886e"],

Cell[BoxData["842.4907653493095`"], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345871385*^9, 
   3.92228598109585*^9, 3.9225288155532084`*^9, 3.922528857400881*^9, {
   3.922528891531827*^9, 3.922528904909129*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"98215b0a-4f73-4724-ac74-650290f9add8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ana1g", "=", 
   RowBox[{"AnalyticalgCell", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "100"}], "}"}]}], "]"}], ",", "1", ",", "1", ",", 
     "1", ",", "3.80"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.921837844521731*^9, 3.921837853711289*^9}, {
   3.921841642842409*^9, 3.9218416459554462`*^9}, 3.921841798574255*^9, 
   3.921842180642962*^9, {3.921842240320787*^9, 3.921842251173109*^9}, 
   3.922276726916642*^9, {3.922277522354941*^9, 3.922277526894397*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"e2d1cbfc-98e5-4b35-a4ab-332230cdf5d3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1g", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"ana1g", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.92220875958672*^9, 3.922208764255165*^9}, {
  3.922277528203101*^9, 3.922277529307135*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"036e19a9-ab55-439f-8183-bbfdef848701"],

Cell[BoxData[
 RowBox[{"-", "24.76338138645258`"}]], "Output",
 CellChangeTimes->{3.9222775663625593`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"834ee7a0-7f9b-4386-8839-df6acdbe1e2a"],

Cell[BoxData["282.4582868786699`"], "Output",
 CellChangeTimes->{3.922277566382997*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"12d3418f-d008-4532-914b-f18145f3bc9c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.913737879083346*^9, 3.9137378875707827`*^9}, {
   3.913737929377396*^9, 3.913737978614402*^9}, 
   3.9218425028287497`*^9},ExpressionUUID->"71f9168c-b3b7-44c7-9337-\
5f3e93dbdc60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"num1g", "=", 
   RowBox[{"numdericalCellg", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", "0.0001", ",", "1", ",", "1", 
     ",", "1", ",", "3.80"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.922277625989594*^9, 3.9222776272278147`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"b5de6035-090b-4272-bbce-5c946718e851"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1g", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1g", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.922277664960019*^9, 3.9222776665018*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"bfe6651e-73a6-446e-b8e3-a223b1788743"],

Cell[BoxData[
 RowBox[{"-", "24.763380755242228`"}]], "Output",
 CellChangeTimes->{{3.9222776394753647`*^9, 3.9222776675467367`*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"f70690fb-f03f-4c25-9519-ae228ad81606"],

Cell[BoxData["282.45830475804974`"], "Output",
 CellChangeTimes->{{3.9222776394753647`*^9, 3.922277667567053*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"b3be54d0-6a67-4a60-8703-bc0cebc2e522"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1x", "=", 
   RowBox[{"numdericalCell\[Epsilon]", "[", 
    RowBox[{"positions", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", "0.0001", ",", "1", ",", "1", 
     ",", "1", ",", "3.80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"num1x", ",", "1"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.913300104545122*^9, 3.9133001154518557`*^9}, {
   3.913300229335664*^9, 3.913300230398267*^9}, {3.921778338607361*^9, 
   3.921778347376163*^9}, {3.921841658410215*^9, 3.92184165873085*^9}, {
   3.921842287168519*^9, 3.921842300857524*^9}, {3.922208745587014*^9, 
   3.922208747473063*^9}, 3.922276794924158*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"79d44025-8d51-46a7-b107-fb4458241a5c"],

Cell[BoxData[
 RowBox[{"-", "35.2928146558682`"}]], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345871385*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"e04d4be8-5e95-445c-ae02-bc04f67603b8"],

Cell[BoxData["1141.6253729958255`"], "Output",
 CellChangeTimes->{
  3.921842342180612*^9, {3.922208940692131*^9, 3.922208954492296*^9}, 
   3.9222093022416353`*^9, 3.9222767917055473`*^9, 3.922277345881893*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"abb45043-2852-4963-8e5f-ba736886ce6c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1080., 647.25},
WindowMargins->{{Automatic, 960}, {Automatic, 27.75}},
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3df13c3c-03a9-455f-ac08-6a5116348bd4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 180, 3, 98, "Title",ExpressionUUID->"d2015dce-3ef2-45c8-bb1e-1928e3fd48f9"],
Cell[CellGroupData[{
Cell[785, 29, 165, 3, 68, "Section",ExpressionUUID->"55216139-4dd1-47d1-b3e7-3efeeb28d2c0"],
Cell[953, 34, 169, 2, 29, "Input",ExpressionUUID->"60971f4b-0750-4d2f-9e72-24ba65137fb2"],
Cell[1125, 38, 3666, 91, 370, "Input",ExpressionUUID->"4df5e789-61f6-4abc-b9ca-476070b47347"],
Cell[CellGroupData[{
Cell[4816, 133, 502, 12, 71, "Input",ExpressionUUID->"147655eb-c482-4ae1-ae06-6ba830ab83f3"],
Cell[5321, 147, 1026, 16, 70, "Output",ExpressionUUID->"b934c4c1-9a5d-4fd7-93aa-5e553e96e6d8"],
Cell[6350, 165, 1027, 16, 70, "Output",ExpressionUUID->"423c4acf-b5d6-4a63-bcdc-be0668cf1f1a"],
Cell[7380, 183, 1029, 16, 70, "Output",ExpressionUUID->"3be5e196-c73f-4aa2-a285-7c5856dbf215"]
}, Open  ]],
Cell[8424, 202, 1188, 24, 71, "Input",ExpressionUUID->"ccdb8f92-9908-4ff7-9083-9a9fbcd2eb40"],
Cell[9615, 228, 393, 8, 32, "Input",ExpressionUUID->"6150d537-8093-4cd6-926e-7fe11d02f637"],
Cell[10011, 238, 1599, 47, 68, "Input",ExpressionUUID->"456d064b-1631-4123-a34f-e6400be5eb9b"],
Cell[11613, 287, 3713, 102, 113, "Input",ExpressionUUID->"37f99c5c-e836-4c04-9f11-a149fb588508"],
Cell[15329, 391, 3772, 103, 133, "Input",ExpressionUUID->"8605aa80-7be8-40cc-80c4-8a86208058b3"],
Cell[CellGroupData[{
Cell[19126, 498, 772, 21, 82, "Input",ExpressionUUID->"2015afab-a615-480a-8228-f77fb434e7d1"],
Cell[19901, 521, 294, 4, 70, "Output",ExpressionUUID->"e04cee27-725f-47c1-9f41-52d7d5963c28"],
Cell[20198, 527, 309, 5, 70, "Output",ExpressionUUID->"34550987-49ab-471a-b280-2686435a554e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20544, 537, 916, 29, 51, "Input",ExpressionUUID->"8784ad44-2308-4ce1-82be-f4d479a73dee"],
Cell[21463, 568, 506, 14, 70, "Output",ExpressionUUID->"78c4b579-7f06-4d7d-b763-16608e8129eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22006, 587, 965, 30, 51, "Input",ExpressionUUID->"372822ec-0715-44ad-8aa1-d891569e5d02"],
Cell[22974, 619, 580, 16, 70, "Output",ExpressionUUID->"558c8085-1e2d-4772-856f-665fd09d13e3"]
}, Open  ]],
Cell[23569, 638, 399, 9, 32, "Input",ExpressionUUID->"b0924c0d-21d1-4e8f-a9ba-c8afeeeb4c0d"],
Cell[23971, 649, 28186, 814, 807, "Input",ExpressionUUID->"4ef6c424-5997-4ae8-b30e-d4e18764eac3"],
Cell[52160, 1465, 1169, 34, 29, "Input",ExpressionUUID->"109bf558-5bb1-4fa9-a4b4-7640877ba7ae"],
Cell[53332, 1501, 1674, 46, 51, "Input",ExpressionUUID->"0fc6ac9f-a60a-4f30-a371-8ce79c0aa046"],
Cell[55009, 1549, 564, 16, 52, "Input",ExpressionUUID->"9a963995-e6ef-4ba0-98b6-636718eb9554"],
Cell[CellGroupData[{
Cell[55598, 1569, 1239, 29, 29, "Input",ExpressionUUID->"212e4b68-f3cb-47a4-8e87-efd21d9ebb2b"],
Cell[56840, 1600, 995, 17, 70, "Output",ExpressionUUID->"9f2d4a48-d8ba-4a77-8161-277bd43eb050"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57872, 1622, 905, 24, 29, "Input",ExpressionUUID->"6139bc93-1e3a-4f9f-9ba5-00cad59b3fb8"],
Cell[58780, 1648, 881, 16, 70, "Output",ExpressionUUID->"b9f2361b-8e80-49e8-99d8-f403aa179e28"]
}, Open  ]],
Cell[59676, 1667, 795, 18, 93, "Input",ExpressionUUID->"de8f91a1-9c1c-4593-9152-b2d8fa7cd8b1"],
Cell[CellGroupData[{
Cell[60496, 1689, 2254, 67, 177, "Input",ExpressionUUID->"bd7a54ea-0e51-4575-ba11-b646dc12b58f"],
Cell[62753, 1758, 871, 15, 70, "Output",ExpressionUUID->"7dc34406-eceb-47e8-9edb-6ad0a0eee968"],
Cell[63627, 1775, 870, 14, 70, "Output",ExpressionUUID->"083470d9-b834-42fa-b572-57cb9f459ab7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64534, 1794, 412, 7, 51, "Input",ExpressionUUID->"d2883164-1c11-4471-8369-7496a7bd8038"],
Cell[64949, 1803, 1011, 16, 70, "Output",ExpressionUUID->"9bc6aeb3-2c4c-47fe-9f13-1ec989632361"],
Cell[65963, 1821, 1009, 15, 70, "Output",ExpressionUUID->"4216b899-58a6-445d-b966-7357df02846a"]
}, Open  ]],
Cell[66987, 1839, 2992, 81, 135, "Input",ExpressionUUID->"97592e27-686d-40d1-af7f-e41f521bb520"],
Cell[CellGroupData[{
Cell[70004, 1924, 170, 3, 54, "Subsection",ExpressionUUID->"64e6dd28-0afc-40a6-9ba8-413f8cb3ad69"],
Cell[70177, 1929, 5452, 148, 473, "Input",ExpressionUUID->"3ff30ab7-2c15-4798-8fd6-e2fed1e9b966"],
Cell[75632, 2079, 81806, 2129, 5800, "Input",ExpressionUUID->"b317a457-21a4-44d5-b47a-f4da402f9fd1"]
}, Closed]],
Cell[CellGroupData[{
Cell[157475, 4213, 166, 3, 38, "Subsection",ExpressionUUID->"50212625-7264-4f7b-a10f-17542044be56"],
Cell[CellGroupData[{
Cell[157666, 4220, 777, 12, 29, "Input",ExpressionUUID->"c6a20729-3051-4a4b-99b9-5348d1f3c5c0"],
Cell[158446, 4234, 3425, 95, 70, "Output",ExpressionUUID->"38457c6b-358e-4d67-827b-0b6487436228"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161908, 4334, 419, 7, 29, "Input",ExpressionUUID->"48114874-44c8-4143-9ac2-463acf254ea1"],
Cell[162330, 4343, 2563, 70, 70, "Output",ExpressionUUID->"d8b01075-f34e-47cf-9f1e-c8186963feb4"]
}, Open  ]],
Cell[164908, 4416, 16456, 427, 816, "Input",ExpressionUUID->"8fb65a32-ade6-47fc-90e0-ec83862c1d3d"],
Cell[181367, 4845, 7013, 155, 279, "Input",ExpressionUUID->"084a8052-a8ea-415c-ba1f-e49291980e5e"],
Cell[188383, 5002, 3065, 72, 155, "Input",ExpressionUUID->"1075be55-173e-4441-a5ff-043fd0bf882f"],
Cell[191451, 5076, 6733, 152, 279, "Input",ExpressionUUID->"7912d349-653f-4f93-b533-de4c297fc545"],
Cell[198187, 5230, 2871, 69, 155, "Input",ExpressionUUID->"1a93e89b-e6c9-42f2-9400-9e028220bb8f"],
Cell[201061, 5301, 607, 12, 53, "Input",ExpressionUUID->"f198c114-d3d9-456f-92dd-4f1160169939"],
Cell[201671, 5315, 5563, 137, 401, "Input",ExpressionUUID->"7a8148f7-b39b-403d-a384-94edf263cde6"],
Cell[207237, 5454, 15799, 389, 808, "Input",ExpressionUUID->"b8302214-8022-48c4-9cbc-ff24758ebba7"],
Cell[223039, 5845, 465, 6, 29, "Input",ExpressionUUID->"e0864ef4-a0c2-4055-9af3-189c094808d0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[223553, 5857, 164, 3, 54, "Section",ExpressionUUID->"d94f9a14-62f1-49f6-8b5a-e9ec9ecfdf7e"],
Cell[223720, 5862, 447, 9, 37, "Input",ExpressionUUID->"7eba5210-dcce-495b-bdf7-67c18d8ab094"],
Cell[224170, 5873, 18340, 461, 872, "Input",ExpressionUUID->"967a39b9-849d-4c27-bc3a-d4d20cb8f69b"],
Cell[242513, 6336, 16865, 437, 872, "Input",ExpressionUUID->"729fefa4-fbf8-4992-aba5-011486ee1b58"]
}, Closed]],
Cell[CellGroupData[{
Cell[259415, 6778, 237, 4, 54, "Section",ExpressionUUID->"7c3b2c47-fe19-4dde-81f5-bec6171cb843"],
Cell[CellGroupData[{
Cell[259677, 6786, 1432, 27, 113, "Input",ExpressionUUID->"c09bc8d5-b04c-4b76-9ae8-e7bd10cd5372"],
Cell[261112, 6815, 40721, 823, 251, "Output",ExpressionUUID->"55d23996-8e98-423d-aa47-5c68e2276c3f"]
}, Open  ]],
Cell[301848, 7641, 603, 13, 53, "Input",ExpressionUUID->"c0f767ae-b527-439c-9cb1-0f02d24f6633"],
Cell[302454, 7656, 313, 6, 32, "Input",ExpressionUUID->"41b3d4fb-9436-46a8-ad75-2bbbead72d04"],
Cell[302770, 7664, 1182, 29, 29, "Input",ExpressionUUID->"731b91b0-0a28-42a9-9a13-4600e5c0ba50"],
Cell[303955, 7695, 749, 16, 29, "Input",ExpressionUUID->"2cd80de2-1ace-4624-a3cd-2210bfee1b76"],
Cell[CellGroupData[{
Cell[304729, 7715, 466, 11, 51, "Input",ExpressionUUID->"9e18f200-fca9-43b8-9452-318cad625ca1"],
Cell[305198, 7728, 238, 3, 33, "Output",ExpressionUUID->"32519445-7ae1-451d-af42-8621a54ef1a6"],
Cell[305439, 7733, 234, 3, 33, "Output",ExpressionUUID->"0cea401e-b569-416b-b03a-87e33b7e58ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305710, 7741, 1059, 22, 71, "Input",ExpressionUUID->"3b2a0f30-c92f-4e99-a7f1-feec428307fd"],
Cell[306772, 7765, 338, 5, 33, "Output",ExpressionUUID->"fd8ce936-57f4-4ff4-a52a-4033932790f4"],
Cell[307113, 7772, 356, 6, 33, "Output",ExpressionUUID->"29ea6e7c-72a4-4057-a955-c356c5f7cf7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307506, 7783, 1086, 23, 71, "Input",ExpressionUUID->"500cea7a-25cc-4707-8f42-6cb731dbe806"],
Cell[308595, 7808, 361, 5, 33, "Output",ExpressionUUID->"e88e82b8-b863-43d3-b998-f9fbe817423e"],
Cell[308959, 7815, 379, 6, 33, "Output",ExpressionUUID->"91152c25-8100-42a5-99ca-f8dc48d14b3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309375, 7826, 1109, 23, 71, "Input",ExpressionUUID->"76d1fe5e-43ab-44b1-8109-f51cc50e6aac"],
Cell[310487, 7851, 411, 6, 33, "Output",ExpressionUUID->"9dd74e8e-a899-4e28-82e6-ce9f2b04886e"],
Cell[310901, 7859, 410, 6, 33, "Output",ExpressionUUID->"98215b0a-4f73-4724-ac74-650290f9add8"]
}, Open  ]],
Cell[311326, 7868, 745, 16, 29, "Input",ExpressionUUID->"e2d1cbfc-98e5-4b35-a4ab-332230cdf5d3"],
Cell[CellGroupData[{
Cell[312096, 7888, 470, 11, 51, "Input",ExpressionUUID->"036e19a9-ab55-439f-8183-bbfdef848701"],
Cell[312569, 7901, 185, 3, 33, "Output",ExpressionUUID->"834ee7a0-7f9b-4386-8839-df6acdbe1e2a"],
Cell[312757, 7906, 166, 2, 33, "Output",ExpressionUUID->"12d3418f-d008-4532-914b-f18145f3bc9c"]
}, Open  ]],
Cell[312938, 7911, 229, 4, 29, "Input",ExpressionUUID->"71f9168c-b3b7-44c7-9337-5f3e93dbdc60"],
Cell[313170, 7917, 413, 9, 29, "Input",ExpressionUUID->"b5de6035-090b-4272-bbce-5c946718e851"],
Cell[CellGroupData[{
Cell[313608, 7930, 420, 10, 51, "Input",ExpressionUUID->"bfe6651e-73a6-446e-b8e3-a223b1788743"],
Cell[314031, 7942, 212, 3, 33, "Output",ExpressionUUID->"f70690fb-f03f-4c25-9519-ae228ad81606"],
Cell[314246, 7947, 193, 2, 33, "Output",ExpressionUUID->"b3be54d0-6a67-4a60-8703-bc0cebc2e522"]
}, Open  ]],
Cell[CellGroupData[{
Cell[314476, 7954, 967, 21, 71, "Input",ExpressionUUID->"79d44025-8d51-46a7-b107-fb4458241a5c"],
Cell[315446, 7977, 305, 5, 33, "Output",ExpressionUUID->"e04d4be8-5e95-445c-ae02-bc04f67603b8"],
Cell[315754, 7984, 290, 4, 33, "Output",ExpressionUUID->"abb45043-2852-4963-8e5f-ba736886ce6c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

